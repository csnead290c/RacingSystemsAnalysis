import{r as f,j as t,ab as F,ac as K,ad as V,ae as $,af as b,ag as R,ah as E,ai as l}from"./index-BWSSk1H3.js";const r={rpm:{name:"Engine RPM",color:"#ef4444",unit:"RPM",yAxisId:"rpm"},dsrpm:{name:"Driveshaft RPM",color:"#f97316",unit:"RPM",yAxisId:"rpm"},lockRpm:{name:"Clutch/Conv RPM",color:"#eab308",unit:"RPM",yAxisId:"rpm"},v_mph:{name:"Car Speed",color:"#22c55e",unit:"mph",yAxisId:"speed"},a_g:{name:"Acceleration",color:"#3b82f6",unit:"g",yAxisId:"accel"},engineHp:{name:"Engine HP",color:"#a855f7",unit:"HP",yAxisId:"hp"},hp:{name:"Wheel HP",color:"#8b5cf6",unit:"HP",yAxisId:"hp"},dragHp:{name:"Drag HP",color:"#ec4899",unit:"HP",yAxisId:"hp"},gear:{name:"Gear",color:"#9ca3af",unit:"",yAxisId:"gear"}};function T({data:m,comparisonData:x,comparisonLabel:O="Comparison",distanceMarkers:j=[60,330,660,1e3,1320],raceLengthFt:I=1320}){const[d,A]=f.useState("time"),[a,w]=f.useState(new Set(["rpm","v_mph","a_g"])),M=e=>{w(o=>{const s=new Set(o);return s.has(e)?s.delete(e):s.add(e),s})},g=f.useMemo(()=>{const e=new Set;return a.forEach(o=>{e.add(r[o].yAxisId)}),e},[a]),[k,D]=f.useState(!0),{chartData:h,markerIndices:_}=f.useMemo(()=>{let e=0;for(let n=0;n<m.length;n++)if(m[n].t_s>0){e=Math.max(0,n-1);break}const o=m.slice(e),s=j.filter(n=>n<=I),i=[];for(const n of s){let y=-1,p=1/0;for(let u=0;u<o.length;u++){const c=Math.abs(o[u].s_ft-n);c<p&&(p=c,y=u)}y>=0&&i.push({distance:n,index:y})}return{chartData:o.map(n=>{const y=d==="time"?n.t_s:n.s_ft,p={...n,xValue:y};if(x&&k){const u=d==="time"?"t_s":"s_ft";let c=null,v=1/0;for(const C of x){const W=Math.abs(C[u]-y);W<v&&(v=W,c=C)}c&&v<(d==="time"?.05:10)&&(p.comp_rpm=c.rpm,p.comp_v_mph=c.v_mph,p.comp_a_g=c.a_g,p.comp_hp=c.hp)}return p}),markerIndices:i}},[m,x,k,d,j,I]),P=f.useMemo(()=>_.map(e=>{var o;return{distance:e.distance,xValue:(o=h[e.index])==null?void 0:o.xValue}}).filter(e=>e.xValue!==void 0&&!isNaN(e.xValue)),[h,_]),z=f.useMemo(()=>{const e=[];for(let o=1;o<h.length;o++){const s=h[o-1],i=h[o];s.gear!==i.gear&&i.gear>s.gear&&e.push({xValue:i.xValue,fromGear:s.gear,toGear:i.gear})}return e},[h]);if(!m||m.length===0)return t.jsx("div",{className:"text-center text-muted",style:{padding:"var(--space-6)"},children:"No trace data available"});const H=["speed","accel","hp"].filter(e=>g.has(e)).length;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-2)",marginBottom:"var(--space-2)",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-3)",flexWrap:"wrap"},children:[t.jsx("span",{style:{fontSize:"0.8rem",fontWeight:600,color:"var(--color-text-muted)"},children:"X-Axis"}),t.jsxs("div",{style:{display:"inline-flex",borderRadius:"var(--radius-md)",overflow:"hidden",border:"2px solid var(--color-border)",backgroundColor:"var(--color-bg-secondary)"},children:[t.jsx("button",{onClick:()=>A("time"),style:{padding:"8px 20px",border:"none",backgroundColor:d==="time"?"var(--color-primary)":"transparent",color:d==="time"?"white":"var(--color-text)",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.15s ease"},children:"Time (s)"}),t.jsx("button",{onClick:()=>A("distance"),style:{padding:"8px 20px",border:"none",borderLeft:"2px solid var(--color-border)",backgroundColor:d==="distance"?"var(--color-primary)":"transparent",color:d==="distance"?"white":"var(--color-text)",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.15s ease"},children:"Distance (ft)"})]}),x&&x.length>0&&t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"0.8rem",color:"var(--color-text-muted)",cursor:"pointer",marginLeft:"auto"},children:[t.jsx("input",{type:"checkbox",checked:k,onChange:e=>D(e.target.checked)}),t.jsx("span",{style:{color:k?"#f59e0b":"var(--color-text-muted)"},children:"Show Comparison"})]})]}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:Object.entries(r).map(([e,o])=>{if(!m.some(S=>S[e]!==void 0))return null;const i=a.has(e);return t.jsxs("button",{onClick:()=>M(e),title:o.name,style:{display:"flex",alignItems:"center",gap:"4px",padding:"4px 10px",borderRadius:"12px",border:"none",backgroundColor:i?o.color:"var(--color-bg-secondary)",color:i?"white":"var(--color-text-muted)",cursor:"pointer",fontSize:"0.7rem",fontWeight:600,transition:"all 0.15s ease",opacity:i?1:.7},children:[t.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:i?"white":o.color}}),o.name]},e)})})]}),t.jsx("div",{style:{flex:1,minHeight:0},children:t.jsx(F,{width:"100%",height:"100%",children:t.jsxs(K,{data:h,margin:{top:20,right:5+H*40,left:5,bottom:20},children:[t.jsx(V,{strokeDasharray:"3 3",stroke:"var(--color-border)",opacity:.3}),t.jsx($,{dataKey:"xValue",type:"number",domain:["dataMin","dataMax"],stroke:"var(--color-text-muted)",tick:{fontSize:10,fill:"var(--color-text-muted)"},tickFormatter:e=>d==="time"?e.toFixed(1):e.toFixed(0),label:{value:d==="time"?"Time (s)":"Distance (ft)",position:"insideBottom",offset:-10,fontSize:11,fill:"var(--color-text-muted)"}}),g.has("rpm")&&t.jsx(b,{yAxisId:"rpm",orientation:"left",stroke:"#ef4444",tick:{fontSize:10,fill:"#ef4444"},tickFormatter:e=>`${(e/1e3).toFixed(0)}k`,width:40}),g.has("speed")&&t.jsx(b,{yAxisId:"speed",orientation:"right",stroke:"#22c55e",tick:{fontSize:10,fill:"#22c55e"},width:35}),g.has("accel")&&t.jsx(b,{yAxisId:"accel",orientation:"right",stroke:"#3b82f6",domain:[0,"auto"],tick:{fontSize:10,fill:"#3b82f6"},tickFormatter:e=>e.toFixed(1),width:30}),g.has("hp")&&t.jsx(b,{yAxisId:"hp",orientation:"right",stroke:"#8b5cf6",tick:{fontSize:10,fill:"#8b5cf6"},width:40}),t.jsx(b,{yAxisId:"gear",orientation:"right",domain:[0,6],hide:!0}),P.map(e=>t.jsx(R,{x:e.xValue,yAxisId:"rpm",stroke:"var(--color-chart-marker)",strokeWidth:2,strokeDasharray:"6 4",label:{value:`${e.distance}'`,position:"insideTopRight",fill:"var(--color-chart-marker)",fontSize:10,fontWeight:700,offset:5}},`dist-${e.distance}`)),z.map((e,o)=>t.jsx(R,{x:e.xValue,yAxisId:"rpm",stroke:"#f59e0b",strokeWidth:1.5,strokeDasharray:"3 3",label:{value:`${e.fromGear}â†’${e.toGear}`,position:"insideBottomRight",fill:"#f59e0b",fontSize:9,fontWeight:600}},`shift-${o}`)),t.jsx(E,{contentStyle:{backgroundColor:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",color:"var(--color-text)",fontSize:"0.75rem",padding:"8px"},formatter:(e,o)=>{const s=Object.values(r).find(i=>i.name===o);return s?[`${e.toFixed(s.unit==="RPM"?0:2)} ${s.unit}`,o]:[e.toFixed(2),o]},labelFormatter:e=>d==="time"?`Time: ${e.toFixed(3)}s`:`Distance: ${e.toFixed(0)} ft`}),a.has("rpm")&&t.jsx(l,{type:"monotone",dataKey:"rpm",stroke:r.rpm.color,strokeWidth:2,dot:!1,name:r.rpm.name,yAxisId:"rpm"}),a.has("dsrpm")&&t.jsx(l,{type:"monotone",dataKey:"dsrpm",stroke:r.dsrpm.color,strokeWidth:2,dot:!1,name:r.dsrpm.name,yAxisId:"rpm"}),a.has("lockRpm")&&t.jsx(l,{type:"monotone",dataKey:"lockRpm",stroke:r.lockRpm.color,strokeWidth:2,dot:!1,name:r.lockRpm.name,yAxisId:"rpm"}),a.has("v_mph")&&t.jsx(l,{type:"monotone",dataKey:"v_mph",stroke:r.v_mph.color,strokeWidth:2,dot:!1,name:r.v_mph.name,yAxisId:"speed"}),a.has("a_g")&&t.jsx(l,{type:"monotone",dataKey:"a_g",stroke:r.a_g.color,strokeWidth:2,dot:!1,name:r.a_g.name,yAxisId:"accel"}),a.has("hp")&&t.jsx(l,{type:"monotone",dataKey:"hp",stroke:r.hp.color,strokeWidth:2,dot:!1,name:r.hp.name,yAxisId:"hp"}),a.has("dragHp")&&t.jsx(l,{type:"monotone",dataKey:"dragHp",stroke:r.dragHp.color,strokeWidth:2,dot:!1,name:r.dragHp.name,yAxisId:"hp"}),a.has("gear")&&t.jsx(l,{type:"stepAfter",dataKey:"gear",stroke:r.gear.color,strokeWidth:2,dot:!1,name:r.gear.name,yAxisId:"gear"}),k&&x&&x.length>0&&t.jsxs(t.Fragment,{children:[a.has("rpm")&&t.jsx(l,{type:"monotone",dataKey:"comp_rpm",stroke:r.rpm.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp RPM",yAxisId:"rpm"}),a.has("v_mph")&&t.jsx(l,{type:"monotone",dataKey:"comp_v_mph",stroke:r.v_mph.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp Speed",yAxisId:"speed"}),a.has("a_g")&&t.jsx(l,{type:"monotone",dataKey:"comp_a_g",stroke:r.a_g.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp Accel",yAxisId:"accel"}),a.has("hp")&&t.jsx(l,{type:"monotone",dataKey:"comp_hp",stroke:r.hp.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp HP",yAxisId:"hp"})]})]})})}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"12px",marginTop:"8px",fontSize:"0.75rem"},children:Object.entries(r).map(([e,o])=>a.has(e)?t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{style:{width:"14px",height:"3px",backgroundColor:o.color,borderRadius:"1px"}}),t.jsx("span",{style:{color:o.color,fontWeight:500},children:o.name})]},e):null)})]})}export{T as default};
//# sourceMappingURL=DataLoggerChart-DU1dumVQ.js.map
