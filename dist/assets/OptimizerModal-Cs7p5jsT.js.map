{"version":3,"file":"OptimizerModal-Cs7p5jsT.js","sources":["../../src/shared/components/OptimizerModal.tsx"],"sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { simulate } from '../../workerBridge';\r\nimport { fromVehicleToVB6Fixture } from '../../dev/vb6/fromVehicle';\r\nimport { fixtureToSimInputs } from '../../domain/physics/vb6/fixtures';\r\nimport type { Vehicle } from '../../domain/schemas/vehicle.schema';\r\nimport type { Env } from '../../domain/schemas/env.schema';\r\nimport type { RaceLength } from '../../domain/config/raceLengths';\r\n\r\ninterface OptimizerModalProps {\r\n  vehicle: Vehicle;\r\n  env: Env;\r\n  raceLength: RaceLength;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onApplyToSession: (optimizedVehicle: Vehicle) => void;\r\n  onSaveToVehicle?: (optimizedVehicle: Vehicle) => Promise<void>;\r\n}\r\n\r\ninterface OptimizeResult {\r\n  value: number;\r\n  et: number;\r\n  mph: number;\r\n}\r\n\r\ninterface ThrottleStopResult {\r\n  duration: number;\r\n  activateTime: number;\r\n  throttlePct: number;\r\n  et: number;\r\n  mph: number;\r\n}\r\n\r\ntype OptimizeType = 'gear' | 'converter' | 'both' | 'throttleStop';\r\n\r\nexport default function OptimizerModal({ \r\n  vehicle, \r\n  env, \r\n  raceLength, \r\n  isOpen, \r\n  onClose,\r\n  onApplyToSession,\r\n  onSaveToVehicle,\r\n}: OptimizerModalProps) {\r\n  const [isOptimizing, setIsOptimizing] = useState(false);\r\n  const [, setOptimizeType] = useState<OptimizeType | null>(null);\r\n  const [progress, setProgress] = useState(0);\r\n  const [progressText, setProgressText] = useState('');\r\n  const [gearResults, setGearResults] = useState<OptimizeResult[]>([]);\r\n  const [converterResults, setConverterResults] = useState<OptimizeResult[]>([]);\r\n  const [bestGear, setBestGear] = useState<OptimizeResult | null>(null);\r\n  const [bestConverter, setBestConverter] = useState<OptimizeResult | null>(null);\r\n  const [throttleStopResult, setThrottleStopResult] = useState<ThrottleStopResult | null>(null);\r\n  const [targetET, setTargetET] = useState<number | null>(null);\r\n  const [targetETInput, setTargetETInput] = useState('');\r\n  const [showThrottleStopInput, setShowThrottleStopInput] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [saveSuccess, setSaveSuccess] = useState(false);\r\n  \r\n  // Run simulation for a given vehicle config\r\n  const runSim = useCallback(async (testVehicle: Vehicle): Promise<{ et: number; mph: number }> => {\r\n    try {\r\n      const vb6Fixture = fromVehicleToVB6Fixture(testVehicle as any);\r\n      const simInputs = fixtureToSimInputs(vb6Fixture, raceLength);\r\n      simInputs.env = {\r\n        elevation: env.elevation ?? 0,\r\n        barometerInHg: env.barometerInHg ?? 29.92,\r\n        temperatureF: env.temperatureF ?? 75,\r\n        humidityPct: env.humidityPct ?? 50,\r\n        windMph: env.windMph ?? 0,\r\n        windAngleDeg: env.windAngleDeg ?? 0,\r\n        trackTempF: env.trackTempF ?? 100,\r\n        tractionIndex: env.tractionIndex ?? 5,\r\n      };\r\n      \r\n      const result = await simulate('VB6Exact', simInputs);\r\n      return { et: result.et_s, mph: result.mph };\r\n    } catch (err) {\r\n      console.error('Simulation failed:', err);\r\n      return { et: 999, mph: 0 };\r\n    }\r\n  }, [env, raceLength]);\r\n  \r\n  // Reset state\r\n  const reset = useCallback(() => {\r\n    setOptimizeType(null);\r\n    setProgress(0);\r\n    setProgressText('');\r\n    setGearResults([]);\r\n    setConverterResults([]);\r\n    setBestGear(null);\r\n    setBestConverter(null);\r\n    setThrottleStopResult(null);\r\n    setTargetET(null);\r\n    setTargetETInput('');\r\n    setShowThrottleStopInput(false);\r\n    setSaveSuccess(false);\r\n  }, []);\r\n  \r\n  // Optimize gear ratio\r\n  const optimizeGear = useCallback(async (): Promise<OptimizeResult | null> => {\r\n    const currentGear = vehicle.rearGear ?? 3.73;\r\n    const minGear = Math.max(2.0, currentGear - 2.0);\r\n    const maxGear = Math.min(6.0, currentGear + 2.0);\r\n    const step = 0.05;\r\n    \r\n    const testResults: OptimizeResult[] = [];\r\n    const totalSteps = Math.ceil((maxGear - minGear) / step);\r\n    let stepCount = 0;\r\n    \r\n    for (let gear = minGear; gear <= maxGear; gear += step) {\r\n      const testVehicle = { ...vehicle, rearGear: gear };\r\n      const result = await runSim(testVehicle);\r\n      testResults.push({ value: gear, et: result.et, mph: result.mph });\r\n      stepCount++;\r\n      setProgress(Math.round((stepCount / totalSteps) * 50)); // 0-50%\r\n      setProgressText(`Testing gear ratio ${gear.toFixed(2)}...`);\r\n    }\r\n    \r\n    const best = testResults.reduce((a, b) => a.et < b.et ? a : b);\r\n    setGearResults(testResults);\r\n    setBestGear(best);\r\n    return best;\r\n  }, [vehicle, runSim]);\r\n  \r\n  // Optimize converter stall\r\n  const optimizeConverterStall = useCallback(async (baseVehicle?: Vehicle): Promise<OptimizeResult | null> => {\r\n    const testBase = baseVehicle || vehicle;\r\n    if (testBase.transmissionType !== 'converter') return null;\r\n    \r\n    const minStall = 1500;\r\n    const maxStall = 6000;\r\n    const step = 200;\r\n    \r\n    const testResults: OptimizeResult[] = [];\r\n    const totalSteps = Math.ceil((maxStall - minStall) / step);\r\n    let stepCount = 0;\r\n    \r\n    for (let stall = minStall; stall <= maxStall; stall += step) {\r\n      const testVehicle = { ...testBase, converterStallRPM: stall };\r\n      const result = await runSim(testVehicle);\r\n      testResults.push({ value: stall, et: result.et, mph: result.mph });\r\n      stepCount++;\r\n      setProgress(50 + Math.round((stepCount / totalSteps) * 50)); // 50-100%\r\n      setProgressText(`Testing stall speed ${stall} RPM...`);\r\n    }\r\n    \r\n    const best = testResults.reduce((a, b) => a.et < b.et ? a : b);\r\n    setConverterResults(testResults);\r\n    setBestConverter(best);\r\n    return best;\r\n  }, [vehicle, runSim]);\r\n  \r\n  // Optimize throttle stop duration to hit target ET\r\n  const optimizeThrottleStop = useCallback(async (target: number): Promise<ThrottleStopResult | null> => {\r\n    setTargetET(target);\r\n    \r\n    // First, get baseline ET without throttle stop\r\n    setProgressText('Getting baseline ET...');\r\n    setProgress(5);\r\n    const baseline = await runSim(vehicle);\r\n    \r\n    if (baseline.et >= target) {\r\n      // Already slower than target, no throttle stop needed\r\n      setThrottleStopResult({\r\n        duration: 0,\r\n        activateTime: 0,\r\n        throttlePct: 100,\r\n        et: baseline.et,\r\n        mph: baseline.mph,\r\n      });\r\n      return null;\r\n    }\r\n    \r\n    // Binary search for optimal duration\r\n    // Start with reasonable activation time (60% of baseline ET)\r\n    const activateTime = baseline.et * 0.6;\r\n    const throttlePct = 30; // 30% throttle during stop\r\n    \r\n    let minDuration = 0;\r\n    let maxDuration = 5.0; // Max 5 seconds\r\n    let bestResult: ThrottleStopResult | null = null;\r\n    let iterations = 0;\r\n    const maxIterations = 15;\r\n    \r\n    while (iterations < maxIterations && (maxDuration - minDuration) > 0.01) {\r\n      const testDuration = (minDuration + maxDuration) / 2;\r\n      iterations++;\r\n      \r\n      setProgress(10 + Math.round((iterations / maxIterations) * 85));\r\n      setProgressText(`Testing ${testDuration.toFixed(2)}s duration...`);\r\n      \r\n      // Create test vehicle with throttle stop\r\n      const testVehicle = {\r\n        ...vehicle,\r\n        throttleStopEnabled: true,\r\n        throttleStopDelay: activateTime,\r\n        throttleStopDuration: testDuration,\r\n        throttleStopPct: throttlePct,\r\n      };\r\n      \r\n      const result = await runSim(testVehicle);\r\n      \r\n      if (Math.abs(result.et - target) < 0.005) {\r\n        // Close enough to target\r\n        bestResult = {\r\n          duration: testDuration,\r\n          activateTime,\r\n          throttlePct,\r\n          et: result.et,\r\n          mph: result.mph,\r\n        };\r\n        break;\r\n      }\r\n      \r\n      if (result.et < target) {\r\n        // Still too fast, need more duration\r\n        minDuration = testDuration;\r\n      } else {\r\n        // Too slow, need less duration\r\n        maxDuration = testDuration;\r\n      }\r\n      \r\n      bestResult = {\r\n        duration: testDuration,\r\n        activateTime,\r\n        throttlePct,\r\n        et: result.et,\r\n        mph: result.mph,\r\n      };\r\n    }\r\n    \r\n    setProgress(100);\r\n    setThrottleStopResult(bestResult);\r\n    return bestResult;\r\n  }, [vehicle, runSim]);\r\n  \r\n  // Run optimization\r\n  const runOptimization = useCallback(async (type: OptimizeType, target?: number) => {\r\n    reset();\r\n    setIsOptimizing(true);\r\n    setOptimizeType(type);\r\n    \r\n    try {\r\n      if (type === 'gear' || type === 'both') {\r\n        await optimizeGear();\r\n      }\r\n      \r\n      if ((type === 'converter' || type === 'both') && vehicle.transmissionType === 'converter') {\r\n        // If optimizing both, use the best gear ratio found\r\n        const baseVehicle = type === 'both' && bestGear \r\n          ? { ...vehicle, rearGear: bestGear.value }\r\n          : vehicle;\r\n        await optimizeConverterStall(baseVehicle);\r\n      }\r\n      \r\n      if (type === 'throttleStop' && target) {\r\n        await optimizeThrottleStop(target);\r\n      }\r\n    } finally {\r\n      setIsOptimizing(false);\r\n      setProgressText('');\r\n    }\r\n  }, [reset, optimizeGear, optimizeConverterStall, optimizeThrottleStop, vehicle, bestGear]);\r\n  \r\n  // Get optimized vehicle\r\n  const getOptimizedVehicle = useCallback((): Vehicle => {\r\n    let optimized = { ...vehicle };\r\n    if (bestGear) optimized.rearGear = bestGear.value;\r\n    if (bestConverter) optimized.converterStallRPM = bestConverter.value;\r\n    return optimized;\r\n  }, [vehicle, bestGear, bestConverter]);\r\n  \r\n  // Apply to session only\r\n  const handleApplyToSession = useCallback(() => {\r\n    onApplyToSession(getOptimizedVehicle());\r\n    onClose();\r\n  }, [getOptimizedVehicle, onApplyToSession, onClose]);\r\n  \r\n  // Save to vehicle permanently\r\n  const handleSaveToVehicle = useCallback(async () => {\r\n    if (!onSaveToVehicle) return;\r\n    setIsSaving(true);\r\n    try {\r\n      await onSaveToVehicle(getOptimizedVehicle());\r\n      setSaveSuccess(true);\r\n      setTimeout(() => {\r\n        onClose();\r\n      }, 1000);\r\n    } catch (err) {\r\n      console.error('Failed to save vehicle:', err);\r\n      alert('Failed to save vehicle');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  }, [getOptimizedVehicle, onSaveToVehicle, onClose]);\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  const hasResults = bestGear || bestConverter || throttleStopResult;\r\n  const isAutomatic = vehicle.transmissionType === 'converter';\r\n  \r\n  return (\r\n    <>\r\n      {/* Backdrop */}\r\n      <div\r\n        onClick={onClose}\r\n        style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          backgroundColor: 'rgba(0,0,0,0.6)',\r\n          zIndex: 1000,\r\n        }}\r\n      />\r\n      \r\n      {/* Modal */}\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: '50%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n        backgroundColor: 'var(--color-bg)',\r\n        borderRadius: '12px',\r\n        boxShadow: '0 20px 60px rgba(0,0,0,0.4)',\r\n        zIndex: 1001,\r\n        width: '500px',\r\n        maxWidth: '95vw',\r\n        maxHeight: '90vh',\r\n        overflow: 'auto',\r\n      }}>\r\n        {/* Header */}\r\n        <div style={{\r\n          padding: '16px 20px',\r\n          borderBottom: '1px solid var(--color-border)',\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center',\r\n        }}>\r\n          <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--color-text)' }}>\r\n            ‚ö° Performance Optimizer\r\n          </h3>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: 'var(--color-text-muted)',\r\n              padding: '0 4px',\r\n            }}\r\n          >\r\n            √ó\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Content */}\r\n        <div style={{ padding: '20px' }}>\r\n          {/* Vehicle info */}\r\n          <div style={{\r\n            padding: '12px',\r\n            backgroundColor: 'var(--color-bg-secondary)',\r\n            borderRadius: '8px',\r\n            marginBottom: '16px',\r\n            fontSize: '0.85rem',\r\n          }}>\r\n            <div style={{ fontWeight: 600, color: 'var(--color-text)', marginBottom: '4px' }}>\r\n              {vehicle.name}\r\n            </div>\r\n            <div style={{ color: 'var(--color-text-muted)', fontSize: '0.8rem' }}>\r\n              Current: {vehicle.rearGear?.toFixed(2) ?? '3.73'} gear ratio\r\n              {isAutomatic && ` ‚Ä¢ ${vehicle.converterStallRPM ?? 3000} RPM stall`}\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Optimization buttons */}\r\n          {!isOptimizing && !hasResults && (\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\r\n              <button\r\n                onClick={() => runOptimization('gear')}\r\n                style={{\r\n                  padding: '14px 16px',\r\n                  fontSize: '0.9rem',\r\n                  borderRadius: '8px',\r\n                  border: '2px solid var(--color-accent)',\r\n                  backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n                  color: 'var(--color-accent)',\r\n                  cursor: 'pointer',\r\n                  fontWeight: 600,\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '10px',\r\n                }}\r\n              >\r\n                <span style={{ fontSize: '1.2rem' }}>üéØ</span>\r\n                <div style={{ textAlign: 'left' }}>\r\n                  <div>Optimize Gear Ratio</div>\r\n                  <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                    Find the best final drive ratio for quickest ET\r\n                  </div>\r\n                </div>\r\n              </button>\r\n              \r\n              {isAutomatic && (\r\n                <button\r\n                  onClick={() => runOptimization('converter')}\r\n                  style={{\r\n                    padding: '14px 16px',\r\n                    fontSize: '0.9rem',\r\n                    borderRadius: '8px',\r\n                    border: '2px solid #f59e0b',\r\n                    backgroundColor: 'rgba(245, 158, 11, 0.1)',\r\n                    color: '#f59e0b',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 600,\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '10px',\r\n                  }}\r\n                >\r\n                  <span style={{ fontSize: '1.2rem' }}>üîÑ</span>\r\n                  <div style={{ textAlign: 'left' }}>\r\n                    <div>Optimize Converter Stall</div>\r\n                    <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                      Find the best stall speed for quickest ET\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              )}\r\n              \r\n              {isAutomatic && (\r\n                <button\r\n                  onClick={() => runOptimization('both')}\r\n                  style={{\r\n                    padding: '14px 16px',\r\n                    fontSize: '0.9rem',\r\n                    borderRadius: '8px',\r\n                    border: '2px solid #22c55e',\r\n                    backgroundColor: 'rgba(34, 197, 94, 0.1)',\r\n                    color: '#22c55e',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 600,\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '10px',\r\n                  }}\r\n                >\r\n                  <span style={{ fontSize: '1.2rem' }}>üöÄ</span>\r\n                  <div style={{ textAlign: 'left' }}>\r\n                    <div>Optimize Both</div>\r\n                    <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                      Find best gear ratio AND converter stall together\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              )}\r\n              \r\n              {/* Throttle Stop Optimizer - for bracket racing */}\r\n              <div style={{ borderTop: '1px solid var(--color-border)', marginTop: '10px', paddingTop: '10px' }}>\r\n                {!showThrottleStopInput ? (\r\n                  <button\r\n                    onClick={() => setShowThrottleStopInput(true)}\r\n                    style={{\r\n                      width: '100%',\r\n                      padding: '14px 16px',\r\n                      fontSize: '0.9rem',\r\n                      borderRadius: '8px',\r\n                      border: '2px solid #ec4899',\r\n                      backgroundColor: 'rgba(236, 72, 153, 0.1)',\r\n                      color: '#ec4899',\r\n                      cursor: 'pointer',\r\n                      fontWeight: 600,\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: '10px',\r\n                    }}\r\n                  >\r\n                    <span style={{ fontSize: '1.2rem' }}>‚è±Ô∏è</span>\r\n                    <div style={{ textAlign: 'left' }}>\r\n                      <div>Throttle Stop Optimizer</div>\r\n                      <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                        Calculate duration to hit your dial-in (bracket racing)\r\n                      </div>\r\n                    </div>\r\n                  </button>\r\n                ) : (\r\n                  <div style={{\r\n                    padding: '16px',\r\n                    backgroundColor: 'rgba(236, 72, 153, 0.1)',\r\n                    borderRadius: '8px',\r\n                    border: '2px solid #ec4899',\r\n                  }}>\r\n                    <div style={{ fontSize: '0.85rem', color: '#ec4899', fontWeight: 600, marginBottom: '12px' }}>\r\n                      ‚è±Ô∏è Throttle Stop Optimizer\r\n                    </div>\r\n                    <div style={{ marginBottom: '12px' }}>\r\n                      <label style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)', display: 'block', marginBottom: '4px' }}>\r\n                        Target ET (your dial-in)\r\n                      </label>\r\n                      <input\r\n                        type=\"number\"\r\n                        step=\"0.001\"\r\n                        placeholder=\"e.g., 10.500\"\r\n                        value={targetETInput}\r\n                        onChange={(e) => setTargetETInput(e.target.value)}\r\n                        style={{\r\n                          width: '100%',\r\n                          padding: '10px 12px',\r\n                          fontSize: '1rem',\r\n                          borderRadius: '6px',\r\n                          border: '1px solid var(--color-border)',\r\n                          backgroundColor: 'var(--color-bg)',\r\n                          color: 'var(--color-text)',\r\n                        }}\r\n                      />\r\n                    </div>\r\n                    <div style={{ display: 'flex', gap: '8px' }}>\r\n                      <button\r\n                        onClick={() => {\r\n                          const target = parseFloat(targetETInput);\r\n                          if (!isNaN(target) && target > 0) {\r\n                            runOptimization('throttleStop', target);\r\n                          }\r\n                        }}\r\n                        disabled={!targetETInput || isNaN(parseFloat(targetETInput))}\r\n                        style={{\r\n                          flex: 1,\r\n                          padding: '10px 16px',\r\n                          fontSize: '0.85rem',\r\n                          borderRadius: '6px',\r\n                          border: 'none',\r\n                          backgroundColor: '#ec4899',\r\n                          color: 'white',\r\n                          cursor: targetETInput ? 'pointer' : 'not-allowed',\r\n                          fontWeight: 600,\r\n                          opacity: targetETInput ? 1 : 0.5,\r\n                        }}\r\n                      >\r\n                        Calculate Duration\r\n                      </button>\r\n                      <button\r\n                        onClick={() => setShowThrottleStopInput(false)}\r\n                        style={{\r\n                          padding: '10px 16px',\r\n                          fontSize: '0.85rem',\r\n                          borderRadius: '6px',\r\n                          border: '1px solid var(--color-border)',\r\n                          backgroundColor: 'transparent',\r\n                          color: 'var(--color-text-muted)',\r\n                          cursor: 'pointer',\r\n                        }}\r\n                      >\r\n                        Cancel\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Progress */}\r\n          {isOptimizing && (\r\n            <div style={{ textAlign: 'center', padding: '30px 0' }}>\r\n              <div style={{ fontSize: '1rem', marginBottom: '12px', color: 'var(--color-text)' }}>\r\n                Optimizing...\r\n              </div>\r\n              <div style={{ \r\n                width: '100%', \r\n                height: '10px', \r\n                backgroundColor: 'var(--color-bg-secondary)', \r\n                borderRadius: '5px',\r\n                overflow: 'hidden',\r\n                marginBottom: '8px',\r\n              }}>\r\n                <div style={{\r\n                  width: `${progress}%`,\r\n                  height: '100%',\r\n                  backgroundColor: 'var(--color-accent)',\r\n                  transition: 'width 0.2s ease',\r\n                }} />\r\n              </div>\r\n              <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)' }}>\r\n                {progressText || `${progress}% complete`}\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Results */}\r\n          {hasResults && !isOptimizing && (\r\n            <div>\r\n              {/* Gear ratio result */}\r\n              {bestGear && (\r\n                <div style={{\r\n                  padding: '16px',\r\n                  backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n                  borderRadius: '8px',\r\n                  marginBottom: '12px',\r\n                  border: '1px solid rgba(59, 130, 246, 0.3)',\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                    <div>\r\n                      <div style={{ fontSize: '0.75rem', color: 'var(--color-accent)', fontWeight: 600, marginBottom: '4px' }}>\r\n                        OPTIMAL GEAR RATIO\r\n                      </div>\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: 'var(--color-text)' }}>\r\n                        {bestGear.value.toFixed(2)}\r\n                      </div>\r\n                      <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)', marginTop: '4px' }}>\r\n                        ET: {bestGear.et.toFixed(3)}s @ {bestGear.mph.toFixed(1)} mph\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ textAlign: 'right', fontSize: '0.8rem' }}>\r\n                      <div style={{ color: 'var(--color-text-muted)' }}>\r\n                        Current: {(vehicle.rearGear ?? 3.73).toFixed(2)}\r\n                      </div>\r\n                      <div style={{ \r\n                        color: bestGear.value !== (vehicle.rearGear ?? 3.73) ? '#22c55e' : 'var(--color-text-muted)',\r\n                        fontWeight: 600,\r\n                      }}>\r\n                        {bestGear.value - (vehicle.rearGear ?? 3.73) >= 0 ? '+' : ''}\r\n                        {(bestGear.value - (vehicle.rearGear ?? 3.73)).toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Mini chart */}\r\n                  <div style={{ marginTop: '12px' }}>\r\n                    <div style={{ \r\n                      display: 'flex', \r\n                      alignItems: 'flex-end', \r\n                      gap: '1px', \r\n                      height: '30px',\r\n                    }}>\r\n                      {gearResults.map((r, i) => {\r\n                        const minET = Math.min(...gearResults.map(x => x.et));\r\n                        const maxET = Math.max(...gearResults.map(x => x.et));\r\n                        const range = maxET - minET || 0.1;\r\n                        const height = ((maxET - r.et) / range) * 100;\r\n                        const isBest = r.value === bestGear.value;\r\n                        return (\r\n                          <div\r\n                            key={i}\r\n                            style={{\r\n                              flex: 1,\r\n                              height: `${Math.max(5, height)}%`,\r\n                              backgroundColor: isBest ? '#22c55e' : 'var(--color-accent)',\r\n                              opacity: isBest ? 1 : 0.3,\r\n                            }}\r\n                            title={`${r.value.toFixed(2)}: ${r.et.toFixed(3)}s`}\r\n                          />\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {/* Converter result */}\r\n              {bestConverter && (\r\n                <div style={{\r\n                  padding: '16px',\r\n                  backgroundColor: 'rgba(245, 158, 11, 0.1)',\r\n                  borderRadius: '8px',\r\n                  marginBottom: '12px',\r\n                  border: '1px solid rgba(245, 158, 11, 0.3)',\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                    <div>\r\n                      <div style={{ fontSize: '0.75rem', color: '#f59e0b', fontWeight: 600, marginBottom: '4px' }}>\r\n                        OPTIMAL CONVERTER STALL\r\n                      </div>\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: 'var(--color-text)' }}>\r\n                        {bestConverter.value.toFixed(0)} RPM\r\n                      </div>\r\n                      <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)', marginTop: '4px' }}>\r\n                        ET: {bestConverter.et.toFixed(3)}s @ {bestConverter.mph.toFixed(1)} mph\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ textAlign: 'right', fontSize: '0.8rem' }}>\r\n                      <div style={{ color: 'var(--color-text-muted)' }}>\r\n                        Current: {vehicle.converterStallRPM ?? 3000} RPM\r\n                      </div>\r\n                      <div style={{ \r\n                        color: bestConverter.value !== (vehicle.converterStallRPM ?? 3000) ? '#22c55e' : 'var(--color-text-muted)',\r\n                        fontWeight: 600,\r\n                      }}>\r\n                        {bestConverter.value - (vehicle.converterStallRPM ?? 3000) >= 0 ? '+' : ''}\r\n                        {(bestConverter.value - (vehicle.converterStallRPM ?? 3000)).toFixed(0)} RPM\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Mini chart */}\r\n                  <div style={{ marginTop: '12px' }}>\r\n                    <div style={{ \r\n                      display: 'flex', \r\n                      alignItems: 'flex-end', \r\n                      gap: '1px', \r\n                      height: '30px',\r\n                    }}>\r\n                      {converterResults.map((r, i) => {\r\n                        const minET = Math.min(...converterResults.map(x => x.et));\r\n                        const maxET = Math.max(...converterResults.map(x => x.et));\r\n                        const range = maxET - minET || 0.1;\r\n                        const height = ((maxET - r.et) / range) * 100;\r\n                        const isBest = r.value === bestConverter.value;\r\n                        return (\r\n                          <div\r\n                            key={i}\r\n                            style={{\r\n                              flex: 1,\r\n                              height: `${Math.max(5, height)}%`,\r\n                              backgroundColor: isBest ? '#22c55e' : '#f59e0b',\r\n                              opacity: isBest ? 1 : 0.3,\r\n                            }}\r\n                            title={`${r.value} RPM: ${r.et.toFixed(3)}s`}\r\n                          />\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {/* Throttle Stop result */}\r\n              {throttleStopResult && (\r\n                <div style={{\r\n                  padding: '16px',\r\n                  backgroundColor: 'rgba(236, 72, 153, 0.1)',\r\n                  borderRadius: '8px',\r\n                  marginBottom: '12px',\r\n                  border: '1px solid rgba(236, 72, 153, 0.3)',\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                    <div>\r\n                      <div style={{ fontSize: '0.75rem', color: '#ec4899', fontWeight: 600, marginBottom: '4px' }}>\r\n                        ‚è±Ô∏è THROTTLE STOP SETTINGS\r\n                      </div>\r\n                      {throttleStopResult.duration === 0 ? (\r\n                        <div style={{ fontSize: '1rem', color: 'var(--color-text-muted)' }}>\r\n                          No throttle stop needed - car already runs {throttleStopResult.et.toFixed(3)}s\r\n                        </div>\r\n                      ) : (\r\n                        <>\r\n                          <div style={{ fontSize: '1.5rem', fontWeight: 700, color: 'var(--color-text)' }}>\r\n                            {throttleStopResult.duration.toFixed(2)}s duration\r\n                          </div>\r\n                          <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)', marginTop: '4px' }}>\r\n                            Activate at {throttleStopResult.activateTime.toFixed(2)}s ‚Ä¢ {throttleStopResult.throttlePct}% throttle\r\n                          </div>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                    <div style={{ textAlign: 'right', fontSize: '0.8rem' }}>\r\n                      <div style={{ color: 'var(--color-text-muted)' }}>\r\n                        Target: {targetET?.toFixed(3)}s\r\n                      </div>\r\n                      <div style={{ \r\n                        color: Math.abs(throttleStopResult.et - (targetET ?? 0)) < 0.01 ? '#22c55e' : '#f59e0b',\r\n                        fontWeight: 600,\r\n                      }}>\r\n                        Result: {throttleStopResult.et.toFixed(3)}s\r\n                      </div>\r\n                      <div style={{ color: 'var(--color-text-muted)', marginTop: '4px' }}>\r\n                        @ {throttleStopResult.mph.toFixed(1)} mph\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {throttleStopResult.duration > 0 && (\r\n                    <div style={{ \r\n                      marginTop: '12px', \r\n                      padding: '10px', \r\n                      backgroundColor: 'var(--color-bg)', \r\n                      borderRadius: '6px',\r\n                      fontSize: '0.8rem',\r\n                    }}>\r\n                      <div style={{ fontWeight: 600, marginBottom: '6px', color: 'var(--color-text)' }}>\r\n                        Recommended Settings:\r\n                      </div>\r\n                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }}>\r\n                        <div>\r\n                          <span style={{ color: 'var(--color-text-muted)' }}>Activate:</span>{' '}\r\n                          <span style={{ color: '#ec4899', fontWeight: 600 }}>{throttleStopResult.activateTime.toFixed(2)}s</span>\r\n                        </div>\r\n                        <div>\r\n                          <span style={{ color: 'var(--color-text-muted)' }}>Duration:</span>{' '}\r\n                          <span style={{ color: '#ec4899', fontWeight: 600 }}>{throttleStopResult.duration.toFixed(2)}s</span>\r\n                        </div>\r\n                        <div>\r\n                          <span style={{ color: 'var(--color-text-muted)' }}>Throttle:</span>{' '}\r\n                          <span style={{ color: '#ec4899', fontWeight: 600 }}>{throttleStopResult.throttlePct}%</span>\r\n                        </div>\r\n                        <div>\r\n                          <span style={{ color: 'var(--color-text-muted)' }}>Predicted ET:</span>{' '}\r\n                          <span style={{ color: '#22c55e', fontWeight: 600 }}>{throttleStopResult.et.toFixed(3)}s</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n              \r\n              {/* Action buttons */}\r\n              <div style={{ display: 'flex', gap: '10px', marginTop: '16px' }}>\r\n                <button\r\n                  onClick={handleApplyToSession}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '12px 16px',\r\n                    fontSize: '0.9rem',\r\n                    borderRadius: '8px',\r\n                    border: 'none',\r\n                    backgroundColor: 'var(--color-accent)',\r\n                    color: 'white',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 600,\r\n                  }}\r\n                >\r\n                  Apply to Session\r\n                </button>\r\n                \r\n                {onSaveToVehicle && (\r\n                  <button\r\n                    onClick={handleSaveToVehicle}\r\n                    disabled={isSaving}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '12px 16px',\r\n                      fontSize: '0.9rem',\r\n                      borderRadius: '8px',\r\n                      border: 'none',\r\n                      backgroundColor: saveSuccess ? '#22c55e' : '#22c55e',\r\n                      color: 'white',\r\n                      cursor: isSaving ? 'wait' : 'pointer',\r\n                      fontWeight: 600,\r\n                      opacity: isSaving ? 0.7 : 1,\r\n                    }}\r\n                  >\r\n                    {saveSuccess ? '‚úì Saved!' : isSaving ? 'Saving...' : 'Save to Vehicle'}\r\n                  </button>\r\n                )}\r\n              </div>\r\n              \r\n              {/* Run again button */}\r\n              <button\r\n                onClick={reset}\r\n                style={{\r\n                  width: '100%',\r\n                  marginTop: '10px',\r\n                  padding: '10px 16px',\r\n                  fontSize: '0.85rem',\r\n                  borderRadius: '8px',\r\n                  border: '1px solid var(--color-border)',\r\n                  backgroundColor: 'transparent',\r\n                  color: 'var(--color-text-muted)',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                Run Another Optimization\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n// Small trigger button component\r\nexport function OptimizerButton({ onClick }: { onClick: () => void }) {\r\n  return (\r\n    <button\r\n      onClick={onClick}\r\n      style={{\r\n        padding: '6px 12px',\r\n        fontSize: '0.75rem',\r\n        borderRadius: '4px',\r\n        border: '1px solid var(--color-accent)',\r\n        backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n        color: 'var(--color-accent)',\r\n        cursor: 'pointer',\r\n        fontWeight: 500,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '6px',\r\n      }}\r\n      title=\"Open Performance Optimizer\"\r\n    >\r\n      <span>‚ö°</span>\r\n      <span>Optimize</span>\r\n    </button>\r\n  );\r\n}\r\n"],"names":["OptimizerModal","vehicle","env","raceLength","isOpen","onClose","onApplyToSession","onSaveToVehicle","isOptimizing","setIsOptimizing","useState","setOptimizeType","progress","setProgress","progressText","setProgressText","gearResults","setGearResults","converterResults","setConverterResults","bestGear","setBestGear","bestConverter","setBestConverter","throttleStopResult","setThrottleStopResult","targetET","setTargetET","targetETInput","setTargetETInput","showThrottleStopInput","setShowThrottleStopInput","isSaving","setIsSaving","saveSuccess","setSaveSuccess","runSim","useCallback","testVehicle","vb6Fixture","fromVehicleToVB6Fixture","simInputs","fixtureToSimInputs","result","simulate","err","reset","optimizeGear","currentGear","minGear","maxGear","step","testResults","totalSteps","stepCount","gear","best","a","b","optimizeConverterStall","baseVehicle","testBase","minStall","maxStall","stall","optimizeThrottleStop","target","baseline","activateTime","throttlePct","minDuration","maxDuration","bestResult","iterations","maxIterations","testDuration","runOptimization","type","getOptimizedVehicle","optimized","handleApplyToSession","handleSaveToVehicle","hasResults","isAutomatic","jsxs","Fragment","jsx","_a","r","minET","x","maxET","range","height","isBest","OptimizerButton","onClick"],"mappings":"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"}