import{u as _t,a as jt,b as Ur,r as y,j as e,c as Ie,s as gr,d as qr,e as $r,f as Jr,g as St,v as Rt,h as Ke,V as Xe,i as Qr,k as Kr,R as Hr,W as dr,T as cr,P as Dr,l as Pt,m as zr,B as kt,n as K,Z as Je,o as Ne,J as Ue,p as qe,A as xe,C as Xr,q as Yr,t as Ct,w as Tt,F as wt,x as Et,K as At,y as Mt,z as It,D as Ft,E as Bt,G as Lt,H as Nr,I as Wr,L as Zr,M as Ht,N as Dt,O as zt,Q as Nt,S as Wt,U as Me,X as Gt,Y as Vt,_ as mr,$ as Ot,a0 as Ut,a1 as qt,a2 as et,a3 as $e,a4 as rt,a5 as hr,a6 as De,a7 as $t,a8 as Jt,a9 as Qt,aa as Kt}from"./index-aKajhbw-.js";const Ye=["quarterJr","quarterPro","admin"],pr={quarterJr:"Quarter Jr",quarterPro:"Quarter Pro",admin:"Admin / Developer"},Xt={quarterJr:"Basic mode - enter peak HP and RPM, other parameters are calculated automatically",quarterPro:"Full mode - enter complete HP curve and all vehicle parameters",admin:"Developer mode - all features plus dev tools and diagnostics"};function Yt(r,t){const n=Ye.indexOf(r),o=Ye.indexOf(t);return n>=o}function Zt(r){return Yt(r,"quarterPro")}const fe={engine:["peakHP","rpmAtPeakHP","displacement_cid","fuelSystem"],vehicle:["weight_lb","wheelbase_in","tireDia_in","tireWidth_in","rollout_in","bodyStyle"],drivetrain:["gearRatios","finalDrive","shiftRPM","isConverter","slipStallRPM","converterDia_in"],environment:["elevation_ft","barometer_inHg","temperature_F","relHumidity_pct","trackTemp_F","tractionIndex","wind_mph","wind_angle_deg"]},ze={engine:["hpCurve","hpTorqueMultiplier"],vehicle:["staticFrontWeight_lb","cgHeight_in","overhang_in"],drivetrain:["perGearEff","shiftsRPM","launchRPM","slippage","torqueMult","lockup"],aero:["frontalArea_ft2","Cd","Cl"],pmi:["engine_flywheel_clutch","transmission_driveshaft","tires_wheels_ringgear"]};function ei(r){return Zt(r)?{engine:[...fe.engine,...ze.engine],vehicle:[...fe.vehicle,...ze.vehicle],drivetrain:[...fe.drivetrain,...ze.drivetrain],environment:[...fe.environment],aero:[...ze.aero],pmi:[...ze.pmi]}:{engine:fe.engine,vehicle:fe.vehicle,drivetrain:fe.drivetrain,environment:fe.environment,aero:[],pmi:[]}}function ri(){const r=_t(),t=jt(),{setFlag:n,setUserLevel:o,resetFlags:c}=Ur(),s=ei(t),[u,m]=y.useState([]),[a,k]=y.useState(""),[j,T]=y.useState(!0),[C,P]=y.useState(!1),h=y.useRef(null);y.useEffect(()=>{const g=console.log,_=console.warn,i=console.error,b=(x,...l)=>{const R=new Date().toISOString().split("T")[1].slice(0,12),A=l.map(N=>typeof N=="object"?JSON.stringify(N):String(N)).join(" "),M=`[${R}] [${x}] ${A}`;m(N=>[...N.slice(-500),M])};return console.log=(...x)=>{g(...x),b("LOG",...x)},console.warn=(...x)=>{_(...x),b("WARN",...x)},console.error=(...x)=>{i(...x),b("ERROR",...x)},()=>{console.log=g,console.warn=_,console.error=i}},[]),y.useEffect(()=>{j&&h.current&&(h.current.scrollTop=h.current.scrollHeight)},[u,j]);const v=()=>{const g=u.join(`
`),_=new Blob([g],{type:"text/plain"}),i=URL.createObjectURL(_),b=document.createElement("a");b.href=i,b.download=`rsa-logs-${Date.now()}.log`,b.click(),URL.revokeObjectURL(i)},p=a?u.filter(g=>g.toLowerCase().includes(a.toLowerCase())):u,S=[{key:"vb6StrictMode",label:"VB6 Strict Mode",description:"Require complete VB6 fixture for simulation (no defaults)"},{key:"showDiagnostics",label:"Show Diagnostics",description:"Display debug information in console and UI"},{key:"enableStepTrace",label:"Step Trace",description:"Log detailed step-by-step simulation data"},{key:"enableEnergyLogging",label:"Energy Logging",description:"Log energy balance calculations"}];return e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Settings & Flags"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Configure user level, feature flags, and debug options."})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"User Level (Program Tier)"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:Ye.map(g=>e.jsx("button",{onClick:()=>o(g),style:{flex:1,padding:"0.75rem",fontSize:"0.875rem",fontWeight:t===g?"600":"400",backgroundColor:t===g?g==="admin"?"#8b5cf6":g==="quarterPro"?"#3b82f6":"#10b981":"var(--color-bg)",color:t===g?"white":"var(--color-text)",border:`2px solid ${t===g?g==="admin"?"#8b5cf6":g==="quarterPro"?"#3b82f6":"#10b981":"var(--color-border)"}`,borderRadius:"var(--radius-md)",cursor:"pointer",transition:"all 0.2s"},children:pr[g]},g))}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--color-muted)",marginBottom:"1rem"},children:[e.jsx("strong",{children:"Current:"})," ",pr[t]," ‚Äî ",Xt[t]]}),e.jsxs("details",{style:{fontSize:"0.875rem"},children:[e.jsxs("summary",{style:{cursor:"pointer",fontWeight:"500",marginBottom:"0.5rem"},children:["View Available Inputs for ",pr[t]]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"0.75rem",padding:"0.75rem",backgroundColor:"var(--color-bg)",borderRadius:"var(--radius-sm)",marginTop:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"Engine"}),e.jsxs("ul",{style:{margin:"0.25rem 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:[s.engine.slice(0,5).map(g=>e.jsx("li",{children:g},g)),s.engine.length>5&&e.jsxs("li",{children:["+",s.engine.length-5," more"]})]})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"Vehicle"}),e.jsxs("ul",{style:{margin:"0.25rem 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:[s.vehicle.slice(0,5).map(g=>e.jsx("li",{children:g},g)),s.vehicle.length>5&&e.jsxs("li",{children:["+",s.vehicle.length-5," more"]})]})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"Drivetrain"}),e.jsxs("ul",{style:{margin:"0.25rem 0",paddingLeft:"1rem",fontSize:"0.75rem"},children:[s.drivetrain.slice(0,5).map(g=>e.jsx("li",{children:g},g)),s.drivetrain.length>5&&e.jsxs("li",{children:["+",s.drivetrain.length-5," more"]})]})]})]})]})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:"Feature Flags"}),e.jsx("button",{onClick:c,style:{padding:"0.375rem 0.75rem",fontSize:"0.75rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-sm)",cursor:"pointer"},children:"Reset All"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.75rem"},children:S.map(g=>e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.75rem",backgroundColor:r[g.key]?"#dbeafe":"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:r[g.key],onChange:_=>n(g.key,_.target.checked),style:{marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"500",fontSize:"0.875rem"},children:g.label}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:g.description})]})]},g.key))})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsxs("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:["Console Logs (",u.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>P(!C),style:{padding:"0.375rem 0.75rem",fontSize:"0.75rem",backgroundColor:C?"#3b82f6":"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-sm)",cursor:"pointer"},children:C?"Hide":"Show"}),e.jsx("button",{onClick:v,disabled:u.length===0,style:{padding:"0.375rem 0.75rem",fontSize:"0.75rem",backgroundColor:u.length>0?"#10b981":"#d1d5db",color:"white",border:"none",borderRadius:"var(--radius-sm)",cursor:u.length>0?"pointer":"not-allowed"},children:"Download"}),e.jsx("button",{onClick:()=>m([]),disabled:u.length===0,style:{padding:"0.375rem 0.75rem",fontSize:"0.75rem",backgroundColor:u.length>0?"#ef4444":"#d1d5db",color:"white",border:"none",borderRadius:"var(--radius-sm)",cursor:u.length>0?"pointer":"not-allowed"},children:"Clear"})]})]}),C&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("input",{type:"text",value:a,onChange:g=>k(g.target.value),placeholder:"Filter logs...",style:{flex:1,padding:"0.375rem 0.5rem",fontSize:"0.75rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",backgroundColor:"var(--color-bg)"}}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:g=>T(g.target.checked)}),"Auto-scroll"]})]}),e.jsx("div",{ref:h,style:{height:"200px",padding:"0.5rem",backgroundColor:"#1e293b",color:"#e2e8f0",borderRadius:"var(--radius-sm)",fontFamily:"monospace",fontSize:"0.7rem",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:p.length===0?e.jsx("div",{style:{color:"#9ca3af",fontStyle:"italic"},children:u.length===0?"No logs yet":"No matches"}):p.map((g,_)=>{let i="#e2e8f0";return g.includes("[WARN]")&&(i="#fbbf24"),g.includes("[ERROR]")&&(i="#ef4444"),e.jsx("div",{style:{color:i},children:g},_)})})]})]})]})}function Ze(r){var n,o,c,s,u,m;const t=[];return r.drivetrain?((n=r.drivetrain.gearRatios)!=null&&n.length||t.push("drivetrain.gearRatios"),(o=r.drivetrain.perGearEff)!=null&&o.length||t.push("drivetrain.perGearEff"),r.drivetrain.gearRatios&&r.drivetrain.perGearEff&&r.drivetrain.gearRatios.length!==r.drivetrain.perGearEff.length&&t.push("perGearEff length must equal gearRatios length"),!r.drivetrain.clutch&&!r.drivetrain.converter&&t.push("drivetrain.clutch or drivetrain.converter"),(!r.engineHP||r.engineHP.length<2)&&t.push("engineHP (>=2 points)"),(c=r.fuel)!=null&&c.type||t.push("fuel.type"),((s=r.pmi)==null?void 0:s.engine_flywheel_clutch)==null&&t.push("pmi.engine_flywheel_clutch"),((u=r.pmi)==null?void 0:u.transmission_driveshaft)==null&&t.push("pmi.transmission_driveshaft"),((m=r.pmi)==null?void 0:m.tires_wheels_ringgear)==null&&t.push("pmi.tires_wheels_ringgear"),t.length?{ok:!1,missing:t}:{ok:!0}):(t.push("drivetrain.*"),{ok:!1,missing:t})}function ti(){var h,v;const{fixture:r}=Ie(),[t,n]=y.useState(null),[o,c]=y.useState(null),[s,u]=y.useState(null),[m,a]=y.useState(null),[k,j]=y.useState(null),T=()=>{a("validate"),j(null);try{const p=Ze(r);n(p)}catch(p){j((p==null?void 0:p.message)??String(p))}finally{a(null)}},C=async()=>{a("dryrun"),j(null),c(null);try{const p=Ze(r);c({ok:p.ok,message:p.ok?"Fixture can be normalized successfully":`Missing fields: ${p.missing.join(", ")}`,details:p})}catch(p){j((p==null?void 0:p.message)??String(p))}finally{a(null)}},P=async()=>{var p,S,g;a("smoke"),j(null),u(null);try{const _=await gr("VB6Exact",{...r,raceLengthFt:1320});u({et_s:_.et_s,mph:_.mph,model:(p=_.meta)==null?void 0:p.model,steps:(g=(S=_.meta)==null?void 0:S.termination)==null?void 0:g.steps})}catch(_){j((_==null?void 0:_.message)??String(_))}finally{a(null)}};return e.jsxs("div",{style:{padding:"2rem"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Health Check"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Quick validation and testing tools for VB6 fixtures."})]}),k&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"0.875rem",color:"#991b1b"},children:k}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[e.jsx("button",{onClick:T,disabled:m!==null,style:{padding:"1rem",fontSize:"1rem",fontWeight:500,backgroundColor:m==="validate"?"#9ca3af":"#3b82f6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:m!==null?"not-allowed":"pointer",transition:"background-color 0.2s"},children:m==="validate"?"Validating...":"Validate Current VB6 Fixture"}),e.jsx("button",{onClick:C,disabled:m!==null,style:{padding:"1rem",fontSize:"1rem",fontWeight:500,backgroundColor:m==="dryrun"?"#9ca3af":"#8b5cf6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:m!==null?"not-allowed":"pointer",transition:"background-color 0.2s"},children:m==="dryrun"?"Running...":"Normalize & Dry-Run"}),e.jsx("button",{onClick:P,disabled:m!==null,style:{padding:"1rem",fontSize:"1rem",fontWeight:500,backgroundColor:m==="smoke"?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:m!==null?"not-allowed":"pointer",transition:"background-color 0.2s"},children:m==="smoke"?"Running...":"Smoke Sim (1320 ft)"})]}),t&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:t.ok?"#dcfce7":"#fee2e2",border:`1px solid ${t.ok?"#22c55e":"#ef4444"}`,borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"1rem"},children:"Validation Result"}),t.ok?e.jsx("p",{style:{margin:0,color:"#166534"},children:"‚úÖ Fixture is valid and complete"}):e.jsxs("div",{children:[e.jsx("p",{style:{margin:"0 0 0.5rem 0",color:"#991b1b",fontWeight:500},children:"‚ùå Fixture is incomplete"}),e.jsx("p",{style:{margin:"0 0 0.5rem 0",color:"#991b1b",fontSize:"0.875rem"},children:"Missing fields:"}),e.jsx("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"#991b1b"},children:t.missing.map(p=>e.jsx("li",{style:{fontSize:"0.875rem"},children:p},p))})]})]}),o&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:o.ok?"#dbeafe":"#fee2e2",border:`1px solid ${o.ok?"#3b82f6":"#ef4444"}`,borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"1rem"},children:"Dry-Run Result"}),e.jsxs("p",{style:{margin:0,color:o.ok?"#1e40af":"#991b1b"},children:[o.ok?"‚úÖ":"‚ùå"," ",o.message]})]}),s&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#dcfce7",border:"1px solid #22c55e",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem"},children:"Smoke Test Result"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"#166534",marginBottom:"0.25rem"},children:"ET (s)"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#166534"},children:((h=s.et_s)==null?void 0:h.toFixed(3))??"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"#166534",marginBottom:"0.25rem"},children:"MPH"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#166534"},children:((v=s.mph)==null?void 0:v.toFixed(2))??"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"#166534",marginBottom:"0.25rem"},children:"Model"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"500",color:"#166534"},children:s.model??"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"#166534",marginBottom:"0.25rem"},children:"Steps"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"500",color:"#166534"},children:s.steps??"N/A"})]})]})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#eff6ff",border:"1px solid #3b82f6",borderRadius:"var(--radius-md)"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"1rem"},children:"About These Tests"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem"},children:[e.jsxs("li",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Validate:"})," Checks if all required VB6 fixture fields are present"]}),e.jsxs("li",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Dry-Run:"})," Validates that the fixture can be normalized (no actual simulation)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Smoke Sim:"})," Runs a quick 1320 ft simulation to verify the fixture works end-to-end"]})]})]})]})}function ii(r){var t;return(((t=r[r.length-1])==null?void 0:t.rpm)??8e3)+100}function oi(r){const t=r.pmi??{};return{engine_flywheel_clutch:t.engine_flywheel_clutch??3.42,transmission_driveshaft:t.transmission_driveshaft??.247,tires_wheels_ringgear:t.tires_wheels_ringgear??50.8}}function ni(r){const t=r.environment??{};return{elevationFt:t.elevation_ft??t.elevation??0,baroInHg:t.barometer_inHg??t.barometer??29.92,tempF:t.temp_F??t.temperature??59,rhPct:t.rel_humidity_pct??t.humidity??0,windMPH:t.wind_mph??t.windVelocity??0,windDeg:t.wind_angle_deg??t.windAngle??0,trackTempF:t.trackTemp_F??t.trackTemp??80,tractionIdx:t.tractionIndex??3}}function si(r,t){var T,C,P,h,v,p,S,g;const n=oi(r),o=ni(r),c=t<=660?"EIGHTH":"QUARTER",s=r.drivetrain??{},u={finalDrive:Number(s.finalDrive??s.final_drive??0),overallEff:Number(s.overallEff??s.overallEfficiency??s.efficiency??1),gearRatios:Array.isArray(s.gearRatios)?s.gearRatios.map(Number):[],perGearEff:Array.isArray(s.perGearEff)?s.perGearEff.map(Number):[],shiftRPM:Array.isArray(s.shiftRPM??s.shiftsRPM)?(s.shiftRPM??s.shiftsRPM).map(Number):[],clutch:s.clutch?{...s.clutch}:void 0,converter:s.converter?{...s.converter}:void 0},m=r.vehicle??{},a={weightLb:m.weight_lb??m.weight??r.weight??2400,wheelbaseIn:m.wheelbase_in??m.wheelbase??107,tireRolloutIn:((T=r.finalDrive)==null?void 0:T.tireRolloutIn)??m.tire_rollout_in??m.rollout??102.5,tireWidthIn:((C=r.finalDrive)==null?void 0:C.tireWidthIn)??m.tire_width_in??m.tireWidth??17,frontalAreaFt2:((P=r.aero)==null?void 0:P.frontalArea)??m.frontalArea_ft2??18.2,Cd:((h=r.aero)==null?void 0:h.cd)??m.Cd??.24,Cl:((v=r.aero)==null?void 0:v.cl)??m.Cl??.1,overhangIn:m.overhang_in??m.overhang??40},k={model:"VB6Exact",distanceFt:t,raceLength:c,env:o,vehicle:a,drivetrain:u,pmi:n,fuel:r.fuel};if(r.engineHP&&Array.isArray(r.engineHP)){const _=((p=r==null?void 0:r.fuel)==null?void 0:p.hpTorqueMultiplier)??1,i=(r.engineHP??[]).map(b=>Array.isArray(b)?{rpm:Number(b[0]),hp:Number(b[1])*_}:{rpm:Number(b==null?void 0:b.rpm),hp:Number(b==null?void 0:b.hp)*_}).filter(b=>Number.isFinite(b.rpm)&&Number.isFinite(b.hp)).sort((b,x)=>b.rpm-x.rpm);i.length>=2&&(k.engineParams={powerHP:i,redlineRPM:ii(i),idleRPM:900})}const j=Number.isFinite(t)?Number(t):Number(r==null?void 0:r.raceLengthFt)||((r==null?void 0:r.raceLength)==="EIGHTH"?660:1320);if(k.raceLengthFt=j,k.raceLength=j===660?"EIGHTH":"QUARTER",!((S=k.engineParams)!=null&&S.powerHP)&&Array.isArray(r==null?void 0:r.engineHP)){const _=((g=r==null?void 0:r.fuel)==null?void 0:g.hpTorqueMultiplier)??1,i=r.engineHP.map(b=>Array.isArray(b)?{rpm:Number(b[0]),hp:Number(b[1])*_}:{rpm:Number(b==null?void 0:b.rpm),hp:Number(b==null?void 0:b.hp)*_}).filter(b=>Number.isFinite(b.rpm)&&Number.isFinite(b.hp)).sort((b,x)=>b.rpm-x.rpm);i.length>=2&&(k.engineParams={...k.engineParams??{},powerHP:i})}return k}function li({onSelect:r,showEditButton:t=!0,onEditClick:n}){const{vehicles:o,activeVehicleId:c,setActiveVehicleById:s,loading:u}=qr(),m=a=>{const k=a.target.value||null;s(k),k&&r&&r(k)};return u?e.jsx("div",{style:{padding:"0.75rem",backgroundColor:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)",marginBottom:"1rem",border:"1px solid var(--color-border)"},children:e.jsx("span",{style:{color:"var(--color-text-secondary)",fontSize:"0.875rem"},children:"Loading vehicles..."})}):e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)",marginBottom:"1rem",border:"1px solid var(--color-border)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--color-text)",whiteSpace:"nowrap"},children:"Active Vehicle:"}),e.jsxs("select",{value:c??"",onChange:m,style:{flex:1,padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"},children:[e.jsx("option",{value:"",children:"‚Äî Select a vehicle ‚Äî"}),o.map(a=>e.jsx("option",{value:a.id,children:a.name||a.id},a.id))]}),t&&c&&e.jsx("button",{onClick:n,style:{padding:"0.5rem 0.75rem",fontSize:"0.75rem",backgroundColor:"var(--color-primary)",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer",whiteSpace:"nowrap"},children:"Edit in Vehicle Editor"}),o.length===0&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--color-text-secondary)",fontStyle:"italic"},children:"No vehicles saved yet"})]})}function ai(r){var t,n;if(!((t=r==null?void 0:r.engineParams)!=null&&t.powerHP)&&Array.isArray(r==null?void 0:r.engineHP)){const o=((n=r==null?void 0:r.fuel)==null?void 0:n.hpTorqueMultiplier)??1,c=r.engineHP.map(s=>Array.isArray(s)?{rpm:Number(s[0]),hp:Number(s[1])*o}:{rpm:Number(s==null?void 0:s.rpm),hp:Number(s==null?void 0:s.hp)*o}).filter(s=>Number.isFinite(s.rpm)&&Number.isFinite(s.hp)).sort((s,u)=>s.rpm-u.rpm);c.length>=2&&(r.engineParams={...r.engineParams??{},powerHP:c})}return r}function di(){var l,R,A,M,N,X,oe,re,te,ie,me,ne,Y,de,se;const r=$r(),{fixture:t,setFixture:n}=Ie(),o=Jr("enableStepTrace"),c=Ur(),{userLevel:s,setUserLevel:u}=c,{activeVehicle:m}=qr(),[a,k]=y.useState("QUARTER"),[j,T]=y.useState(!1),[C,P]=y.useState(null),[h,v]=y.useState(null),[p,S]=y.useState([]),g=Ze(t),_=d=>{var E,L,F;if(console.log("[RunInspector] Vehicle selected:",d),m&&m.id===d)try{const z=St(m),D=Rt(z);if(!D.ok){console.warn("[RunInspector] Adapter validation warnings:",D.errors),P(`Vehicle data incomplete: ${D.errors.join("; ")}`);return}n(z),console.log("[RunInspector] Fixture updated from vehicle:",{vehicleId:d,vehicleName:m.name,engineHPCount:(E=z.engineHP)==null?void 0:E.length,gearCount:(F=(L=z.drivetrain)==null?void 0:L.gearRatios)==null?void 0:F.length})}catch(z){console.error("[RunInspector] Failed to convert vehicle to fixture:",z),P(`Failed to load vehicle: ${z.message}`)}},i=()=>{y.startTransition(()=>r("/vehicles"))},b=async()=>{var E,L,F,z,D,w,Z;if(!t){P("No fixture loaded.");return}T(!0),P(null),v(null),S([]);let d=null;try{const V=a==="EIGHTH"?660:1320;d=si(t,V),d=ai(d),d.raceLengthFt=V,console.log("[RUN] powerHP?",Array.isArray((E=d==null?void 0:d.engineParams)==null?void 0:E.powerHP),(z=(F=(L=d==null?void 0:d.engineParams)==null?void 0:L.powerHP)==null?void 0:F.slice)==null?void 0:z.call(F,0,2),"raceLengthFt",d==null?void 0:d.raceLengthFt);const B=await gr("VB6Exact",d);v(B),S([])}catch(V){const B=(D=d==null?void 0:d.engineParams)==null?void 0:D.powerHP;console.error("[Run Inspector error]",V,{hpSummary:Array.isArray(B)?`n=${B.length},first=${(w=B[0])==null?void 0:w.rpm},last=${(Z=B[B.length-1])==null?void 0:Z.rpm}`:"none"}),P((V==null?void 0:V.message)??String(V))}finally{T(!1)}},x=()=>{if(p.length===0){alert("No step data available to download");return}const d=["step","v_ftps","EngRPM","wheelRPM","ClutchSlip","HPSave","HPEngPMI","HPChasPMI","DragHP","HP_afterL1","HP_afterL2","PQWT","AMin","AMax","AGS_applied","Vel_next","Dist_next"],E=p.map(w=>[w.step,w.v_ftps,w.EngRPM,w.wheelRPM,w.ClutchSlip,w.HPSave,w.HPEngPMI,w.HPChasPMI,w.DragHP,w.HP_afterL1,w.HP_afterL2,w.PQWT,w.AMin,w.AMax,w.AGS_applied,w.Vel_next,w.Dist_next]),L=[d.join(","),...E.map(w=>w.join(","))].join(`
`),F=new Blob([L],{type:"text/csv"}),z=URL.createObjectURL(F),D=document.createElement("a");D.href=z,D.download=`run-inspector-VB6Exact-${a}-${Date.now()}.csv`,D.click(),URL.revokeObjectURL(z)};return e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Run Inspector & Steps"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Run simulations with VB6 fixtures and inspect detailed step-by-step physics data."})]}),!g.ok&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.875rem",color:"#991b1b",fontWeight:"600"},children:"Fixture validation failed."}),e.jsx("pre",{style:{margin:"0 0 0.75rem 0",padding:"0.5rem",backgroundColor:"#fef2f2",border:"1px solid #fca5a5",borderRadius:"var(--radius-sm)",fontSize:"0.75rem",color:"#991b1b",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:g.missing.join(", ")}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>y.startTransition(()=>r("/dev?panel=input-inspector")),style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Open VB6 Inputs"}),e.jsx("button",{onClick:()=>r("/dev?panel=quick-paste&example=prostock"),style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Load ProStock_Pro Example"})]})]}),!o&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fef3c7",border:"1px solid #fbbf24",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:e.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"#92400e"},children:[e.jsx("strong",{children:"üí° Hint:"})," Enable ",e.jsx("code",{children:"enableStepTrace"})," flag in the Feature Flags panel to capture detailed step data during simulation runs."]})}),C&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"0.875rem",color:"#991b1b"},children:C}),e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"var(--color-bg-secondary)",borderRadius:"var(--radius-md)",marginBottom:"1rem",border:"1px solid var(--color-border)",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--color-text)",whiteSpace:"nowrap"},children:"User Level:"}),e.jsx("div",{style:{display:"flex",gap:"0.25rem"},children:Ye.map(d=>e.jsx("button",{onClick:()=>u(d),style:{padding:"0.375rem 0.75rem",fontSize:"0.75rem",fontWeight:s===d?"600":"400",backgroundColor:s===d?"var(--color-primary)":"var(--color-bg)",color:s===d?"white":"var(--color-text)",border:`1px solid ${s===d?"var(--color-primary)":"var(--color-border)"}`,borderRadius:"var(--radius-sm)",cursor:"pointer",textTransform:"capitalize"},children:d},d))}),s==="admin"&&e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--color-text-secondary)"},children:"üîì Full access"})]}),e.jsx(li,{onSelect:_,onEditClick:i}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"Controls"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"Distance"}),e.jsxs("select",{value:a,onChange:d=>k(d.target.value),style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"},children:[e.jsx("option",{value:"EIGHTH",children:"EIGHTH (660 ft)"}),e.jsx("option",{value:"QUARTER",children:"QUARTER (1320 ft)"})]})]}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end"},children:e.jsx("button",{onClick:b,disabled:j||!g.ok,style:{width:"100%",padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:j||!g.ok?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:j||!g.ok?"not-allowed":"pointer"},children:j?"Running...":"Run with current VB6 UI Fixture"})})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:g.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${g.ok?"#86efac":"#fca5a5"}`,borderRadius:"var(--radius-md)"},children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:"600",marginBottom:"0.5rem",color:g.ok?"#166534":"#991b1b"},children:"Fixture Requirements"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.25rem",fontSize:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{children:(R=(l=t.drivetrain)==null?void 0:l.gearRatios)!=null&&R.length?"‚úÖ":"‚ùå"}),e.jsx("span",{style:{color:"var(--color-text)"},children:"drivetrain.gearRatios"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{children:(M=(A=t.drivetrain)==null?void 0:A.perGearEff)!=null&&M.length?"‚úÖ":"‚ùå"}),e.jsx("span",{style:{color:"var(--color-text)"},children:"drivetrain.perGearEff"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{children:(N=t.drivetrain)!=null&&N.clutch||(X=t.drivetrain)!=null&&X.converter?"‚úÖ":"‚ùå"}),e.jsx("span",{style:{color:"var(--color-text)"},children:"clutch or converter"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{children:(oe=t.engineHP)!=null&&oe.length?"‚úÖ":"‚ùå"}),e.jsx("span",{style:{color:"var(--color-text)"},children:"engineHP"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{children:(re=t.fuel)!=null&&re.type?"‚úÖ":"‚ùå"}),e.jsx("span",{style:{color:"var(--color-text)"},children:"fuel.type"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[e.jsx("span",{title:((te=t.pmi)==null?void 0:te.engine_flywheel_clutch)!=null&&((ie=t.pmi)==null?void 0:ie.transmission_driveshaft)!=null&&((me=t.pmi)==null?void 0:me.tires_wheels_ringgear)!=null?"All PMI fields present":(()=>{var E,L,F;const d=[];return((E=t.pmi)==null?void 0:E.engine_flywheel_clutch)==null&&d.push("engine_flywheel_clutch"),((L=t.pmi)==null?void 0:L.transmission_driveshaft)==null&&d.push("transmission_driveshaft"),((F=t.pmi)==null?void 0:F.tires_wheels_ringgear)==null&&d.push("tires_wheels_ringgear"),`Missing: ${d.join(", ")}`})(),children:((ne=t.pmi)==null?void 0:ne.engine_flywheel_clutch)!=null&&((Y=t.pmi)==null?void 0:Y.transmission_driveshaft)!=null&&((de=t.pmi)==null?void 0:de.tires_wheels_ringgear)!=null?"‚úÖ":"‚ùå"}),e.jsx("span",{style:{color:"var(--color-text)"},children:"pmi.*"})]})]})]})]}),h&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"Results"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"ET (s)"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:h.et_s.toFixed(3)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"MPH"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:h.mph.toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"Model"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"500"},children:h.meta.model})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"Termination"}),e.jsx("div",{style:{fontSize:"0.875rem"},children:((se=h.meta.termination)==null?void 0:se.reason)||"DISTANCE"})]})]})]}),p.length>0&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:"First 12 Steps"}),e.jsx("button",{onClick:x,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Download CSV"})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",fontSize:"0.75rem",borderCollapse:"collapse",fontFamily:"monospace"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#1e293b",color:"#e2e8f0"},children:[e.jsx("th",{style:{padding:"0.5rem",textAlign:"left",borderBottom:"2px solid var(--color-border)"},children:"Step"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"v_ftps"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"EngRPM"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"wheelRPM"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"ClutchSlip"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"HPSave"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"HPEngPMI"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"HPChasPMI"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"DragHP"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"HP_L1"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"HP_L2"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"PQWT"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"AMin"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"AMax"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"AGS"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Vel_next"}),e.jsx("th",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Dist_next"})]})}),e.jsx("tbody",{children:p.map((d,E)=>e.jsxs("tr",{style:{backgroundColor:E%2===0?"transparent":"rgba(0,0,0,0.02)"},children:[e.jsx("td",{style:{padding:"0.5rem",borderBottom:"1px solid var(--color-border)"},children:d.step}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.v_ftps.toFixed(3)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.EngRPM.toFixed(0)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.wheelRPM.toFixed(2)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.ClutchSlip.toFixed(4)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.HPSave.toFixed(1)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.HPEngPMI.toFixed(1)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.HPChasPMI.toFixed(1)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.DragHP.toFixed(2)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.HP_afterL1.toFixed(1)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.HP_afterL2.toFixed(1)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.PQWT.toFixed(1)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.AMin.toFixed(3)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.AMax.toFixed(3)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.AGS_applied.toFixed(3)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.Vel_next.toFixed(3)}),e.jsx("td",{style:{padding:"0.5rem",textAlign:"right",borderBottom:"1px solid var(--color-border)"},children:d.Dist_next.toFixed(6)})]},d.step))})]})})]}),h&&p.length===0&&e.jsx("div",{style:{padding:"2rem",textAlign:"center",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",color:"var(--color-muted)"},children:e.jsxs("p",{style:{margin:0,fontSize:"0.875rem"},children:["Step data capture not yet implemented. Enable ",e.jsx("code",{children:"enableStepTrace"})," flag and implement step data collection hook in rsaclassic.ts."]})})]})}function tt(r){return{vehicle:{name:"VB6 Fixture Vehicle",weightLb:r.vehicle.weight_lb},env:{elevation:r.env.elevation_ft,temperatureF:r.env.temperature_F,barometerInHg:r.env.barometer_inHg,humidityPct:r.env.relHumidity_pct,trackTempF:r.env.trackTemp_F,tractionIndex:r.env.tractionIndex,windMph:r.env.wind_mph,windAngleDeg:r.env.wind_angle_deg},raceLength:"QUARTER"}}function ci(){const{fixture:r}=Ie(),t=Jr("enableEnergyLogging"),[n,o]=y.useState(!1),[c,s]=y.useState(null),[u,m]=y.useState(null),[a,k]=y.useState(null),j=async()=>{o(!0),s(null),m(null),k(null);try{Ke(r);const P=tt(r);P.raceLength="QUARTER";const h=await gr("VB6Exact",P);m(h);const v=h.meta.energy;if(v){const p=v.engine_in_ftlbf||0,S=v.balance_ftlbf||0;k({engine_in_ftlbf:v.engine_in_ftlbf||0,drag_loss_ftlbf:v.drag_loss_ftlbf||0,rolling_resistance_ftlbf:v.rolling_resistance_ftlbf||0,driveline_loss_ftlbf:v.driveline_loss_ftlbf||0,engine_pmi_loss_ftlbf:v.engine_pmi_loss_ftlbf||0,chassis_pmi_loss_ftlbf:v.chassis_pmi_loss_ftlbf||0,final_ke_ftlbf:v.final_ke_ftlbf||0,balance_ftlbf:S,balance_pct:p>0?S/p*100:0})}else s("Energy data not available in simulation result. Enable enableEnergyLogging flag.")}catch(P){P instanceof Xe?s(`Fixture validation failed:

${P.message}

Please complete all required fields in VB6 Inputs panel.`):s(P instanceof Error?P.message:String(P))}finally{o(!1)}},T=()=>{if(!a)return;const P=JSON.stringify(a,null,2),h=new Blob([P],{type:"application/json"}),v=URL.createObjectURL(h),p=document.createElement("a");p.href=v,p.download=`energy-breakdown-${Date.now()}.json`,p.click(),URL.revokeObjectURL(v)},C=()=>{if(!a)return;const P=["Category","Energy (ft-lbf)","Percentage"],h=a.engine_in_ftlbf,v=[["Engine Input",a.engine_in_ftlbf,"100.00%"],["Drag Loss",a.drag_loss_ftlbf,`${(a.drag_loss_ftlbf/h*100).toFixed(2)}%`],["Rolling Resistance",a.rolling_resistance_ftlbf,`${(a.rolling_resistance_ftlbf/h*100).toFixed(2)}%`],["Driveline Loss",a.driveline_loss_ftlbf,`${(a.driveline_loss_ftlbf/h*100).toFixed(2)}%`],["Engine PMI Loss",a.engine_pmi_loss_ftlbf,`${(a.engine_pmi_loss_ftlbf/h*100).toFixed(2)}%`],["Chassis PMI Loss",a.chassis_pmi_loss_ftlbf,`${(a.chassis_pmi_loss_ftlbf/h*100).toFixed(2)}%`],["Final Kinetic Energy",a.final_ke_ftlbf,`${(a.final_ke_ftlbf/h*100).toFixed(2)}%`],["Balance",a.balance_ftlbf,`${a.balance_pct.toFixed(2)}%`]],p=[P.join(","),...v.map(i=>i.join(","))].join(`
`),S=new Blob([p],{type:"text/csv"}),g=URL.createObjectURL(S),_=document.createElement("a");_.href=g,_.download=`energy-breakdown-${Date.now()}.csv`,_.click(),URL.revokeObjectURL(g)};return e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Energy Accounting"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Visualize energy flow and balance during simulation runs."})]}),!t&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fef3c7",border:"1px solid #fbbf24",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:e.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"#92400e"},children:[e.jsx("strong",{children:"üí° Instructions:"})," Enable ",e.jsx("code",{children:"enableEnergyLogging"})," flag in the Feature Flags panel to capture energy accounting data during simulation runs."]})}),c&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"0.875rem",color:"#991b1b"},children:c}),e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsx("button",{onClick:j,disabled:n,style:{padding:"0.75rem 1.5rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:n?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:n?"not-allowed":"pointer"},children:n?"Running...":"Run VB6Exact (QUARTER)"})}),u&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"Run Results"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"ET (s)"}),e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:u.et_s.toFixed(3)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"MPH"}),e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:u.mph.toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"Model"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"500"},children:u.meta.model})]})]})]}),a&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:"Energy Breakdown"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:T,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Export JSON"}),e.jsx("button",{onClick:C,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Export CSV"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx(be,{label:"Engine Input",value:a.engine_in_ftlbf,percentage:100,color:"#10b981",isInput:!0}),e.jsx(be,{label:"Drag Loss",value:a.drag_loss_ftlbf,percentage:a.drag_loss_ftlbf/a.engine_in_ftlbf*100,color:"#ef4444"}),e.jsx(be,{label:"Rolling Resistance",value:a.rolling_resistance_ftlbf,percentage:a.rolling_resistance_ftlbf/a.engine_in_ftlbf*100,color:"#f59e0b"}),e.jsx(be,{label:"Driveline Loss",value:a.driveline_loss_ftlbf,percentage:a.driveline_loss_ftlbf/a.engine_in_ftlbf*100,color:"#f59e0b"}),e.jsx(be,{label:"Engine PMI Loss",value:a.engine_pmi_loss_ftlbf,percentage:a.engine_pmi_loss_ftlbf/a.engine_in_ftlbf*100,color:"#f59e0b"}),e.jsx(be,{label:"Chassis PMI Loss",value:a.chassis_pmi_loss_ftlbf,percentage:a.chassis_pmi_loss_ftlbf/a.engine_in_ftlbf*100,color:"#f59e0b"}),e.jsx(be,{label:"Final Kinetic Energy",value:a.final_ke_ftlbf,percentage:a.final_ke_ftlbf/a.engine_in_ftlbf*100,color:"#3b82f6"}),e.jsx(be,{label:"Balance (Error)",value:a.balance_ftlbf,percentage:a.balance_pct,color:Math.abs(a.balance_pct)<1?"#10b981":"#ef4444",showSign:!0})]}),e.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",backgroundColor:"#1e293b",borderRadius:"var(--radius-md)",color:"#e2e8f0",fontFamily:"monospace",fontSize:"0.875rem"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Total Energy In:"})," ",a.engine_in_ftlbf.toLocaleString()," ft-lbf"]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Total Losses:"})," ",(a.drag_loss_ftlbf+a.rolling_resistance_ftlbf+a.driveline_loss_ftlbf+a.engine_pmi_loss_ftlbf+a.chassis_pmi_loss_ftlbf).toLocaleString()," ","ft-lbf"]}),e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{children:"Final KE:"})," ",a.final_ke_ftlbf.toLocaleString()," ft-lbf"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Balance:"})," ",a.balance_ftlbf.toLocaleString()," ft-lbf (",a.balance_pct.toFixed(2),"%)"]})]})]})]})}function be({label:r,value:t,percentage:n,color:o,isInput:c,showSign:s}){const u=s&&t>=0?`+${t.toLocaleString()}`:t.toLocaleString(),m=Math.min(Math.abs(n),100);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.25rem",fontSize:"0.875rem"},children:[e.jsx("span",{style:{fontWeight:c?"600":"400"},children:r}),e.jsxs("span",{style:{fontFamily:"monospace"},children:[u," ft-lbf (",n.toFixed(2),"%)"]})]}),e.jsx("div",{style:{width:"100%",height:"24px",backgroundColor:"#e5e7eb",borderRadius:"var(--radius-sm)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${m}%`,height:"100%",backgroundColor:o,transition:"width 0.3s ease"}})})]})}const Qe=[{name:"SuperGas_Pro",source:"QuarterPro",raceLengthTargets:{EIGHTH:{et_s:6.27,mph:108.2,tolET_s:.2,tolMPH:3,anchors:{t60_s:1.35}},QUARTER:{et_s:9.9,mph:135.1,tolET_s:.3,tolMPH:4}}},{name:"ProStock_Pro",source:"QuarterPro",raceLengthTargets:{EIGHTH:{et_s:4.37,mph:160.9,tolET_s:.12,tolMPH:4,anchors:{t60_s:1.01}},QUARTER:{et_s:6.8,mph:202.3,tolET_s:.15,tolMPH:5}}},{name:"Motorcycle_Pro",source:"QuarterPro",raceLengthTargets:{EIGHTH:{et_s:7.63,mph:91.1,tolET_s:.25,tolMPH:3},QUARTER:{et_s:11.99,mph:111.3,tolET_s:.3,tolMPH:3}}},{name:"SuperComp_Pro",source:"QuarterPro",raceLengthTargets:{EIGHTH:{et_s:5.66,mph:120.4,tolET_s:.18,tolMPH:4},QUARTER:{et_s:8.9,mph:151.6,tolET_s:.2,tolMPH:4}}},{name:"ETRacer_Jr",source:"QuarterJr",raceLengthTargets:{EIGHTH:{et_s:8.6,mph:80.3,tolET_s:.3,tolMPH:3},QUARTER:{et_s:13.5,mph:100.8,tolET_s:.35,tolMPH:3.5}}}];function mi(r,t,n,o){const c=r.raceLengthTargets[t];if(!c)throw new Error(`Benchmark ${r.name} has no target for ${t}`);const s=n-c.et_s,u=o-c.mph,m=Math.abs(s)<=c.tolET_s,a=Math.abs(u)<=c.tolMPH;return{pass:m&&a,etPass:m,mphPass:a,etDelta:s,mphDelta:u,etTolerance:c.tolET_s,mphTolerance:c.tolMPH}}function hi(r){const t=[];if(r.env.elevation===void 0&&t.push("env.elevation"),r.env.barometerInHg===void 0&&t.push("env.barometerInHg"),r.env.temperatureF===void 0&&t.push("env.temperatureF"),r.env.humidityPct===void 0&&t.push("env.humidityPct"),r.vehicle.weightLb||t.push("vehicle.weightLb"),!r.vehicle.tireDiaIn&&!r.vehicle.tireRolloutIn&&t.push("vehicle.tireDiaIn OR vehicle.tireRolloutIn"),r.vehicle.rolloutIn===void 0&&t.push("vehicle.rolloutIn"),!r.vehicle.rearGear&&!r.vehicle.finalDrive&&t.push("vehicle.rearGear OR vehicle.finalDrive"),(!r.vehicle.gearRatios||r.vehicle.gearRatios.length===0)&&t.push("vehicle.gearRatios[]"),r.vehicle.shiftRPM===void 0&&t.push("vehicle.shiftRPM[]"),r.vehicle.frontalArea_ft2===void 0&&t.push("vehicle.frontalArea_ft2"),r.vehicle.cd===void 0&&t.push("vehicle.cd"),!r.vehicle.torqueCurve||r.vehicle.torqueCurve.length===0?t.push("vehicle.torqueCurve[]"):r.vehicle.torqueCurve.every(o=>o.rpm!==void 0&&(o.hp!==void 0||o.tq_lbft!==void 0))||t.push("vehicle.torqueCurve[] must have rpm and (hp OR tq_lbft) for each point"),r.vehicle.converter&&(r.vehicle.converter.stallRPM===void 0&&t.push("vehicle.converter.stallRPM (required if converter present)"),r.vehicle.converter.torqueMult===void 0&&t.push("vehicle.converter.torqueMult (required if converter present)"),r.vehicle.converter.slipRatio===void 0&&r.vehicle.converter.slippageFactor===void 0&&t.push("vehicle.converter.slipRatio OR slippageFactor (required if converter present)")),r.vehicle.clutch&&(r.vehicle.clutch.slipRPM===void 0&&r.vehicle.clutch.launchRPM===void 0&&t.push("vehicle.clutch.slipRPM OR vehicle.clutch.launchRPM (required if clutch present)"),r.vehicle.clutch.slipRatio===void 0&&r.vehicle.clutch.slippageFactor===void 0&&t.push("vehicle.clutch.slipRatio OR slippageFactor (required if clutch present)")),r.vehicle.gearRatios&&r.vehicle.shiftRPM!==void 0){const n=r.vehicle.gearRatios.length,o=r.vehicle.shiftRPM.length,c=n-1;o!==c&&o!==n&&t.push(`vehicle.shiftRPM[] length mismatch (${o} shifts for ${n} gears, expected ${c})`)}if(r.vehicle.gearEff&&r.vehicle.gearRatios&&r.vehicle.gearEff.length!==r.vehicle.gearRatios.length&&t.push(`vehicle.gearEff[] length mismatch (${r.vehicle.gearEff.length} vs ${r.vehicle.gearRatios.length} gears)`),t.length>0)throw new Error(`Benchmark config '${r.name}' is missing required VB6 parameters:
`+t.map(n=>`  - ${n}`).join(`
`)+`

All required fields must be present from VB6 printouts - NO DEFAULTS ALLOWED.
This ensures VB6 parity by preventing silent defaults in the simulation.`)}const fr={ProStock_Pro:{name:"ProStock_Pro",fuel:"GAS",env:{elevation:32,barometerInHg:29.92,temperatureF:75,humidityPct:55,windMph:5,windAngleDeg:135,trackTempF:105,tractionIndex:3},vehicle:{weightLb:2355,wheelbaseIn:107,overhangIn:40,rolloutIn:9,tireDiaIn:102.5,tireWidthIn:17,frontalArea_ft2:18.2,cd:.24,liftCoeff:.1,finalDrive:4.86,transEff:.975,gearRatios:[2.6,1.9,1.5,1.2,1],gearEff:[.99,.991,.992,.993,.994],shiftRPM:[9400,9400,9400,9400],clutch:{launchRPM:7200,slipRPM:7600,slippageFactor:1.004,lockup:!1},pmi:{engine_flywheel_clutch:3.42,transmission_driveshaft:.247,tires_wheels_ringgear:50.8},torqueCurve:[{rpm:7e3,hp:1078},{rpm:7250,hp:1131},{rpm:7500,hp:1177},{rpm:7750,hp:1216},{rpm:8e3,hp:1251},{rpm:8250,hp:1274},{rpm:8500,hp:1288},{rpm:8750,hp:1300},{rpm:9e3,hp:1297},{rpm:9250,hp:1269},{rpm:9500,hp:1222}]}},FunnyCar_Pro:{name:"FunnyCar_Pro",fuel:"GAS",env:{elevation:300,barometerInHg:29.92,temperatureF:76,humidityPct:50,windMph:0,windAngleDeg:0,trackTempF:112,tractionIndex:1},vehicle:{weightLb:2350,wheelbaseIn:125,overhangIn:40,rolloutIn:12,tireDiaIn:118,tireWidthIn:18,frontalArea_ft2:24.1,cd:.5,liftCoeff:.8,finalDrive:3.2,transEff:.96,gearRatios:[1],gearEff:[1],shiftRPM:[],clutch:{launchRPM:6400,slipRPM:6800,slippageFactor:1,lockup:!0},pmi:{engine_flywheel_clutch:6.03,transmission_driveshaft:.107,tires_wheels_ringgear:75.4},torqueCurve:[{rpm:6400,hp:6116},{rpm:6600,hp:6276},{rpm:6800,hp:6306},{rpm:7e3,hp:6139},{rpm:7200,hp:5829},{rpm:7400,hp:5344},{rpm:7600,hp:4732},{rpm:7800,hp:3993}]}},TA_Dragster_Pro:{name:"TA_Dragster_Pro",fuel:"GAS",env:{elevation:0,barometerInHg:29.92,temperatureF:77,humidityPct:45,windMph:0,windAngleDeg:0,trackTempF:110,tractionIndex:2},vehicle:{weightLb:1980,wheelbaseIn:280,overhangIn:30,rolloutIn:12,tireDiaIn:110,tireWidthIn:17,frontalArea_ft2:19.5,cd:.58,liftCoeff:.4,finalDrive:4.56,transEff:.97,gearRatios:[1.85,1.3,1],gearEff:[.97,.98,.99],shiftRPM:[9200,9400],clutch:{launchRPM:6e3,slipRPM:7200,slippageFactor:1.01,lockup:!1},pmi:{engine_flywheel_clutch:4.84,transmission_driveshaft:.426,tires_wheels_ringgear:64.6},torqueCurve:[{rpm:6e3,hp:1847},{rpm:6500,hp:2058},{rpm:7e3,hp:2256},{rpm:7500,hp:2458},{rpm:8e3,hp:2639},{rpm:8500,hp:2729},{rpm:9e3,hp:2672},{rpm:9500,hp:2415},{rpm:1e4,hp:1999}]}},SuperComp_Pro:{name:"SuperComp_Pro",fuel:"GAS",env:{elevation:600,barometerInHg:29.92,temperatureF:87,humidityPct:35,windMph:0,windAngleDeg:0,trackTempF:112,tractionIndex:5},vehicle:{weightLb:1700,wheelbaseIn:225,overhangIn:30,rolloutIn:12,tireDiaIn:32.6,tireWidthIn:13.2,frontalArea_ft2:13.6,cd:.5,liftCoeff:.15,finalDrive:4.56,transEff:.97,gearRatios:[1.76,1],gearEff:[.97,.99],shiftRPM:[7500],converter:{launchRPM:5e3,stallRPM:5500,torqueMult:1.7,slippageFactor:1.06,lockup:!1},pmi:{engine_flywheel_clutch:3.26,transmission_driveshaft:.511,tires_wheels_ringgear:43.6},torqueCurve:[{rpm:3500,hp:260},{rpm:4500,hp:351},{rpm:5500,hp:438},{rpm:6500,hp:520},{rpm:7e3,hp:538},{rpm:7500,hp:521},{rpm:8e3,hp:477}]}},SuperGas_Pro:{name:"SuperGas_Pro",fuel:"GAS",env:{elevation:850,barometerInHg:29.92,temperatureF:77,humidityPct:30,windMph:0,windAngleDeg:0,trackTempF:102,tractionIndex:5},vehicle:{weightLb:2300,wheelbaseIn:103,overhangIn:30,rolloutIn:12,tireDiaIn:32.4,tireWidthIn:14.4,frontalArea_ft2:22.1,cd:.4,liftCoeff:.25,finalDrive:5.14,transEff:.97,gearRatios:[1.76,1],gearEff:[.97,.99],shiftRPM:[7600],converter:{launchRPM:5e3,stallRPM:5500,torqueMult:1.7,slippageFactor:1.06,lockup:!1},pmi:{engine_flywheel_clutch:3.26,transmission_driveshaft:.511,tires_wheels_ringgear:52.7},torqueCurve:[{rpm:3500,hp:267},{rpm:4500,hp:351},{rpm:5500,hp:432},{rpm:6500,hp:491},{rpm:7e3,hp:500},{rpm:7500,hp:468},{rpm:8e3,hp:421}]}},Motorcycle_Pro:{name:"Motorcycle_Pro",fuel:"GAS",env:{elevation:0,barometerInHg:29.92,temperatureF:72,humidityPct:45,windMph:6,windAngleDeg:180,trackTempF:98,tractionIndex:2},vehicle:{weightLb:650,wheelbaseIn:54,overhangIn:12,rolloutIn:12,tireDiaIn:25,tireWidthIn:5,frontalArea_ft2:6.8,cd:.55,liftCoeff:.05,finalDrive:5.72,transEff:.99,gearRatios:[3,2.1,1.65,1.38,1.23,1.1],gearEff:[.99,.991,.992,.993,.994,.995],shiftRPM:[10800,10900,11e3,11e3,11e3],clutch:{launchRPM:11e3,slipRPM:8500,slippageFactor:1,lockup:!0},pmi:{engine_flywheel_clutch:.18,transmission_driveshaft:.031,tires_wheels_ringgear:4.3},torqueCurve:[{rpm:6500,hp:40},{rpm:7e3,hp:47},{rpm:7500,hp:53},{rpm:8e3,hp:58},{rpm:8500,hp:62},{rpm:9e3,hp:66},{rpm:9500,hp:69},{rpm:1e4,hp:72},{rpm:10500,hp:73},{rpm:11e3,hp:73},{rpm:11500,hp:72}]}},Motorcycle_Jr:{name:"Motorcycle_Jr",fuel:"GAS",env:{elevation:900,barometerInHg:29.92,temperatureF:74,humidityPct:40,tractionIndex:3},vehicle:{weightLb:730,wheelbaseIn:54,rolloutIn:12,tireDiaIn:28,tireWidthIn:5,frontalArea_ft2:7.9,cd:.55,liftCoeff:.05,finalDrive:6.81,transEff:.99,gearRatios:[2.74,1.96,1.4,1],shiftRPM:[8e3,8e3,8e3],clutch:{launchRPM:6e3,slipRPM:6e3,slippageFactor:1,lockup:!0},torqueCurve:[{rpm:5e3,hp:62},{rpm:5500,hp:68},{rpm:6e3,hp:73},{rpm:6500,hp:77},{rpm:7e3,hp:80},{rpm:7200,hp:80},{rpm:7500,hp:80},{rpm:8e3,hp:80},{rpm:8500,hp:78}]}},ETRacer_Jr:{name:"ETRacer_Jr",fuel:"GAS",env:{elevation:680,barometerInHg:29.92,temperatureF:86,humidityPct:60,tractionIndex:8},vehicle:{weightLb:3600,wheelbaseIn:108,rolloutIn:14,tireDiaIn:28,tireWidthIn:10,frontalArea_ft2:26.1,cd:.45,liftCoeff:.2,finalDrive:4.11,transEff:.97,gearRatios:[2.48,1.48,1],shiftRPM:[6e3,6e3],converter:{launchRPM:2500,stallRPM:3e3,lockup:!1,diameterIn:10,slippageFactor:1.05,torqueMult:1.6},torqueCurve:[{rpm:3e3,hp:220},{rpm:3500,hp:250},{rpm:4e3,hp:275},{rpm:4500,hp:295},{rpm:5e3,hp:310},{rpm:5500,hp:322},{rpm:5600,hp:325},{rpm:6e3,hp:325},{rpm:6500,hp:320}]}},EXP_Jr:{name:"EXP_Jr",fuel:"GAS",env:{elevation:400,barometerInHg:29.92,temperatureF:80,humidityPct:45,tractionIndex:4},vehicle:{weightLb:2100,wheelbaseIn:180,rolloutIn:12,tireDiaIn:30,tireWidthIn:12,frontalArea_ft2:15.5,cd:.48,liftCoeff:.18,finalDrive:4.3,transEff:.97,gearRatios:[1.8,1.3,1],shiftRPM:[7800,8e3],clutch:{launchRPM:5500,slipRPM:6e3,slippageFactor:1.005,lockup:!1},torqueCurve:[{rpm:5e3,hp:750},{rpm:5500,hp:810},{rpm:6e3,hp:860},{rpm:6500,hp:900},{rpm:7e3,hp:930},{rpm:7500,hp:950},{rpm:8e3,hp:960},{rpm:8500,hp:960},{rpm:9e3,hp:950}]}},EXP_050523_Jr:{name:"EXP_050523_Jr",fuel:"GAS",env:{elevation:420,barometerInHg:29.92,temperatureF:78,humidityPct:48,tractionIndex:4},vehicle:{weightLb:2080,wheelbaseIn:180,rolloutIn:12,tireDiaIn:30.5,tireWidthIn:12.5,frontalArea_ft2:15.2,cd:.46,liftCoeff:.16,finalDrive:4.25,transEff:.975,gearRatios:[1.82,1.32,1],shiftRPM:[7900,8100],clutch:{launchRPM:5600,slipRPM:6100,slippageFactor:1.004,lockup:!1},torqueCurve:[{rpm:5e3,hp:770},{rpm:5500,hp:830},{rpm:6e3,hp:880},{rpm:6500,hp:920},{rpm:7e3,hp:955},{rpm:7500,hp:980},{rpm:8e3,hp:995},{rpm:8500,hp:1e3},{rpm:9e3,hp:995}]}}};(()=>{const r=fr.ProStock_Pro;if(!r)return;const t=Qr,n=r.vehicle;n.weightLb=t.vehicle.weight_lb,n.wheelbaseIn=t.vehicle.wheelbase_in,n.overhangIn=t.vehicle.overhang_in??n.overhangIn,n.rolloutIn=t.vehicle.rollout_in??n.rolloutIn,n.tireDiaIn=t.vehicle.tire.diameter_in,n.tireRolloutIn=t.vehicle.tire.diameter_in*Math.PI,n.tireWidthIn=t.vehicle.tire.width_in,n.frontalArea_ft2=t.aero.frontalArea_ft2,n.cd=t.aero.Cd,n.liftCoeff=t.aero.Cl??n.liftCoeff,n.finalDrive=t.drivetrain.finalDrive,n.transEff=t.drivetrain.overallEfficiency,n.gearRatios=[...t.drivetrain.gearRatios],n.gearEff=[...t.drivetrain.perGearEff],n.shiftRPM=[...t.drivetrain.shiftsRPM],n.clutch={launchRPM:t.drivetrain.clutch.launchRPM,slipRPM:t.drivetrain.clutch.slipRPM,slipRatio:t.drivetrain.clutch.slippageFactor,lockup:t.drivetrain.clutch.lockup},n.pmi={engine_flywheel_clutch:t.pmi.engine_flywheel_clutch,transmission_driveshaft:t.pmi.transmission_driveshaft,tires_wheels_ringgear:t.pmi.tires_wheels_ringgear},n.engine={hpCurve:t.engineHP.map(([o,c])=>({rpm:o,hp:c})),fuelType:t.fuel.type,hpTorqueMultiplier:t.fuel.hpTorqueMultiplier},r.env.elevation=t.env.elevation_ft,r.env.barometerInHg=t.env.barometer_inHg,r.env.temperatureF=t.env.temperature_F,r.env.humidityPct=t.env.relHumidity_pct,r.env.windMph=t.env.wind_mph,r.env.windAngleDeg=t.env.wind_angle_deg,r.env.trackTempF=t.env.trackTemp_F,r.env.tractionIndex=t.env.tractionIndex})();const Gr={ProStock_Pro:Qr};function pi(r){var o;const t=fr[r];if(!t)throw new Error(`Benchmark config not found: ${r}`);return{env:{elevation_ft:t.env.elevation,barometer_inHg:t.env.barometerInHg,temperature_F:t.env.temperatureF,relHumidity_pct:t.env.humidityPct,wind_mph:t.env.windMph??0,wind_angle_deg:t.env.windAngleDeg??0,trackTemp_F:t.env.trackTempF??t.env.temperatureF,tractionIndex:t.env.tractionIndex??1},vehicle:{weight_lb:t.vehicle.weightLb,wheelbase_in:t.vehicle.wheelbaseIn??100,overhang_in:t.vehicle.overhangIn??40,rollout_in:t.vehicle.rolloutIn,staticFrontWeight_lb:t.vehicle.weightLb*.38,cgHeight_in:(t.vehicle.tireDiaIn??32)/2+3.75,bodyStyle:1,tire:{diameter_in:t.vehicle.tireDiaIn??(t.vehicle.tireRolloutIn??100)/Math.PI,width_in:t.vehicle.tireWidthIn??10}},aero:{frontalArea_ft2:t.vehicle.frontalArea_ft2,Cd:t.vehicle.cd,Cl:t.vehicle.liftCoeff??0},drivetrain:{finalDrive:t.vehicle.finalDrive??t.vehicle.rearGear??3,overallEfficiency:t.vehicle.transEff??.95,gearRatios:t.vehicle.gearRatios??[1],perGearEff:t.vehicle.gearEff??[.95],shiftsRPM:t.vehicle.shiftRPM??[7e3],clutch:t.vehicle.clutch?{launchRPM:t.vehicle.clutch.launchRPM??3e3,slipRPM:t.vehicle.clutch.slipRPM??3500,slippageFactor:t.vehicle.clutch.slipRatio??.1,lockup:t.vehicle.clutch.lockup??!1}:void 0,converter:t.vehicle.converter?{stallRPM:t.vehicle.converter.stallRPM??2500,torqueMult:t.vehicle.converter.torqueMult??2,slippageFactor:t.vehicle.converter.slipRatio??.1,lockup:t.vehicle.converter.lockup??!1}:void 0},pmi:{engine_flywheel_clutch:.5,transmission_driveshaft:.2,tires_wheels_ringgear:.3},engineHP:((o=t.vehicle.torqueCurve)==null?void 0:o.map(c=>[c.rpm,c.hp??0]))??[],fuel:{type:t.fuel??"GAS",hpTorqueMultiplier:1}}}function ui(){const{fixture:r,setFixture:t}=Ie(),[n,o]=y.useState(JSON.stringify(r,null,2)),[c,s]=y.useState(null),[u,m]=y.useState(null),[a,k]=y.useState("ProStock_Pro"),[j,T]=y.useState("ProStock_Pro"),[C,P]=y.useState(null),h=()=>{try{const i=JSON.parse(n);Ke(i),s(null),alert("‚úì Fixture is valid and complete!")}catch(i){i instanceof Xe?s(i.message):i instanceof SyntaxError?s(`JSON Syntax Error: ${i.message}`):s(i instanceof Error?i.message:String(i))}},v=()=>{try{const i=JSON.parse(n);t(i),s(null),alert("‚úì Applied to UI fixture store!")}catch(i){i instanceof SyntaxError?s(`JSON Syntax Error: ${i.message}`):s(i instanceof Error?i.message:String(i))}},p=()=>{try{const i=JSON.parse(n);Ke(i);const b=tt(i);m(b),s(null)}catch(i){i instanceof Xe?(s(i.message),m(null)):i instanceof SyntaxError?s(`JSON Syntax Error: ${i.message}`):s(i instanceof Error?i.message:String(i))}},S=()=>{u&&(navigator.clipboard.writeText(JSON.stringify(u,null,2)),alert("‚úì Copied simulation input to clipboard!"))},g=()=>{try{const i=JSON.parse(n),b=Gr[a],x=it(i,b,"");P(x.length>0?x.join(`
`):"No differences found")}catch(i){P(`Error: ${i instanceof Error?i.message:String(i)}`)}},_=()=>{try{const i=pi(j),b=JSON.stringify(i,null,2);o(b),t(i),s(null),alert(`‚úì Populated from benchmark: ${j}`)}catch(i){s(i instanceof Error?i.message:String(i))}};return e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Input Inspector (VB6)"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Visualize, validate, and compare VB6 fixtures and simulation inputs."})]}),c&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"0.875rem",color:"#991b1b"},children:c}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"Load from Benchmark"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("select",{value:j,onChange:i=>T(i.target.value),style:{flex:1,padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"},children:Qe.map(i=>e.jsxs("option",{value:i.name,children:[i.name," (",i.source,")"]},i.name))}),e.jsx("button",{onClick:_,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer",whiteSpace:"nowrap"},children:"Populate from Benchmark"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"(A) VB6 UI Fixture (Editable)"}),e.jsx("textarea",{value:n,onChange:i=>o(i.target.value),style:{width:"100%",height:"400px",padding:"0.75rem",fontFamily:"monospace",fontSize:"0.75rem",backgroundColor:"#1e293b",color:"#e2e8f0",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",resize:"vertical"}}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("button",{onClick:h,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Validate"}),e.jsx("button",{onClick:v,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Apply to UI"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"(B) Simulation Input (Readonly)"}),e.jsx("pre",{style:{width:"100%",height:"400px",padding:"0.75rem",fontFamily:"monospace",fontSize:"0.75rem",backgroundColor:"#1e293b",color:"#e2e8f0",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",overflow:"auto",margin:0},children:u?JSON.stringify(u,null,2):'// Click "Build Input From UI" to generate'}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[e.jsx("button",{onClick:p,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Build Input From UI"}),e.jsx("button",{onClick:S,disabled:!u,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:u?"#6b7280":"#d1d5db",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:u?"pointer":"not-allowed"},children:"Copy Input JSON"})]})]})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"Diff vs Code Fixture"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",alignItems:"center"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500"},children:"Compare against:"}),e.jsx("select",{value:a,onChange:i=>k(i.target.value),style:{padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"},children:Object.keys(Gr).map(i=>e.jsx("option",{value:i,children:i},i))}),e.jsx("button",{onClick:g,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#f59e0b",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Diff vs Fixture"})]}),C&&e.jsx("pre",{style:{padding:"0.75rem",backgroundColor:"#1e293b",color:"#e2e8f0",borderRadius:"var(--radius-sm)",fontSize:"0.75rem",overflow:"auto",margin:0,maxHeight:"300px",whiteSpace:"pre-wrap"},children:C})]})]})}function it(r,t,n){const o=[];for(const c in t){const s=n?`${n}.${c}`:c;c in r?typeof t[c]=="object"&&t[c]!==null&&!Array.isArray(t[c])?o.push(...it(r[c],t[c],s)):JSON.stringify(r[c])!==JSON.stringify(t[c])&&(o.push(`~ CHANGED: ${s}`),o.push(`  Reference: ${JSON.stringify(t[c])}`),o.push(`  Current:   ${JSON.stringify(r[c])}`)):o.push(`- MISSING: ${s}`)}for(const c in r)if(!(c in t)){const s=n?`${n}.${c}`:c;o.push(`+ ADDED: ${s} = ${JSON.stringify(r[c])}`)}return o}const Vr="rsa.quickpaste.profiles.v1";function gi(){const r=$r(),[t]=Kr(),{fixture:n,setFixture:o}=Ie(),[c,s]=y.useState(""),[u,m]=y.useState([]),[a,k]=y.useState(null),[j,T]=y.useState(""),[C,P]=y.useState(""),[h,v]=y.useState(""),[p,S]=y.useState(null),[g,_]=y.useState([]),[i,b]=y.useState(""),[x,l]=y.useState(""),[R,A]=y.useState(null),[M,N]=y.useState(!1);y.useEffect(()=>{try{const d=localStorage.getItem(Vr);d&&_(JSON.parse(d))}catch(d){console.error("Failed to load profiles:",d)}},[]);const X=d=>{try{localStorage.setItem(Vr,JSON.stringify(d)),_(d)}catch(E){console.error("Failed to save profiles:",E)}},oe=d=>{const E=d.trim().split(`
`),L=[];for(const F of E){const z=F.trim();if(!z)continue;const D=z.split(/[\s,]+/);if(D.length<2)throw new Error(`Invalid line: "${F}" - expected "RPM HP" or "RPM,HP"`);const w=parseFloat(D[0]),Z=parseFloat(D[1]);if(isNaN(w)||isNaN(Z))throw new Error(`Invalid numbers in line: "${F}"`);L.push({rpm:w,hp:Z})}if(L.length===0)throw new Error("No valid dyno data found");return L.sort((F,z)=>F.rpm-z.rpm),L},re=()=>{try{const d=oe(c);m(d),k(null)}catch(d){k(d instanceof Error?d.message:String(d)),m([])}},te=()=>{try{const d=oe(c);o({...n,engineHP:d.map(E=>[E.rpm,E.hp])}),k(null),alert(`‚úì Applied ${d.length} dyno points to VB6 UI Fixture!`)}catch(d){k(d instanceof Error?d.message:String(d))}},ie=()=>{try{S(null);const d={},E={};if(j.trim()){const F=parseFloat(j);if(isNaN(F))throw new Error("Invalid PMI Engine value");d.engine_flywheel_clutch=F}if(C.trim()){const F=parseFloat(C);if(isNaN(F))throw new Error("Invalid PMI Chassis value");d.tires_wheels_ringgear=F}if(h.trim()){const F=h.split(",").map(D=>D.trim()),z=[];for(const D of F){const w=parseFloat(D);if(isNaN(w))throw new Error(`Invalid gear efficiency value: "${D}"`);z.push(w)}E.perGearEff=z}if(Object.keys(d).length===0&&Object.keys(E).length===0){S("No values to apply");return}const L={...n};Object.keys(d).length>0&&(L.pmi={...n.pmi,...d}),Object.keys(E).length>0&&(L.drivetrain={...n.drivetrain,...E}),o(L),alert("‚úì Applied PMI values to VB6 UI Fixture!")}catch(d){S(d instanceof Error?d.message:String(d))}},me=()=>{if(!x.trim()){alert("Please enter a profile name");return}const d={name:x.trim(),timestamp:Date.now(),fixture:JSON.parse(JSON.stringify(n))},E=[...g,d];X(E),l(""),alert(`‚úì Saved profile "${d.name}"`)},ne=()=>{if(!i){alert("Please select a profile");return}const d=g.find(E=>E.name===i);if(!d){alert("Profile not found");return}o(d.fixture),alert(`‚úì Loaded profile "${d.name}"`)},Y=()=>{if(!i){alert("Please select a profile");return}if(!confirm(`Delete profile "${i}"?`))return;const d=g.filter(E=>E.name!==i);X(d),b("")},de=()=>{try{Ke(n),A(null),alert("‚úì Fixture is complete and valid!")}catch(d){d instanceof Xe?A(d.message):A(d instanceof Error?d.message:String(d))}},se=async()=>{N(!0),A(null);try{const d=await fetch("/src/dev/fixtures/ProStock_Pro.vb6.json");if(!d.ok)throw new Error(`Failed to load fixture: ${d.statusText}`);const E=await d.json();E.pmi||(E.pmi={engine_flywheel_clutch:3.42,transmission_driveshaft:.247,tires_wheels_ringgear:50.8}),o(E);const L=Ze(E);if(L.ok)alert(`‚úì ProStock_Pro fixture loaded and validated successfully!

Fixture valid: all PMI fields detected.`);else{const F=L.missing.join(", ");alert(`‚ö† Fixture loaded but incomplete.

Missing fields: ${F}`),A(`Missing fields: ${F}`)}y.startTransition(()=>{r("/dev?panel=input-inspector")})}catch(d){const E=d instanceof Error?d.message:String(d);A(`Failed to load ProStock_Pro fixture: ${E}`),alert(`‚ùå Error loading fixture: ${E}`)}finally{N(!1)}};return y.useEffect(()=>{t.get("example")==="prostock"&&setTimeout(()=>{se()},0)},[t]),e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Quick Paste (Dyno & PMI)"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Quickly paste dyno tables and PMI values into VB6 fixtures."})]}),R&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"0.875rem",color:"#991b1b"},children:R}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"1. Paste Dyno Table"}),e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--color-muted)",marginBottom:"0.75rem"},children:'Paste dyno data as "RPM HP" or "RPM,HP" (one pair per line)'}),e.jsx("textarea",{value:c,onChange:d=>s(d.target.value),placeholder:`7000 1275
7100 1280
7200 1285`,style:{width:"100%",height:"150px",padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",backgroundColor:"#1e293b",color:"#e2e8f0",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",resize:"vertical"}}),a&&e.jsx("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-sm)",fontSize:"0.875rem",color:"#991b1b"},children:a}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem"},children:[e.jsx("button",{onClick:re,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Preview"}),e.jsx("button",{onClick:te,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Apply to VB6 UI Fixture"})]}),u.length>0&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsxs("h4",{style:{marginTop:0,marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:["Preview (",u.length," points)"]}),e.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#1e293b",borderRadius:"var(--radius-sm)",fontFamily:"monospace",fontSize:"0.75rem",color:"#e2e8f0",maxHeight:"150px",overflow:"auto"},children:[u.slice(0,10).map((d,E)=>e.jsxs("div",{children:[d.rpm.toFixed(0)," RPM ‚Üí ",d.hp.toFixed(1)," HP"]},E)),u.length>10&&e.jsxs("div",{style:{color:"#9ca3af",marginTop:"0.5rem"},children:["... and ",u.length-10," more points"]})]})]})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"2. Paste PMI Values"}),p&&e.jsx("div",{style:{marginBottom:"0.75rem",padding:"0.5rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-sm)",fontSize:"0.875rem",color:"#991b1b"},children:p}),e.jsxs("div",{style:{display:"grid",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.25rem"},children:"PMI Engine (slug-ft¬≤)"}),e.jsx("input",{type:"text",value:j,onChange:d=>T(d.target.value),placeholder:"e.g., 3.42",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.25rem"},children:"PMI Chassis (slug-ft¬≤)"}),e.jsx("input",{type:"text",value:C,onChange:d=>P(d.target.value),placeholder:"e.g., 50.8",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.25rem"},children:"Gear Efficiencies (comma-separated)"}),e.jsx("input",{type:"text",value:h,onChange:d=>v(d.target.value),placeholder:"e.g., 0.98, 0.97, 0.96, 0.95",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}})]})]}),e.jsx("button",{onClick:ie,style:{marginTop:"0.75rem",padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Apply PMI Values"})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"3. Load/Save Profiles"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"Save Current Fixture as Profile"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{type:"text",value:x,onChange:d=>l(d.target.value),placeholder:"Profile name",style:{flex:1,padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}}),e.jsx("button",{onClick:me,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Save"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"Load Profile"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("select",{value:i,onChange:d=>b(d.target.value),style:{flex:1,padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"},children:[e.jsx("option",{value:"",children:"Select a profile..."}),g.map(d=>e.jsxs("option",{value:d.name,children:[d.name," (",new Date(d.timestamp).toLocaleDateString(),")"]},d.name))]}),e.jsx("button",{onClick:ne,disabled:!i,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:i?"#10b981":"#d1d5db",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:i?"pointer":"not-allowed"},children:"Load"}),e.jsx("button",{onClick:Y,disabled:!i,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:i?"#ef4444":"#d1d5db",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:i?"pointer":"not-allowed"},children:"Delete"})]})]}),g.length===0&&e.jsx("p",{style:{marginTop:"0.75rem",fontSize:"0.875rem",color:"var(--color-muted)",fontStyle:"italic"},children:"No saved profiles yet"})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"4. Load Example Fixture"}),e.jsx("button",{onClick:se,disabled:M,style:{padding:"0.75rem 1.5rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:M?"#9ca3af":"#f59e0b",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:M?"not-allowed":"pointer"},children:M?"Loading...":"Load Example: ProStock_Pro"}),e.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--color-muted)"},children:"Loads complete ProStock_Pro fixture from VB6 printout, validates it, and opens Input Inspector"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:de,style:{padding:"0.75rem 1.5rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:"#8b5cf6",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Validate Current Fixture"}),e.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--color-muted)"},children:"Runs assertComplete() to check if all required fields are present"})]})]})}function ot(r){const t=r.elevation_ft??0,n=r.fuelSystem??1,o=[.0205558,.00118163,154988e-10,40245e-11,434856e-15,2096e-14],c=o[0]+o[1]*r.temperature_F+o[2]*r.temperature_F**2+o[3]*r.temperature_F**3+o[4]*r.temperature_F**4+o[5]*r.temperature_F**5,s=r.relHumidity_pct/100*c,u=Math.pow((cr-.00356616*t)/cr,5.25588),m=Dr*r.barometer_inHg/kt*u,a=m-s,k=a/Dr,j=s*zr/(a*dr),T=Hr*(1/dr+j/zr)/(1+j),C=T/(Hr/dr),P=r.temperature_F+Pt,h=P/cr,p=144*m/(T*P)/32.174;let S,g;switch(n){case 1:S=1,g=1;break;case 2:S=1,g=2;break;case 3:S=2,g=1;break;case 4:S=2,g=2;break;case 5:S=3,g=2;break;case 6:S=1,g=3;break;case 7:case 9:S=2,g=3;break;case 8:S=3,g=3;break;default:S=1,g=1;break}const _=1+2.48*Math.pow(j,1.5);let i,b,x;switch(S){case 1:i=1,b=.6,x=.15;break;case 2:i=1,b=.3,x=.13;break;case 3:i=.85,b=.5,x=.055;break;default:i=1,b=.6,x=.15;break}if(g===2&&(x=x-.005),g===3){const R=.3050108932461874;i=.95-R*b,b=b+R,x=.6*x}let l=Math.pow(k,i)/(Math.sqrt(C)*Math.pow(h,b));return l=(1+x)*_/l-x,n===9&&(l=1),{rho_slug_per_ft3:p,pamb_psi:m,PWV_psi:s,pair_psi:a,WAR:j,RGAS:T,temp_R:P,hpc:l,delta:k,theta:h,rgrs:C}}const ur=.002377;function fi(r,t){return .5*r*t*t}function bi(r){return r*5280/3600}function xi(){const{fixture:r,setFixture:t}=Ie(),[n,o]=y.useState(""),[c,s]=y.useState(""),[u,m]=y.useState(""),[a,k]=y.useState(null),[j,T]=y.useState(null);y.useEffect(()=>{var h,v,p;r.env?(o(((h=r.env.barometer_inHg)==null?void 0:h.toString())||"29.92"),s(((v=r.env.temperature_F)==null?void 0:v.toString())||"75"),m(((p=r.env.relHumidity_pct)==null?void 0:p.toString())||"50")):(o("29.92"),s("75"),m("50"))},[r.env]),y.useEffect(()=>{try{const h=parseFloat(n),v=parseFloat(c),p=parseFloat(u);if(isNaN(h)||isNaN(v)||isNaN(p)){k(null),T(null);return}const g=ot({barometer_inHg:h,temperature_F:v,relHumidity_pct:p});k(g),T(null)}catch(h){T(h instanceof Error?h.message:String(h)),k(null)}},[n,c,u]);const C=()=>{var h,v,p,S,g;try{const _=parseFloat(n),i=parseFloat(c),b=parseFloat(u);if(isNaN(_)||isNaN(i)||isNaN(b)){alert("Please enter valid numbers for all fields");return}t({...r,env:{elevation_ft:((h=r.env)==null?void 0:h.elevation_ft)??0,barometer_inHg:_,temperature_F:i,relHumidity_pct:b,wind_mph:((v=r.env)==null?void 0:v.wind_mph)??0,wind_angle_deg:((p=r.env)==null?void 0:p.wind_angle_deg)??0,trackTemp_F:((S=r.env)==null?void 0:S.trackTemp_F)??i,tractionIndex:((g=r.env)==null?void 0:g.tractionIndex)??1}}),alert("‚úì Applied environment values to VB6 UI Fixture!")}catch(_){alert(`Error: ${_ instanceof Error?_.message:String(_)}`)}},P=a?(a.rho_slug_per_ft3-ur)/ur*100:0;return e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Environment & Air Model"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Visualize air density calculations and dynamic pressure at various speeds."})]}),j&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",fontSize:"0.875rem",color:"#991b1b"},children:j}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"Environmental Conditions"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"Barometer (inHg)"}),e.jsx("input",{type:"text",value:n,onChange:h=>o(h.target.value),placeholder:"29.92",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"Temperature (¬∞F)"}),e.jsx("input",{type:"text",value:c,onChange:h=>s(h.target.value),placeholder:"75",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",marginBottom:"0.5rem"},children:"Relative Humidity (%)"}),e.jsx("input",{type:"text",value:u,onChange:h=>m(h.target.value),placeholder:"50",style:{width:"100%",padding:"0.5rem",fontSize:"0.875rem",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--color-bg)"}})]})]}),e.jsx("button",{onClick:C,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Apply to current VB6 UI Fixture"})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"Computed Air Density"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"Air Density (œÅ)"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",fontFamily:"monospace"},children:a.rho_slug_per_ft3.toFixed(6)}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"slugs/ft¬≥"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"Standard œÅ"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",fontFamily:"monospace"},children:ur.toFixed(6)}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:"slugs/ft¬≥ (sea level, 59¬∞F)"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginBottom:"0.25rem"},children:"Delta from Standard"}),e.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",fontFamily:"monospace",color:P>0?"#10b981":P<0?"#ef4444":"inherit"},children:[P>=0?"+":"",P.toFixed(2),"%"]}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:P>0?"Denser (more power)":P<0?"Thinner (less power)":"Standard"})]})]}),e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"#1e293b",borderRadius:"var(--radius-sm)",fontFamily:"monospace",fontSize:"0.75rem",color:"#e2e8f0"},children:[e.jsx("div",{style:{marginBottom:"0.25rem"},children:e.jsx("strong",{children:"Intermediate Values:"})}),e.jsxs("div",{children:["Ambient Pressure: ",a.pamb_psi.toFixed(4)," psi"]}),e.jsxs("div",{children:["Water Vapor Pressure: ",a.PWV_psi.toFixed(4)," psi"]}),e.jsxs("div",{children:["Dry Air Pressure: ",a.pair_psi.toFixed(4)," psi"]}),e.jsxs("div",{children:["Water-to-Air Ratio: ",a.WAR.toFixed(6)]}),e.jsxs("div",{children:["Gas Constant: ",a.RGAS.toFixed(4)," ft¬∑lbf/(lbm¬∑¬∞R)"]}),e.jsxs("div",{children:["Temperature: ",a.temp_R.toFixed(2)," ¬∞R"]})]})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"Dynamic Pressure (q) at Various Speeds"}),e.jsxs("table",{style:{width:"100%",fontSize:"0.875rem",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#1e293b",color:"#e2e8f0"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"2px solid var(--color-border)"},children:"Speed (MPH)"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Speed (ft/s)"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"q (psf)"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"q (psi)"})]})}),e.jsx("tbody",{children:[10,50,100,200].map((h,v)=>{const p=bi(h),S=fi(a.rho_slug_per_ft3,p),g=S/144;return e.jsxs("tr",{style:{backgroundColor:v%2===0?"transparent":"rgba(0,0,0,0.02)"},children:[e.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--color-border)"},children:h}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:p.toFixed(2)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:S.toFixed(4)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:g.toFixed(6)})]},h)})})]}),e.jsxs("div",{style:{marginTop:"1rem",fontSize:"0.75rem",color:"var(--color-muted)"},children:[e.jsx("strong",{children:"Note:"})," Dynamic pressure q = 0.5 √ó œÅ √ó v¬≤. Used in drag force calculation: F_drag = Cd √ó A √ó q"]})]})]})]})}function er(r,t,n,o,c){let s=0;for(s=0;s<n-1&&!(c<=r[s+1]);s++);s>=n-1&&(s=n-2),s<0&&(s=0);const u=r[s],m=r[s+1],a=t[s],k=t[s+1];if(m===u)return a;const j=(c-u)/(m-u);return a+j*(k-a)}function nt(r,t,n,o,c){let s,u;if(c)s=1+4e-5*n,u=s*r*Ne/12;else{const m=(Math.pow(t,1.4)+r-16)/(.171*Math.pow(r,1.7));s=1+m*135e-7*Math.pow(n,1.6);const a=1+m*35e-5*n;a<s&&(s=a),u=(s-.035*Math.abs(o))*r*Ne/12}return{TireGrowth:s,TireCirFt:u}}function st(r,t){return(1-(r-1)*.01)/Math.pow(t,.25)}function lt(r){return r?Bt:Lt}function vi(r,t){if(!(t!=null&&t.enabled))return 1;const{activateTime_s:n,duration_s:o,throttlePct:c,rampTime_s:s=0}=t,u=n+o;if(r<n||r>=u)return 1;const m=c/100;if(s>0&&r<n+s){const a=(r-n)/s;return 1-(1-m)*a}if(s>0&&r>u-s){const a=(u-r)/s;return 1-(1-m)*a}return m}function yi(r,t,n,o,c){const s=r.Gear;let u;const m=r.Gear!==r.PrevGear;if(m)u=t.DTShift,r.PrevGear=r.Gear;else{if(u=o,r.Ags0_g>0&&r.L>1){const G=Math.min(r.AgsMax_g/r.Ags0_g,10);u=o*Math.pow(G,4)}u>.1&&(u=.1)}let a=0;const k=r.time_s-r.Time0_s;k>0&&(a=(r.AGS_g-r.Ags0_g)/k),a<Ue&&(a=Ue),a>qe&&(a=qe),r.Vel0_ftps=r.Vel_ftps,r.Ags0_g=r.AGS_g,r.Time0_s=r.time_s,r.Dist0_ft=r.Dist_ft,r.RPM0=r.EngRPM,r.DSRPM0=r.DSRPM,r.RPM0===t.LaunchRPM&&r.Time0_s===0&&(r.RPM0=t.Stall,t.LaunchRPM<t.Stall&&(r.Time0_s=t.EnginePMI*(t.Stall-t.LaunchRPM)/25e4));const j=nt(t.TireDia_in,t.TireWidth_in,r.Vel_ftps,r.Ags0_g,n.isLandSpeed);r.TireGrowth=j.TireGrowth,r.TireCirFt=j.TireCirFt;let T;n.isLandSpeed?T=1.01+(n.TractionIndex-1)*.01:T=1.02+(.005*(n.TractionIndex-1)+3*(n.TrackTempEffect-1))*(1-Math.pow(r.Dist0_ft/1320,2));const C=t.TGR[s-1]??1,P=t.TiresPMI+t.TransPMI*Math.pow(t.GearRatio,2)*Math.pow(C,2);let h=r.Vel0_ftps+r.Ags0_g*K*u+a*K*u*u/2;h<r.Vel0_ftps*.9&&r.Vel0_ftps>100&&(h=r.Vel0_ftps),h<0&&(h=0);const v=t.ShiftRPM[s-1]??9e3;if(!m&&(u<.005&&(u=.005),u>.05&&(u=.05),h=r.Vel0_ftps+r.Ags0_g*K*u+a*K*u*u/2,r.Vel0_ftps>0&&r.RPM0>t.Stall&&s<t.NGR)){const G=r.Vel0_ftps*(v+5)/r.RPM0;h>G&&(h=G,r.Ags0_g*K>0&&(u=(h-r.Vel0_ftps)/(r.Ags0_g*K)))}const p=h*h-r.Vel0_ftps*r.Vel0_ftps,S=T*h*60/r.TireCirFt,g=S*t.GearRatio*C;let _=t.Slippage*g,i,b=t.Stall,x=0;t.isClutch?(_<t.Stall&&(s===1||!t.LockUp)&&(_=t.Stall),i=g/_):s===1||!t.LockUp?(b=t.Stall,x=t.Slippage*g/b,r.L>2&&(x>.6&&(b=b*(1+(t.Slippage-1)*(x-.6)/(1/t.Slippage-.6))),x=t.Slippage*g/b),i=1/t.Slippage,_<b&&(_=b,i=(t.TorqueMult-(t.TorqueMult-1)*x)*g/b)):(_=1.005*g,i=g/_),i>1&&(i=1);let l=er(t.xrpm,t.yhp,t.NHP,1,_);l=t.HPTQMult*l/n.hpc,t.RevLimiterRPM>0&&_>=t.RevLimiterRPM&&(l=l*.05);const R=vi(r.time_s,c);l=l*R;const A=l;l=l*i;const M=Math.sqrt(h*h+2*h*(n.WindSpeed_mph/Je)*Math.cos(Ne*n.WindAngle_deg/180)+Math.pow(n.WindSpeed_mph/Je,2)),N=Math.sign(M)*n.rho*Math.pow(Math.abs(M),2)/(2*K);let X;t.BodyStyle===8?X=t.RefArea_ft2+(r.TireGrowth-1)*t.TireDia_in/2*t.TireWidth_in/144:X=t.RefArea_ft2+(r.TireGrowth-1)*t.TireDia_in/2*(2*t.TireWidth_in)/144;const oe=t.Weight_lbf+t.LiftCoef*X*N,re=n.isLandSpeed?Xr:Yr,te=n.isLandSpeed?Ct:Tt,ie=n.isLandSpeed?wt:Et,ne=(re-r.Dist0_ft/1320*te)*oe+1e-4*oe*(Je*h)+t.DragCoef*X*N,Y=ne*h/550,de=12*r.TireCirFt/(2*Ne),se=(r.Ags0_g*t.Weight_lbf*(t.YCG_in-de+ie/t.Efficiency*de)+ne*t.YCG_in)/t.Wheelbase_in;let d=t.StaticFWt_lbf-se,E=0;d<0&&(E=-d*t.Wheelbase_in/64,d=0);let L=oe-d-E;L<0&&(L=t.Weight_lbf);const F=st(n.TractionIndex,n.TrackTempEffect),z=lt(n.isLandSpeed);let D=F*z*t.TireDia_in*(t.TireWidth_in+1)*(.92+.08*Math.pow(L/1900,2.15));t.BodyStyle===8&&(D=.5*D);const w=(D/r.TireGrowth-ne)/t.Weight_lbf,Z=t.TGEff[s-1]??.99;l=l*Z*t.Efficiency/T;const V=l;l=l-Y;let B=550*K*l/t.Weight_lbf,W=B/(h*K),pe=!1;W>w&&(pe=!0,B=B*(w-(W-w))/W,W=w-(W-w)),W<xe&&(W=xe,B=xe*K*h);let he=Math.max(0,p)/(2*B)+r.Time0_s;const Fe=n.isLandSpeed?At:Mt,Be=n.isLandSpeed?It:Ft;let le=t.EnginePMI*_*(_-r.RPM0);le<0&&(t.isClutch?le=Fe*le:le=Be*le);let je=P*S*(S-r.DSRPM0);je<0&&(je=0);let We=0,rr=0,ge=0;for(ge=1;ge<=12;ge++){const G=he-r.Time0_s;if(G<=0)break;const ue=Math.pow(2*Ne/60,2)/(12*550*G);We=le*ue,rr=je*ue,l=(A-We)*i,l=(l*Z*t.Efficiency-rr)/T-Y,B=550*K*l/t.Weight_lbf,W=B/(h*K);let ae=0;G!==0&&(ae=(W-r.Ags0_g)/G),ae<Ue&&(ae=Ue,W=r.Ags0_g+ae*G,B=W*K*h),ae>qe&&(ae=qe,W=r.Ags0_g+ae*G,B=W*K*h),pe=!1,W>w&&(pe=!0,B=B*(w-(W-w))/W,W=w-(W-w)),W<xe&&(B=B*xe/W,W=xe);const tr=Math.max(0,p)/(2*B)+r.Time0_s,Le=tr-r.Time0_s;if(ge===12||Math.abs(100*(Le-G)/Le)<=.01){he=tr;break}let Pe=l/A;Pe<Nr&&(Pe=Nr),Pe>Wr&&(Pe=Wr),he=r.Time0_s+G+Pe*(Le-G)}const Se=he-r.Time0_s;let Re;if(B<.1||Se<=0){const G=(r.Vel0_ftps+h)/2;Re=r.Dist0_ft+Math.max(0,G*Math.abs(Se))}else{const G=Math.pow(r.Vel0_ftps,3),ue=2*B*Se+r.Vel0_ftps*r.Vel0_ftps;if(ue<0){const ae=(r.Vel0_ftps+h)/2;Re=r.Dist0_ft+ae*Se}else Re=(Math.pow(ue,1.5)-G)/(3*B)+r.Dist0_ft}return r.L+=1,r.time_s=he,r.Vel_ftps=h,r.Dist_ft=Re,r.AGS_g=W,r.EngRPM=_,r.DSRPM=S,r.SLIP=pe,{TimeStep_s:u,VelSqrd:p,LockRPM:g,ClutchSlip:i,zStall:b,SlipRatio:x,TireSlip:T,WindFPS:M,q:N,RefArea2_ft2:X,DownForce_lbf:oe,DragForce_lbf:ne,DragHP:Y,DynamicFWT_lbf:d,DynamicRWT_lbf:L,WheelBarWT_lbf:E,CRTF:D,AMax_g:w,ChassisPMI:P,EngAccHP:le,ChasAccHP:je,HPSave:A,HPAtWheels:V,HP:l,PQWT:B,iterations:ge}}function _i(r,t,n){const o=nt(r.TireDia_in,r.TireWidth_in,0,0,t.isLandSpeed),c=er(r.xrpm,r.yhp,r.NHP,1,n);let m=5252*(r.HPTQMult*c/t.hpc)/n;const a=r.TGR[0]??1,k=r.TGEff[0]??.99;m=m*r.TorqueMult*a*k;const j=t.isLandSpeed?Xr:Yr,T=t.WindSpeed_mph/Je,C=Math.sign(T)*t.rho*Math.pow(Math.abs(T),2)/(2*K),P=j*r.Weight_lbf+r.DragCoef*r.RefArea_ft2*C;let h;t.isLandSpeed?h=1.01+(t.TractionIndex-1)*.01:h=1.02+(t.TractionIndex-1)*.005+(t.TrackTempEffect-1)*3;const v=m*r.GearRatio*r.Efficiency/(h*r.TireDia_in/24)-P;let S=(r.isClutch?.88:.96)*v/r.Weight_lbf,_=r.Weight_lbf-r.StaticFWt_lbf;_<0&&(_=r.Weight_lbf);const i=st(t.TractionIndex,t.TrackTempEffect),b=lt(t.isLandSpeed);let x=i*b*r.TireDia_in*(r.TireWidth_in+1)*(.92+.08*Math.pow(_/1900,2.15));r.BodyStyle===8&&(x=.5*x);const l=(x-P)/r.Weight_lbf;return S>l&&(S=l),S<xe&&(S=xe),{L:1,time_s:0,Vel_ftps:.001,Dist_ft:0,AGS_g:S,EngRPM:n,DSRPM:0,Gear:1,SLIP:!1,Vel0_ftps:0,Ags0_g:S,Time0_s:0,Dist0_ft:0,RPM0:n,DSRPM0:0,AgsMax_g:S,TireGrowth:o.TireGrowth,TireCirFt:o.TireCirFt,ShiftFlag:0,PrevGear:1}}function ji(r,t,n,o){let c=r*.11*Math.pow(t*n/o,-.3333333333333333);return c=c/15,c<.005&&(c=.005),c}function Si(r){const t=Zr[r];return t?t.lengthFt:r==="EIGHTH"?660:1320}function Ri(r){const t=mr[r];return t||(r==="EIGHTH"?mr.EIGHTH:mr.QUARTER)}function Pi(r){if(!r)return 1;const t=r.toUpperCase();return t==="GASOLINE"?1:t==="GASOLINE EFI"?2:t==="METHANOL"?3:t==="METHANOL EFI"?4:t==="NITROMETHANE"?5:t==="SUPERCHARGED GASOLINE"?6:t==="SUPERCHARGED METHANOL"?7:t==="SUPERCHARGED NITRO"?8:t==="E85"||t==="DIESEL"||t==="GAS+CARB"||t==="GASOLINE+CARBURETOR"?1:t==="GAS+INJECT"||t==="GASOLINE+FUEL INJECTION"?2:t==="METHANOL+CARB"||t==="METHANOL+CARBURETOR"?3:t==="METHANOL+INJECT"||t==="METHANOL+FUEL INJECTION"?4:t==="NITRO+INJECT"||t==="NITROMETHANE+FUEL INJECTION"?5:t==="GAS+SUPERCHARGED"||t==="GASOLINE+SUPERCHARGED"?6:t==="METHANOL+SUPERCHARGED"?7:t==="NITRO+SUPERCHARGED"||t==="NITROMETHANE+SUPERCHARGED"?8:t==="ELECTRIC"?9:t.includes("SUPERCHARG")||t.includes("BLOWN")?t.includes("NITRO")?8:t.includes("METHANOL")||t.includes("ALCOHOL")?7:6:t.includes("INJECT")||t.includes("EFI")?t.includes("NITRO")?5:t.includes("METHANOL")||t.includes("ALCOHOL")?4:2:t.includes("NITRO")?5:t.includes("METHANOL")||t.includes("ALCOHOL")?3:t.includes("ELECTRIC")?9:1}function ki(r){const t=r.vehicle,n=r.engine??t.engine,o=(n==null?void 0:n.hpCurve)??(n==null?void 0:n.torqueCurve)??t.torqueCurve??t.hpCurve??[],c=[],s=[];for(const j of o)Array.isArray(j)?(c.push(j[0]),s.push(j[1])):j&&typeof j=="object"&&(c.push(j.rpm),j.hp!==void 0?s.push(j.hp):j.torque!==void 0?s.push(j.torque*j.rpm/5252):j.tq_lbft!==void 0&&s.push(j.tq_lbft*j.rpm/5252));if(c.length>=2)return{xrpm:c,yhp:s,NHP:c.length,isQuarterJr:!1};const u=Number(t.powerHP??t.peakHP),m=Number(t.rpmAtPeakHP??t.peakRPM??6500),a=Number(t.displacement_cid??t.displacementCID??350),k=r.fuelSystem??t.fuelSystem??1;if(Number.isFinite(u)&&u>0){const j=Gt({peakHP:u,peakRPM:m,displacement_cid:a,fuelSystem:k}),{rpm:T,hp:C}=Vt(j);return{xrpm:T,yhp:C,NHP:j.NHP,isQuarterJr:!0,quarterJrParams:{peakHP:u,rpmAtPeakHP:m,displacement_cid:a,fuelSystem:k}}}return{xrpm:[4e3,6500],yhp:[100,150],NHP:2,isQuarterJr:!1}}function Or(r){const t=Math.abs(100-r);let n;return r>100?n=1+25e-7*Math.pow(t,2.5):n=1+2e-6*Math.pow(t,2.5),n>1.04&&(n=1.04),n}function Ci(r,t){const n=[];n.push("  Time     Distance    MPH  Accel   Gear    RPM");const o=t/12;let c=!1,s=-.25;for(let u=0;u<r.length;u++){const m=r[u],a=m.t_s,k=m.s_ft,j=m.v_mph,T=m.a_g,C=m.gear,P=m.rpm;if(!c&&k>=o){c=!0;const g=m.slip?"(s)":"";n.push(`${a.toFixed(2).padStart(5)}/0.00 Rollout  ${j.toFixed(1).padStart(6)}  ${T.toFixed(2)}${g.padEnd(4)}    ${C}  ${P.toFixed(0).padStart(6)}`),s=a;continue}const h=u===0,v=a-s>=.24,p=u>0&&C!==r[u-1].gear,S=u===r.length-1;if(h||v||p||S){const g=m.slip?"(s)":"",_=k.toFixed(0).padStart(7);n.push(`${a.toFixed(2).padStart(6)}  ${_}  ${j.toFixed(1).padStart(6)}  ${T.toFixed(2)}${g.padEnd(4)}    ${C}  ${P.toFixed(0).padStart(6)}`),s=a}}return n.join(`
`)}function Ti(r){var kr,Cr,Tr,wr,Er,Ar,Mr,Ir,Fr,Br;const t=[],n=[],o=r.vehicle,c=r.env,s=r.raceLength??"QUARTER",u=r.raceLengthFt??Si(s),m=((kr=Zr[s])==null?void 0:kr.category)==="landspeed",a=o.rolloutIn??9,k=o.overhangIn??0;let j=2*a;j<24&&(j=24);let T=(k+.25*j)/12;const C=.5*j/12;T<C&&(T=C);const P=a/12,h=r.drivetrain??o.drivetrain,v=(h==null?void 0:h.clutch)??r.clutch??o.clutch,p=(h==null?void 0:h.converter)??r.converter??o.converter,S=r.engine??o.engine,g=r.pmi??o.pmi,_=r.throttleStop,i=_!=null&&_.enabled?{enabled:!0,activateTime_s:_.activateTime_s,duration_s:_.duration_s,throttlePct:_.throttlePct,rampTime_s:_.rampTime_s}:void 0,b=o.transmissionType??r.transmissionType,x=b==="clutch"?!0:b==="converter"?!1:!p||v&&!p,l=r.fuel,R=typeof l=="string"?l:(l==null?void 0:l.fuelType)??(l==null?void 0:l.fuelSystem)??(l==null?void 0:l.type)??r.fuelType??o.fuelType??r.fuelSystem??o.fuelSystem,A=Pi(R),M=ot({barometer_inHg:c.barometerInHg??29.92,temperature_F:c.temperatureF??59,relHumidity_pct:c.humidityPct??50,elevation_ft:c.elevation??0,fuelSystem:A}),N=M.rho_slug_per_ft3*K,X=M.hpc,oe=ki(r),{xrpm:re,yhp:te,NHP:ie,isQuarterJr:me,quarterJrParams:ne}=oe;ie<2&&t.push("HP curve has fewer than 2 points"),me&&t.push("Using QuarterJr mode (synthetic HP curve from peak HP)");const Y=(h==null?void 0:h.gearRatios)??o.gearRatios??[2.5,1.8,1.4,1.1,1],de=(h==null?void 0:h.finalDriveRatio)??o.finalDrive??o.rearGear??3.73,se=Y.length,d=o.tire,E=(d==null?void 0:d.diameter_in)??o.tireDiaIn??32,L=(d==null?void 0:d.width_in)??o.tireWidthIn??17,F=o.bodyStyle??Ht(o.weightLb);let z,D,w,Z,V,B,W,pe,_e,he,Fe,Be;if(me&&ne){const{displacement_cid:H,fuelSystem:ce}=ne;z=Dt(se,!x);const $=o.shiftRPM??(h==null?void 0:h.shiftRPM)??7e3;D=Y.map(()=>$);const O=(v==null?void 0:v.slipRPM)??(p==null?void 0:p.stallRPM)??o.slipStallRPM??5e3;if(x)Z=Ot(O),V=1,w=O;else{const He=(p==null?void 0:p.diameter_in)??(p==null?void 0:p.diameter)??o.converterDiameterIn??o.converterDia_in??10;let U;if(O>220){w=O;const q=zt(re,te,ie,1,w)*(qt/w)/X;U=w/1e3*(w/q)}else U=O,w=O;const Ve=U/(200*Math.pow(7/He,4));Z=1.01+Ve/20+U/8e3,V=2.633-Math.pow(Ve,.3)-U/1500,V<1&&(V=1),V>2&&(V=2)}_e=Ut(F);const J=Nt(F);he=J.dragCoef,Fe=J.liftCoef,Be=J.overhang_in;const ve=Wt(H,ce,!x,se,E,L,F);B=ve.enginePMI,W=ve.transPMI,pe=ve.tiresPMI}else{z=(h==null?void 0:h.perGearEff)??o.gearEfficiencies??o.gearEff??null??Y.map(()=>.99);const ce=(h==null?void 0:h.shiftRPMs)??(h==null?void 0:h.shiftsRPM)??o.shiftRPMs??o.shiftsRPM??o.shiftRPM??Y.map(()=>7e3),$=Y.length-1;Array.isArray(ce)&&ce.length>$?(D=ce.slice(0,$),t.push(`Shift RPMs trimmed from ${ce.length} to ${$} values`)):D=ce;const O=(v==null?void 0:v.slipRPM)??o.clutchSlipRPM??7200,J=(p==null?void 0:p.stallRPM)??o.converterStallRPM??5500;w=x?O:J;const ve=(v==null?void 0:v.slippageFactor)??(v==null?void 0:v.slippage)??(v==null?void 0:v.slipRatio)??o.clutchSlippage??1.0025,He=(p==null?void 0:p.slippageFactor)??(p==null?void 0:p.slippage)??o.converterSlippage??1.06;Z=x?ve:He,V=x?1:(p==null?void 0:p.torqueMult)??(p==null?void 0:p.torqueMultiplier)??o.converterTorqueMult??2.2,B=(g==null?void 0:g.engine_flywheel_clutch)??o.enginePMI??(S==null?void 0:S.enginePMI)??4,pe=(g==null?void 0:g.tires_wheels_ringgear)??o.tiresPMI??(S==null?void 0:S.tiresPMI)??.5,W=(g==null?void 0:g.transmission_driveshaft)??o.transPMI??(S==null?void 0:S.transPMI)??.2,_e=(h==null?void 0:h.overallEfficiency)??o.transEfficiency??.97;const U=r.aero??o.aero;he=(U==null?void 0:U.Cd)??(U==null?void 0:U.cd)??o.cd??.35,Fe=(U==null?void 0:U.Cl)??(U==null?void 0:U.cl)??o.liftCoeff??0,Be=k}const le=E/2+3.75,je=c.trackTempF??100,We=m?1:Or(je),ge=1.02+((c.tractionIndex??5)-1)*.005+(We-1)*3,Se=1.03,Re=.025,G=o.wheelbaseIn??100,ue=o.weightLb,ae=x?(v==null?void 0:v.launchRPM)??o.clutchLaunchRPM??w:w,Le=5252*(er(re,te,ie,1,ae)/X)/ae*V*Y[0]*z[0],ir=(c.windMph??0)/.681818,dt=ir>0?N*ir*ir/(2*K):0,ct=((Cr=r.aero)==null?void 0:Cr.frontalArea_ft2)??o.frontalArea_ft2??o.frontalAreaFt2??20,br=Re*ue+he*ct*dt,mt=Le*de*_e/(ge*E/24)-br,or=(x?.88:.96)*mt/ue,xr=(1-.035*Math.abs(or))*E/2,vr=(or*ue*(le-xr+Se/_e*xr)+br*le)/G,yr=me?Be:k,ee={Weight_lbf:o.weightLb,Wheelbase_in:o.wheelbaseIn??100,YCG_in:le,StaticFWt_lbf:vr,TireDia_in:E,TireWidth_in:L,Rollout_in:o.rolloutIn??12,GearRatio:de,TGR:Y,TGEff:z,Efficiency:_e,DTShift:x?.2:.25,Slippage:Z,TorqueMult:V,Stall:w,LockUp:(p==null?void 0:p.lockup)??!1,isClutch:x,RefArea_ft2:((Tr=r.aero)==null?void 0:Tr.frontalArea_ft2)??o.frontalArea_ft2??o.frontalAreaFt2??20,DragCoef:he,LiftCoef:Fe,BodyStyle:F,EnginePMI:B,TiresPMI:pe,TransPMI:W,xrpm:re,yhp:te,NHP:ie,HPTQMult:o.hpTorqueMultiplier??(S==null?void 0:S.hpTqMult)??1,ShiftRPM:D,NGR:se,LaunchRPM:x?(v==null?void 0:v.launchRPM)??o.clutchLaunchRPM??w:w,ShiftMode:o.shiftMode??"rpm",ShiftTimes:o.shiftTimes??[],RevLimiterRPM:o.revLimiterRPM??0};if(me&&yr!==k){let H=2*a;H<24&&(H=24),T=(yr+.25*H)/12;const ce=.5*H/12;T<ce&&(T=ce)}const ht=c.trackTempF??100,_r=m?1:Or(ht),nr={rho:N,hpc:X,TractionIndex:c.tractionIndex??5,TrackTempEffect:_r,WindSpeed_mph:c.windMph??0,WindAngle_deg:c.windAngleDeg??0,isLandSpeed:m},jr=x?(v==null?void 0:v.launchRPM)??w:w,I=_i(ee,nr,jr),Sr=(o.rolloutIn??12)/12,pt=Sr>0?Sr:1,ut=er(re,te,ie,1,jr),gt=ji(pt,ut,V,o.weightLb),ft=m?5e4:5e3,bt=m?300:30,sr={iterations:[],convergenceHistory:[]},lr=[],ar=Ri(s);let Ge=0,ke=null,Ce=null,Te=null;for(let H=0;H<ft&&!(I.Dist_ft-P+T>=u+50||I.time_s>=bt);H++){if(!Number.isFinite(I.Vel_ftps)||!Number.isFinite(I.Dist_ft)||!Number.isFinite(I.AGS_g)){t.push(`NaN detected at step ${H}: Vel=${I.Vel_ftps}, Dist=${I.Dist_ft}, AGS=${I.AGS_g}`);break}const $=yi(I,ee,nr,gt,i);if(sr.iterations.push($.iterations),H<20&&sr.convergenceHistory.push({step:H,iterations:$.iterations,HPSave:$.HPSave,HP:$.HP,PQWT:$.PQWT,AGS_g:I.AGS_g}),ke===null&&I.Dist_ft>=P){const Q=(I.Dist_ft-P)/I.Vel_ftps;ke=I.time_s-Q}let O,J;ke!==null?(O=I.Dist_ft-P+T,J=I.time_s-ke):(O=0,J=0);const ve=ee.TGR[I.Gear-1]??1,He=($.LockRPM??I.EngRPM)/ve,U=$.TireSlip,Ve=I.Vel_ftps*U*Me,Lr=(i==null?void 0:i.enabled)&&J>=i.activateTime_s&&J<i.activateTime_s+i.duration_s;if(n.push({t_s:J,s_ft:O,v_fps:I.Vel_ftps,v_mph:I.Vel_ftps*Me,a_g:I.AGS_g,rpm:I.EngRPM,dsrpm:He,lockRpm:$.LockRPM,gear:I.Gear,slip:I.SLIP,tireSlip:U,hp:$.HPAtWheels,dragHp:$.DragHP,netHp:$.HP,wheelSpeed_mph:Ve,throttleStopActive:Lr}),Ce===null&&O>=594){const q=n.length>1?((wr=n[n.length-2])==null?void 0:wr.s_ft)??0:0,Q=n.length>1?((Er=n[n.length-2])==null?void 0:Er.t_s)??0:0;if(q<594&&O>q){const Ee=(594-q)/(O-q);Ce=Q+Ee*(J-Q)}else Ce=J}if(Te===null&&O>=1254){const q=n.length>1?((Ar=n[n.length-2])==null?void 0:Ar.s_ft)??0:0,Q=n.length>1?((Mr=n[n.length-2])==null?void 0:Mr.t_s)??0:0;if(q<1254&&O>q){const Ee=(1254-q)/(O-q);Te=Q+Ee*(J-Q)}else Te=J}for(;Ge<ar.length&&O>=ar[Ge];){const q=ar[Ge],Q=n.length>1?((Ir=n[n.length-2])==null?void 0:Ir.s_ft)??0:0,Ee=n.length>1?((Fr=n[n.length-2])==null?void 0:Fr.t_s)??0:0;let Ae=J;if(Q<q&&O>Q){const yt=(q-Q)/(O-Q);Ae=Ee+yt*(J-Ee)}let Oe;q===660&&Ce!==null&&Ae>Ce?Oe=Me*66/(Ae-Ce):q===1320&&Te!==null&&Ae>Te?Oe=Me*66/(Ae-Te):Oe=I.Vel_ftps*Me,lr.push({d_ft:q,t_s:Ae,v_mph:Oe}),Ge++}if(I.ShiftFlag===1)I.ShiftFlag=2,I.Gear++;else if(I.ShiftFlag===2)I.ShiftFlag=0;else if(I.Gear<ee.NGR)if((ee.ShiftMode??"rpm")==="time"){const Q=(Br=ee.ShiftTimes)==null?void 0:Br[I.Gear-1];Q!==void 0&&I.time_s>=Q&&(I.ShiftFlag=1)}else{const Q=ee.ShiftRPM[I.Gear-1]??7e3;I.EngRPM>=Q&&(I.ShiftFlag=1)}}const we=lr.find(H=>H.d_ft===u),Rr=(we==null?void 0:we.t_s)??I.time_s,Pr=(we==null?void 0:we.v_mph)??I.Vel_ftps*Me,xt=n.map(H=>({t_s:H.t_s,s_ft:H.s_ft,v_mph:H.v_mph,v_fps:H.v_fps,a_g:H.a_g,rpm:H.rpm,dsrpm:H.dsrpm,lockRpm:H.lockRpm,gear:H.gear,slip:H.slip,tireSlip:H.tireSlip,hp:H.hp,dragHp:H.dragHp,wheelSpeed_mph:H.wheelSpeed_mph})),vt={fuelType:{resolved:R??"unknown",fuelSystemType:A,vehicleFuelType:o.fuelType,vehicleFuelSystem:o.fuelSystem},hpCurve:{length:ie,peakHP:Math.max(...te),rpmRange:`${Math.min(...re)} - ${Math.max(...re)}`},airCalc:{rho_lbm_ft3:N,hpc:X},simParams:{weight:o.weightLb,tireDia:E,wheelbase:o.wheelbaseIn??100,finalDrive:de,NGR:se,shiftRPMs:ee.ShiftRPM,peakHP:Math.max(...te),stallRPM:w,slippage:Z,slippageSource:(v==null?void 0:v.slippageFactor)!==void 0?"clutch.slippageFactor":(v==null?void 0:v.slippage)!==void 0?"clutch.slippage":o.clutchSlippage!==void 0?"vehicle.clutchSlippage":"default",vehicleClutchSlippage:o.clutchSlippage,isClutch:x,tractionIndex:nr.TractionIndex,trackTempEffect:_r,pmi:{engine:B,trans:W,tires:pe},aero:{frontalArea:ee.RefArea_ft2,cd:ee.DragCoef,cl:ee.LiftCoef},launchRPM:ee.LaunchRPM,ycg:le,staticFWt:vr,ags0:or,tireSlipAtLaunch:ge,rolloutTime_s:ke??0,rolloutIn:a,gearEfficiencies:ee.TGEff,overallEfficiency:ee.Efficiency,overhangIn:o.overhangIn??k},result:{et:Rr,mph:Pr,rolloutTime_s:ke??0},runTrace:Ci(n,a)};return{et_s:Rr,mph:Pr,timeslip:lr,traces:xt,meta:{model:"VB6Exact",steps:n.length,warnings:t},vb6Diagnostics:sr,debugData:vt}}const wi={name:"VB6Exact",simulate:Ti};function Ei(){const[r,t]=y.useState(new Set),[n,o]=y.useState(new Set(["QUARTER"])),[c,s]=y.useState(!1),[u,m]=y.useState([]),[a,k]=y.useState(null),j=i=>{const b=new Set(r);b.has(i)?b.delete(i):b.add(i),t(b)},T=i=>{const b=new Set(n);b.has(i)?b.delete(i):b.add(i),o(b)},C=()=>{t(new Set(Qe.map(i=>i.name)))},P=()=>{t(new Set)},h=(i,b)=>{const x=fr[i];if(!x)throw new Error(`Benchmark config not found: ${i}`);return hi(x),{vehicle:{id:`benchmark_${i}`,name:i,weightLb:x.vehicle.weightLb,tireDiaIn:x.vehicle.tireDiaIn??x.vehicle.tireRolloutIn/Math.PI,rearGear:x.vehicle.rearGear??x.vehicle.finalDrive,rolloutIn:x.vehicle.rolloutIn,powerHP:x.vehicle.torqueCurve?Math.max(...x.vehicle.torqueCurve.map(R=>R.hp??0)):x.vehicle.powerHP,defaultRaceLength:b,torqueCurve:x.vehicle.torqueCurve,frontalArea_ft2:x.vehicle.frontalArea_ft2,cd:x.vehicle.cd,gearRatios:x.vehicle.gearRatios,shiftRPM:x.vehicle.shiftRPM,wheelbaseIn:x.vehicle.wheelbaseIn,overhangIn:x.vehicle.overhangIn,tireRolloutIn:x.vehicle.tireRolloutIn,tireWidthIn:x.vehicle.tireWidthIn,liftCoeff:x.vehicle.liftCoeff,rrCoeff:x.vehicle.rrCoeff,finalDrive:x.vehicle.finalDrive??x.vehicle.rearGear,transEff:x.vehicle.transEff,gearEff:x.vehicle.gearEff,converter:x.vehicle.converter,clutch:x.vehicle.clutch},env:{elevation:x.env.elevation,barometerInHg:x.env.barometerInHg,temperatureF:x.env.temperatureF,humidityPct:x.env.humidityPct},raceLength:b}},v=async()=>{if(r.size===0||n.size===0){k("Please select at least one benchmark and one race length");return}s(!0),k(null),m([]);const i=[];try{for(const b of r){const x=Qe.find(l=>l.name===b);if(x)for(const l of n){const R=x.raceLengthTargets[l];if(R)try{const A=h(b,l),M=wi.simulate(A),N=mi(x,l,M.et_s,M.mph);i.push({benchmarkName:b,raceLength:l,targetET:R.et_s,targetMPH:R.mph,actualET:M.et_s,actualMPH:M.mph,etDelta:N.etDelta,mphDelta:N.mphDelta,etPass:N.etPass,mphPass:N.mphPass,pass:N.pass,etTolerance:N.etTolerance,mphTolerance:N.mphTolerance})}catch(A){console.error(`Error running ${b} ${l}:`,A),i.push({benchmarkName:b,raceLength:l,targetET:R.et_s,targetMPH:R.mph,actualET:0,actualMPH:0,etDelta:0,mphDelta:0,etPass:!1,mphPass:!1,pass:!1,etTolerance:R.tolET_s,mphTolerance:R.tolMPH})}}}m(i)}catch(b){k(b instanceof Error?b.message:String(b))}finally{s(!1)}},p=i=>{alert(`TODO: Load ${i} fixture into VB6 Inputs and navigate to Run Inspector`)},S=()=>{if(u.length===0){alert("No results to export");return}const i=["Benchmark","Distance","Target ET (s)","Actual ET (s)","ET Delta (s)","ET Tolerance (s)","ET Pass","Target MPH","Actual MPH","MPH Delta","MPH Tolerance","MPH Pass","Overall Pass"],b=u.map(M=>[M.benchmarkName,M.raceLength,M.targetET.toFixed(3),M.actualET.toFixed(3),M.etDelta.toFixed(3),M.etTolerance.toFixed(3),M.etPass?"PASS":"FAIL",M.targetMPH.toFixed(2),M.actualMPH.toFixed(2),M.mphDelta.toFixed(2),M.mphTolerance.toFixed(2),M.mphPass?"PASS":"FAIL",M.pass?"PASS":"FAIL"]),x=[i.join(","),...b.map(M=>M.join(","))].join(`
`),l=new Blob([x],{type:"text/csv"}),R=URL.createObjectURL(l),A=document.createElement("a");A.href=R,A.download=`parity-results-${Date.now()}.csv`,A.click(),URL.revokeObjectURL(R)},g=u.filter(i=>i.pass).length,_=u.length;return e.jsxs("div",{style:{padding:"2rem",height:"100%",overflow:"auto"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:"0.5rem"},children:"Parity Runner"}),e.jsx("p",{style:{color:"var(--color-muted)",fontSize:"0.875rem",margin:0},children:"Run benchmark tests and compare VB6Exact against Quarter Pro/Jr targets."})]}),a&&e.jsx("div",{style:{padding:"1rem",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"var(--radius-md)",marginBottom:"1rem",fontSize:"0.875rem",color:"#991b1b"},children:a}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",fontWeight:"600"},children:"Select Benchmarks"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("button",{onClick:C,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Select All"}),e.jsx("button",{onClick:P,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Select None"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5rem",marginBottom:"1rem"},children:Qe.map(i=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},children:[e.jsx("input",{type:"checkbox",checked:r.has(i.name),onChange:()=>j(i.name)}),e.jsx("span",{children:i.name}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:["(",i.source,")"]})]},i.name))}),e.jsx("h3",{style:{marginTop:"1rem",marginBottom:"0.75rem",fontSize:"1rem",fontWeight:"600"},children:"Race Lengths"}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.has("EIGHTH"),onChange:()=>T("EIGHTH")}),e.jsx("span",{children:"EIGHTH (660 ft)"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:n.has("QUARTER"),onChange:()=>T("QUARTER")}),e.jsx("span",{children:"QUARTER (1320 ft)"})]})]})]}),e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsx("button",{onClick:v,disabled:c,style:{padding:"0.75rem 1.5rem",fontSize:"0.875rem",fontWeight:"500",backgroundColor:c?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:c?"not-allowed":"pointer"},children:c?"Running...":"Run Selected Benchmarks"})}),u.length>0&&e.jsx("div",{style:{padding:"1rem",backgroundColor:g===_?"#d1fae5":"#fee2e2",border:`1px solid ${g===_?"#10b981":"#ef4444"}`,borderRadius:"var(--radius-md)",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:"600"},children:g===_?"‚úì All Tests Passed":`‚ö† ${_-g} Test(s) Failed`}),e.jsxs("div",{style:{fontSize:"0.875rem"},children:[g," / ",_," passed"]})]})}),u.length>0&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--color-surface)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1rem",fontWeight:"600"},children:"Results"}),e.jsx("button",{onClick:S,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"var(--radius-md)",cursor:"pointer"},children:"Export CSV"})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",fontSize:"0.875rem",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#1e293b",color:"#e2e8f0"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"2px solid var(--color-border)"},children:"Benchmark"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"2px solid var(--color-border)"},children:"Distance"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Target ET"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Actual ET"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"ET Œî"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Target MPH"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"Actual MPH"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"2px solid var(--color-border)"},children:"MPH Œî"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"2px solid var(--color-border)"},children:"Status"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"2px solid var(--color-border)"},children:"Actions"})]})}),e.jsx("tbody",{children:u.map((i,b)=>e.jsxs("tr",{style:{backgroundColor:b%2===0?"transparent":"rgba(0,0,0,0.02)"},children:[e.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--color-border)"},children:i.benchmarkName}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:i.raceLength}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:i.targetET.toFixed(3)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:i.actualET.toFixed(3)}),e.jsxs("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",color:i.etPass?"#10b981":"#ef4444",borderBottom:"1px solid var(--color-border)"},children:[i.etDelta>=0?"+":"",i.etDelta.toFixed(3)]}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:i.targetMPH.toFixed(2)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",borderBottom:"1px solid var(--color-border)"},children:i.actualMPH.toFixed(2)}),e.jsxs("td",{style:{padding:"0.75rem",textAlign:"right",fontFamily:"monospace",color:i.mphPass?"#10b981":"#ef4444",borderBottom:"1px solid var(--color-border)"},children:[i.mphDelta>=0?"+":"",i.mphDelta.toFixed(2)]}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:"600",backgroundColor:i.pass?"#10b981":"#ef4444",color:"white"},children:i.pass?"PASS":"FAIL"})}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",borderBottom:"1px solid var(--color-border)"},children:e.jsx("button",{onClick:()=>p(i.benchmarkName),style:{padding:"0.25rem 0.75rem",fontSize:"0.75rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"var(--radius-sm)",cursor:"pointer"},children:"Open in Run Inspector"})})]},`${i.benchmarkName}-${i.raceLength}`))})]})})]})]})}const f={container:{padding:"1rem"},tabs:{display:"flex",gap:"0.25rem",marginBottom:"1rem",borderBottom:"1px solid var(--color-border)"},tab:{padding:"0.75rem 1.5rem",border:"none",background:"transparent",cursor:"pointer",fontSize:"0.875rem",fontWeight:500,color:"var(--color-muted)",borderBottom:"2px solid transparent",marginBottom:"-1px"},tabActive:{color:"var(--color-primary)",borderBottomColor:"var(--color-primary)"},section:{marginBottom:"1.5rem"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},sectionTitle:{fontSize:"0.875rem",fontWeight:600,textTransform:"uppercase",color:"var(--color-muted)"},card:{backgroundColor:"var(--color-background)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-md)",overflow:"hidden"},row:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem 1rem",borderBottom:"1px solid var(--color-border)"},badge:{padding:"0.25rem 0.5rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:600},button:{padding:"0.5rem 1rem",borderRadius:"var(--radius-sm)",border:"none",cursor:"pointer",fontSize:"0.875rem",fontWeight:500},primaryBtn:{backgroundColor:"var(--color-primary)",color:"white"},secondaryBtn:{backgroundColor:"var(--color-surface)",color:"var(--color-text)",border:"1px solid var(--color-border)"},dangerBtn:{backgroundColor:"#dc2626",color:"white"},smallBtn:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},input:{width:"100%",padding:"0.5rem",borderRadius:"var(--radius-sm)",border:"1px solid var(--color-border)",backgroundColor:"var(--color-background)",color:"var(--color-text)",fontSize:"0.875rem"},formGroup:{marginBottom:"1rem"},label:{display:"block",fontSize:"0.875rem",fontWeight:500,marginBottom:"0.25rem"},modal:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modalContent:{backgroundColor:"var(--color-surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",width:"500px",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto"},checkboxGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"0.5rem"},checkbox:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.75rem"}},Ai=[{id:"quarter_jr",name:"Quarter Jr"},{id:"quarter_pro",name:"Quarter Pro"},{id:"bonneville_pro",name:"Bonneville Pro"},{id:"engine_pro",name:"Engine Pro"},{id:"fourlink",name:"Four Link"},{id:"cam_analyzer",name:"Cam Analyzer"}];function Mi({user:r,onClose:t,onSave:n,onDelete:o}){const[c,s]=y.useState((r==null?void 0:r.email)||""),[u,m]=y.useState((r==null?void 0:r.name)||""),[a,k]=y.useState((r==null?void 0:r.role)||"user"),[j,T]=y.useState((r==null?void 0:r.products)||[]),[C,P]=y.useState(""),h=p=>{T(S=>S.includes(p)?S.filter(g=>g!==p):[...S,p])},v=p=>{p.preventDefault(),n({email:c,name:u,role:a,products:j,...C?{password:C}:{}}),t()};return e.jsx("div",{style:f.modal,onClick:t,children:e.jsxs("div",{style:f.modalContent,onClick:p=>p.stopPropagation(),children:[e.jsx("h3",{style:{marginTop:0},children:r?"Edit User":"Create User"}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Email"}),e.jsx("input",{style:f.input,type:"email",value:c,onChange:p=>s(p.target.value),required:!0,disabled:!!r})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Name"}),e.jsx("input",{style:f.input,type:"text",value:u,onChange:p=>m(p.target.value),required:!0})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Role"}),e.jsxs("select",{style:f.input,value:a,onChange:p=>k(p.target.value),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"beta",children:"Beta Tester"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"owner",children:"Owner"})]})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Products"}),e.jsx("div",{style:f.checkboxGrid,children:Ai.map(p=>e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:j.includes(p.id),onChange:()=>h(p.id)}),p.name]},p.id))})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:r?"New Password (leave blank to keep)":"Password"}),e.jsx("input",{style:f.input,type:"password",value:C,onChange:p=>P(p.target.value),...!r&&{required:!0,minLength:6}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1rem"},children:[r&&o&&e.jsx("button",{type:"button",style:{...f.button,...f.dangerBtn},onClick:()=>{o(),t()},children:"Delete"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginLeft:"auto"},children:[e.jsx("button",{type:"button",style:{...f.button,...f.secondaryBtn},onClick:t,children:"Cancel"}),e.jsx("button",{type:"submit",style:{...f.button,...f.primaryBtn},children:r?"Save":"Create"})]})]})]})]})})}function Ii({role:r,products:t,onClose:n,onSave:o,onDelete:c}){const[s,u]=y.useState((r==null?void 0:r.name)||""),[m,a]=y.useState((r==null?void 0:r.description)||""),[k,j]=y.useState((r==null?void 0:r.color)||"#6b7280"),[T,C]=y.useState((r==null?void 0:r.products)||[]),[P,h]=y.useState((r==null?void 0:r.additionalFeatures)||[]),[v,p]=y.useState((r==null?void 0:r.canManageUsers)||!1),[S,g]=y.useState((r==null?void 0:r.canManageRoles)||!1),[_,i]=y.useState((r==null?void 0:r.sortOrder)||50),b=R=>{R.preventDefault(),o({name:s,description:m,color:k,products:T,additionalFeatures:P,canManageUsers:v,canManageRoles:S,isSystem:(r==null?void 0:r.isSystem)||!1,sortOrder:_}),n()},x=R=>{C(A=>A.includes(R)?A.filter(M=>M!==R):[...A,R])},l=R=>{h(A=>A.includes(R)?A.filter(M=>M!==R):[...A,R])};return e.jsx("div",{style:f.modal,onClick:n,children:e.jsxs("div",{style:f.modalContent,onClick:R=>R.stopPropagation(),children:[e.jsx("h3",{style:{marginTop:0},children:r?"Edit Role":"Create Role"}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",gap:"1rem"},children:[e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Name"}),e.jsx("input",{style:f.input,value:s,onChange:R=>u(R.target.value),required:!0})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Color"}),e.jsx("input",{type:"color",style:{...f.input,height:"38px",padding:"2px"},value:k,onChange:R=>j(R.target.value)})]})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Description"}),e.jsx("textarea",{style:{...f.input,minHeight:"50px"},value:m,onChange:R=>a(R.target.value)})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Products Access"}),e.jsx("div",{style:f.checkboxGrid,children:t.map(R=>e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:T.includes(R.id),onChange:()=>x(R.id)}),e.jsx("span",{style:{color:R.color},children:R.icon})," ",R.name]},R.id))})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Additional Features"}),e.jsx("div",{style:f.checkboxGrid,children:rt.filter(R=>["dev_tools","user_management","role_management","system_settings","view_analytics","beta_features"].includes(R)).map(R=>e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:P.includes(R),onChange:()=>l(R)}),R.replace(/_/g," ")]},R))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem"},children:[e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:v,onChange:R=>p(R.target.checked)}),"Can Manage Users"]}),e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:S,onChange:R=>g(R.target.checked)}),"Can Manage Roles"]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Sort Order"}),e.jsx("input",{type:"number",style:f.input,value:_,onChange:R=>i(parseInt(R.target.value)||0)})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1rem"},children:[r&&!r.isSystem&&c&&e.jsx("button",{type:"button",style:{...f.button,...f.dangerBtn},onClick:()=>{c(),n()},children:"Delete"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginLeft:"auto"},children:[e.jsx("button",{type:"button",style:{...f.button,...f.secondaryBtn},onClick:n,children:"Cancel"}),e.jsx("button",{type:"submit",style:{...f.button,...f.primaryBtn},children:r?"Save":"Create"})]})]})]})]})})}function Fi({product:r,onClose:t,onSave:n,onDelete:o}){const[c,s]=y.useState((r==null?void 0:r.name)||""),[u,m]=y.useState((r==null?void 0:r.description)||""),[a,k]=y.useState((r==null?void 0:r.icon)||"üì¶"),[j,T]=y.useState((r==null?void 0:r.color)||"#6b7280"),[C,P]=y.useState((r==null?void 0:r.features)||[]),[h,v]=y.useState((r==null?void 0:r.isPremium)||!1),[p,S]=y.useState((r==null?void 0:r.sortOrder)||50),g=i=>{i.preventDefault(),n({name:c,description:u,icon:a,color:j,features:C,isPremium:h,sortOrder:p}),t()},_=i=>{P(b=>b.includes(i)?b.filter(x=>x!==i):[...b,i])};return e.jsx("div",{style:f.modal,onClick:t,children:e.jsxs("div",{style:f.modalContent,onClick:i=>i.stopPropagation(),children:[e.jsx("h3",{style:{marginTop:0},children:r?"Edit Product":"Create Product"}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 100px",gap:"1rem"},children:[e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Icon"}),e.jsx("input",{style:{...f.input,textAlign:"center",fontSize:"1.5rem"},value:a,onChange:i=>k(i.target.value)})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Name"}),e.jsx("input",{style:f.input,value:c,onChange:i=>s(i.target.value),required:!0})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Color"}),e.jsx("input",{type:"color",style:{...f.input,height:"38px",padding:"2px"},value:j,onChange:i=>T(i.target.value)})]})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Description"}),e.jsx("textarea",{style:{...f.input,minHeight:"50px"},value:u,onChange:i=>m(i.target.value)})]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Features"}),e.jsx("div",{style:f.checkboxGrid,children:rt.filter(i=>!["dev_tools","user_management","role_management","system_settings","view_analytics","beta_features"].includes(i)).map(i=>e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:C.includes(i),onChange:()=>_(i)}),i.replace(/_/g," ")]},i))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("label",{style:f.checkbox,children:[e.jsx("input",{type:"checkbox",checked:h,onChange:i=>v(i.target.checked)}),"Premium Product"]}),e.jsxs("div",{style:f.formGroup,children:[e.jsx("label",{style:f.label,children:"Sort Order"}),e.jsx("input",{type:"number",style:f.input,value:p,onChange:i=>S(parseInt(i.target.value)||0)})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1rem"},children:[r&&o&&e.jsx("button",{type:"button",style:{...f.button,...f.dangerBtn},onClick:()=>{o(),t()},children:"Delete"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginLeft:"auto"},children:[e.jsx("button",{type:"button",style:{...f.button,...f.secondaryBtn},onClick:t,children:"Cancel"}),e.jsx("button",{type:"submit",style:{...f.button,...f.primaryBtn},children:r?"Save":"Create"})]})]})]})]})})}function Bi(){var g,_,i,b,x;const r=et(),[t,n]=y.useState("users"),[o,c]=y.useState(null),[s,u]=y.useState(null),[m,a]=y.useState(null),[k,j]=y.useState([]),[T,C]=y.useState(!0),[P,h]=y.useState(null),v=r.getAllRoles(),p=r.getAllProducts(),S=async()=>{C(!0),h(null);try{const l=await $e.getAll();j(l.users)}catch(l){h(l.message||"Failed to load users")}finally{C(!1)}};return y.useEffect(()=>{S()},[]),e.jsxs("div",{style:f.container,children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"#fef3c7",borderRadius:"var(--radius-sm)",fontSize:"0.75rem"},children:[e.jsx("strong",{children:"Current User:"})," ",(g=r.user)==null?void 0:g.email," (Role: ",(_=r.user)==null?void 0:_.roleId,")",e.jsx("br",{}),e.jsx("strong",{children:"User Role Object:"})," ",((i=r.getUserRole())==null?void 0:i.name)||"NOT FOUND",e.jsx("br",{}),e.jsx("strong",{children:"Products:"})," ",((x=(b=r.getUserRole())==null?void 0:b.products)==null?void 0:x.join(", "))||"NONE",e.jsx("br",{}),e.jsx("button",{onClick:()=>{r.resetAuthData(),window.location.reload()},style:{...f.button,...f.dangerBtn,marginTop:"0.5rem"},children:"üîÑ Reset All Auth Data"})]}),e.jsx("div",{style:f.tabs,children:["users","roles","products"].map(l=>e.jsx("button",{style:{...f.tab,...t===l?f.tabActive:{}},onClick:()=>n(l),children:l==="users"?`üë• Users (${k.length})`:l==="roles"?`üé≠ Roles (${v.length})`:`üì¶ Products (${p.length})`},l))}),t==="users"&&e.jsxs("div",{style:f.section,children:[e.jsxs("div",{style:f.sectionHeader,children:[e.jsx("span",{style:f.sectionTitle,children:"Database Users (API)"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{style:{...f.button,...f.secondaryBtn},onClick:S,children:"üîÑ Refresh"}),e.jsx("button",{style:{...f.button,...f.primaryBtn},onClick:()=>c("new"),children:"+ Add User"})]})]}),P&&e.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#fee2e2",color:"#991b1b",borderRadius:"var(--radius-sm)",marginBottom:"0.5rem"},children:P}),T?e.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"var(--color-muted)"},children:"Loading users..."}):e.jsxs("div",{style:f.card,children:[k.map(l=>{var A;const R={owner:"#7c3aed",admin:"#dc2626",beta:"#2563eb",user:"#6b7280"};return e.jsxs("div",{style:f.row,children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500},children:l.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:l.email})]}),e.jsx("span",{style:{...f.badge,backgroundColor:R[l.role]||"#6b7280",color:"white"},children:l.role}),e.jsx("span",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:((A=l.products)==null?void 0:A.join(", "))||"no products"}),e.jsx("button",{style:{...f.button,...f.secondaryBtn,...f.smallBtn},onClick:()=>c(l),children:"Edit"})]},l.id)}),k.length===0&&e.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"var(--color-muted)"},children:"No users found"})]})]}),t==="roles"&&e.jsxs("div",{style:f.section,children:[e.jsxs("div",{style:f.sectionHeader,children:[e.jsx("span",{style:f.sectionTitle,children:"All Roles"}),e.jsx("button",{style:{...f.button,...f.primaryBtn},onClick:()=>u("new"),children:"+ Add Role"})]}),e.jsx("div",{style:f.card,children:v.map(l=>e.jsxs("div",{style:f.row,children:[e.jsx("span",{style:{...f.badge,backgroundColor:l.color,color:"white"},children:l.name}),e.jsx("div",{style:{flex:1,fontSize:"0.75rem",color:"var(--color-muted)"},children:l.description}),e.jsxs("div",{style:{fontSize:"0.75rem"},children:[l.products.length," products, ",l.additionalFeatures.length," features"]}),l.isSystem&&e.jsx("span",{style:{...f.badge,backgroundColor:"#f3f4f6",color:"#4b5563"},children:"System"}),e.jsx("button",{style:{...f.button,...f.secondaryBtn,...f.smallBtn},onClick:()=>u(l),children:"Edit"})]},l.id))})]}),t==="products"&&e.jsxs("div",{style:f.section,children:[e.jsxs("div",{style:f.sectionHeader,children:[e.jsx("span",{style:f.sectionTitle,children:"All Products"}),e.jsx("button",{style:{...f.button,...f.primaryBtn},onClick:()=>a("new"),children:"+ Add Product"})]}),e.jsx("div",{style:f.card,children:p.map(l=>e.jsxs("div",{style:f.row,children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:l.icon}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:500,color:l.color},children:l.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)"},children:l.description})]}),e.jsxs("div",{style:{fontSize:"0.75rem"},children:[l.features.length," features"]}),l.isPremium&&e.jsx("span",{style:{...f.badge,backgroundColor:"#fef3c7",color:"#92400e"},children:"Premium"}),e.jsx("button",{style:{...f.button,...f.secondaryBtn,...f.smallBtn},onClick:()=>a(l),children:"Edit"})]},l.id))})]}),o&&e.jsx(Mi,{user:o==="new"?null:o,onClose:()=>c(null),onSave:async l=>{try{o==="new"?await $e.create({email:l.email,password:l.password,name:l.name,role:l.role,products:l.products}):await $e.update(o.id,{name:l.name,role:l.role,products:l.products}),S()}catch(R){alert(R.message||"Failed to save user")}},onDelete:o!=="new"?async()=>{await $e.delete(o.id),S()}:void 0}),s&&e.jsx(Ii,{role:s==="new"?null:s,products:p,onClose:()=>u(null),onSave:l=>{s==="new"?r.createRole(l):r.updateRole(s.id,l)},onDelete:s!=="new"?()=>r.deleteRole(s.id):void 0}),m&&e.jsx(Fi,{product:m==="new"?null:m,onClose:()=>a(null),onSave:l=>{m==="new"?r.createProduct(l):r.updateProduct(m.id,l)},onDelete:m!=="new"?()=>r.deleteProduct(m.id):void 0})]})}function Li(){const{user:r}=et(),[t,n]=y.useState([]),[o,c]=y.useState(null),[s,u]=y.useState(!1),[m,a]=y.useState(""),[k,j]=y.useState(!1),[T,C]=y.useState(null),P=(r==null?void 0:r.roleId)==="admin"||(r==null?void 0:r.roleId)==="owner",h=(r==null?void 0:r.roleId)==="owner";y.useEffect(()=>{hr().then(n)},[]);const v=[...De,...t.filter(l=>!De.some(R=>R.id===l.id))],p=m?v.filter(l=>l.name.toLowerCase().includes(m.toLowerCase())||l.city.toLowerCase().includes(m.toLowerCase())||l.state.toLowerCase().includes(m.toLowerCase())):v,S=()=>{if(!P){C({type:"error",text:"Only admins can add tracks"});return}c({id:`custom_${Date.now()}`,name:"",city:"",state:"",country:"USA",lat:0,lon:0,elevation_ft:0,length:"1/4"}),u(!0)},g=l=>{if(!P){C({type:"error",text:"Only admins can edit tracks"});return}if(De.some(R=>R.id===l.id)){C({type:"error",text:"Built-in tracks cannot be edited. Create a copy instead."});return}c({...l}),u(!1)},_=l=>{if(!P){C({type:"error",text:"Only admins can add tracks"});return}c({...l,id:`custom_${Date.now()}`,name:`${l.name} (Copy)`}),u(!0)},i=async()=>{if(o){if(!o.name.trim()){C({type:"error",text:"Track name is required"});return}j(!0),C(null);try{if(s){const R=await $t(o);if(!R.success){C({type:"error",text:R.error||"Failed to save track"});return}}else{const R=await Jt(o.id,o);if(!R.success){C({type:"error",text:R.error||"Failed to update track"});return}}const l=await hr();n(l),c(null),u(!1),C({type:"success",text:s?"Track added successfully":"Track updated successfully"})}finally{j(!1)}}},b=async l=>{if(!h){C({type:"error",text:"Only owners can delete tracks"});return}if(De.some(A=>A.id===l)){C({type:"error",text:"Built-in tracks cannot be deleted."});return}if(!confirm("Delete this track?"))return;j(!0);const R=await Qt(l);if(R.success){const A=await hr();n(A),C({type:"success",text:"Track deleted"})}else C({type:"error",text:R.error||"Failed to delete track"});j(!1)},x=l=>De.some(R=>R.id===l);return e.jsxs("div",{children:[T&&e.jsx("div",{style:{padding:"10px 16px",marginBottom:"1rem",borderRadius:"6px",backgroundColor:T.type==="error"?"rgba(239, 68, 68, 0.1)":"rgba(34, 197, 94, 0.1)",color:T.type==="error"?"#ef4444":"#22c55e",border:`1px solid ${T.type==="error"?"#ef4444":"#22c55e"}`},children:T.text}),e.jsxs("div",{style:{marginBottom:"1rem",display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("button",{onClick:S,className:"btn",style:{backgroundColor:P?"var(--color-primary)":"var(--color-muted)"},disabled:!P||k,children:"+ Add Track"}),e.jsx("input",{type:"text",placeholder:"Search tracks...",value:m,onChange:l=>a(l.target.value),className:"input",style:{width:"200px"}}),e.jsxs("span",{style:{color:"var(--color-muted)",fontSize:"0.85rem"},children:[p.length," tracks (",t.length," custom)"]}),!P&&e.jsx("span",{style:{color:"var(--color-muted)",fontSize:"0.8rem",fontStyle:"italic"},children:"(Admin access required to edit)"})]}),o&&e.jsxs("div",{className:"card",style:{marginBottom:"1rem",padding:"1rem"},children:[e.jsx("h4",{style:{marginBottom:"1rem"},children:s?"New Track":"Edit Track"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Track Name *"}),e.jsx("input",{type:"text",className:"input",value:o.name,onChange:l=>c({...o,name:l.target.value}),placeholder:"e.g., My Local Dragstrip"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{type:"text",className:"input",value:o.city,onChange:l=>c({...o,city:l.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{type:"text",className:"input",value:o.state,onChange:l=>c({...o,state:l.target.value}),maxLength:2,style:{width:"60px"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Latitude"}),e.jsx("input",{type:"number",className:"input",step:"0.0001",value:o.lat,onChange:l=>c({...o,lat:parseFloat(l.target.value)||0}),placeholder:"e.g., 34.0589"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Longitude"}),e.jsx("input",{type:"number",className:"input",step:"0.0001",value:o.lon,onChange:l=>c({...o,lon:parseFloat(l.target.value)||0}),placeholder:"e.g., -117.7517"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Elevation (ft)"}),e.jsx("input",{type:"number",className:"input",value:o.elevation_ft,onChange:l=>c({...o,elevation_ft:parseInt(l.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Track Angle (¬∞)"}),e.jsx("input",{type:"number",className:"input",step:"1",min:"0",max:"359",value:o.trackAngle??0,onChange:l=>c({...o,trackAngle:parseInt(l.target.value)||0}),placeholder:"0 = North"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--color-muted)",marginTop:"4px"},children:"Direction track points (0=N, 90=E, 180=S, 270=W)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Track Length"}),e.jsxs("select",{className:"input",value:o.length,onChange:l=>c({...o,length:l.target.value}),children:[e.jsx("option",{value:"1/4",children:"1/4 Mile"}),e.jsx("option",{value:"1/8",children:"1/8 Mile"}),e.jsx("option",{value:"both",children:"Both"})]})]})]}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:i,className:"btn",style:{backgroundColor:"var(--color-primary)"},children:"Save Track"}),e.jsx("button",{onClick:()=>{c(null),u(!1)},className:"btn",children:"Cancel"})]})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--color-border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"Track Name"}),e.jsx("th",{style:{textAlign:"left",padding:"8px"},children:"Location"}),e.jsx("th",{style:{textAlign:"right",padding:"8px"},children:"Lat"}),e.jsx("th",{style:{textAlign:"right",padding:"8px"},children:"Lon"}),e.jsx("th",{style:{textAlign:"right",padding:"8px"},children:"Elev (ft)"}),e.jsx("th",{style:{textAlign:"right",padding:"8px"},children:"Angle"}),e.jsx("th",{style:{textAlign:"center",padding:"8px"},children:"Length"}),e.jsx("th",{style:{textAlign:"center",padding:"8px"},children:"Actions"})]})}),e.jsx("tbody",{children:p.map(l=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--color-border)",backgroundColor:x(l.id)?"transparent":"rgba(34, 197, 94, 0.05)"},children:[e.jsxs("td",{style:{padding:"8px"},children:[l.name,x(l.id)&&e.jsx("span",{style:{marginLeft:"6px",fontSize:"0.7rem",color:"var(--color-muted)"},children:"(built-in)"})]}),e.jsxs("td",{style:{padding:"8px"},children:[l.city,", ",l.state]}),e.jsx("td",{style:{padding:"8px",textAlign:"right",fontFamily:"monospace"},children:l.lat.toFixed(4)}),e.jsx("td",{style:{padding:"8px",textAlign:"right",fontFamily:"monospace"},children:l.lon.toFixed(4)}),e.jsx("td",{style:{padding:"8px",textAlign:"right"},children:l.elevation_ft.toLocaleString()}),e.jsxs("td",{style:{padding:"8px",textAlign:"right"},children:[l.trackAngle??"-","¬∞"]}),e.jsx("td",{style:{padding:"8px",textAlign:"center"},children:l.length}),e.jsx("td",{style:{padding:"8px",textAlign:"center"},children:e.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>_(l),style:{padding:"4px 8px",fontSize:"0.75rem",border:"1px solid var(--color-border)",borderRadius:"4px",backgroundColor:"var(--color-bg-secondary)",cursor:"pointer"},title:"Copy track",children:"üìã"}),!x(l.id)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(l),style:{padding:"4px 8px",fontSize:"0.75rem",border:"1px solid var(--color-border)",borderRadius:"4px",backgroundColor:"var(--color-bg-secondary)",cursor:"pointer"},title:"Edit track",children:"‚úèÔ∏è"}),e.jsx("button",{onClick:()=>b(l.id),style:{padding:"4px 8px",fontSize:"0.75rem",border:"1px solid #ef4444",borderRadius:"4px",backgroundColor:"transparent",color:"#ef4444",cursor:"pointer"},title:"Delete track",children:"üóëÔ∏è"})]})]})})]},l.id))})]})}),e.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",backgroundColor:"var(--color-bg-secondary)",borderRadius:"8px",fontSize:"0.85rem"},children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:"Track Angle"}),e.jsxs("p",{style:{color:"var(--color-muted)",margin:0},children:["The track angle is the compass direction the track points (direction cars travel down the strip). This is used to calculate the effective headwind/tailwind from the weather wind direction.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"0¬∞"})," = North, ",e.jsx("strong",{children:"90¬∞"})," = East, ",e.jsx("strong",{children:"180¬∞"})," = South, ",e.jsx("strong",{children:"270¬∞"})," = West",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"Tip:"})," Use Google Maps to find coordinates. Right-click on the track location and copy the coordinates."]})]})]})}const ye=[{id:"settings",title:"‚öôÔ∏è Settings & Flags",component:ri,category:"core"},{id:"health-check",title:"ü©∫ Health Check",component:ti,category:"core"},{id:"run-inspector",title:"‚ñ∂Ô∏è Run Inspector",component:di,category:"simulation"},{id:"energy",title:"‚ö° Energy Accounting",component:ci,category:"simulation"},{id:"input-inspector",title:"üîç Input Inspector",component:ui,category:"data"},{id:"quick-paste",title:"üìã Quick Paste",component:gi,category:"data"},{id:"air",title:"üå°Ô∏è Air Model",component:xi,category:"data"},{id:"parity",title:"üß™ Parity Runner",component:Ei,category:"testing"},{id:"users",title:"üë• User Management",component:Bi,category:"core"},{id:"tracks",title:"üèÅ Track Editor",component:Li,category:"data"}];function Gi(){const[r,t]=Kr(),n=r.get("panel"),[o,c]=y.useState(()=>n&&ye.some(m=>m.id===n)?n:ye.length>0?ye[0].id:"");y.useEffect(()=>{o&&t({panel:o},{replace:!0})},[o,t]),y.useEffect(()=>{n&&ye.some(m=>m.id===n)&&c(n)},[n]);const s=ye.find(m=>m.id===o),u=s==null?void 0:s.component;return e.jsx(Kt,{title:"Dev Portal",children:e.jsxs("div",{style:{display:"flex",gap:"1rem",minHeight:"70vh"},children:[e.jsxs("nav",{style:{width:"200px",flexShrink:0,borderRight:"1px solid var(--color-border)",paddingRight:"1rem"},children:[e.jsx("h3",{style:{fontSize:"0.875rem",fontWeight:"600",textTransform:"uppercase",color:"var(--color-muted)",marginBottom:"1rem"},children:"Dev Panels"}),e.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:ye.map(m=>e.jsx("li",{style:{marginBottom:"0.25rem"},children:e.jsx("button",{onClick:()=>c(m.id),style:{width:"100%",textAlign:"left",padding:"0.5rem 0.75rem",border:"none",background:o===m.id?"var(--color-primary)":"transparent",color:o===m.id?"white":"var(--color-text)",borderRadius:"var(--radius-sm)",cursor:"pointer",fontSize:"0.875rem",transition:"background-color 0.2s"},onMouseEnter:a=>{o!==m.id&&(a.currentTarget.style.backgroundColor="var(--color-surface)")},onMouseLeave:a=>{o!==m.id&&(a.currentTarget.style.backgroundColor="transparent")},children:m.title})},m.id))}),ye.length===0&&e.jsx("p",{style:{fontSize:"0.875rem",color:"var(--color-muted)",fontStyle:"italic"},children:"No panels registered"})]}),e.jsx("div",{style:{flex:1,minWidth:0,backgroundColor:"var(--color-surface)",borderRadius:"var(--radius-md)",overflow:"auto"},children:u?e.jsx(u,{}):e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx("p",{style:{color:"var(--color-muted)"},children:"No panel selected"})})})]})})}export{Gi as default};
//# sourceMappingURL=DevPortal-DkIxsTUZ.js.map
