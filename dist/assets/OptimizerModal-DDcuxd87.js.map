{"version":3,"file":"OptimizerModal-DDcuxd87.js","sources":["../../src/shared/components/OptimizerModal.tsx"],"sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { simulate } from '../../workerBridge';\r\nimport { fromVehicleToVB6Fixture } from '../../dev/vb6/fromVehicle';\r\nimport { fixtureToSimInputs } from '../../domain/physics/vb6/fixtures';\r\nimport type { Vehicle } from '../../domain/schemas/vehicle.schema';\r\nimport type { Env } from '../../domain/schemas/env.schema';\r\nimport type { RaceLength } from '../../domain/config/raceLengths';\r\n\r\ninterface OptimizerModalProps {\r\n  vehicle: Vehicle;\r\n  env: Env;\r\n  raceLength: RaceLength;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onApplyToSession: (optimizedVehicle: Vehicle) => void;\r\n  onSaveToVehicle?: (optimizedVehicle: Vehicle) => Promise<void>;\r\n}\r\n\r\ninterface OptimizeResult {\r\n  value: number;\r\n  et: number;\r\n  mph: number;\r\n}\r\n\r\ntype OptimizeType = 'gear' | 'converter' | 'both';\r\n\r\nexport default function OptimizerModal({ \r\n  vehicle, \r\n  env, \r\n  raceLength, \r\n  isOpen, \r\n  onClose,\r\n  onApplyToSession,\r\n  onSaveToVehicle,\r\n}: OptimizerModalProps) {\r\n  const [isOptimizing, setIsOptimizing] = useState(false);\r\n  const [, setOptimizeType] = useState<OptimizeType | null>(null);\r\n  const [progress, setProgress] = useState(0);\r\n  const [progressText, setProgressText] = useState('');\r\n  const [gearResults, setGearResults] = useState<OptimizeResult[]>([]);\r\n  const [converterResults, setConverterResults] = useState<OptimizeResult[]>([]);\r\n  const [bestGear, setBestGear] = useState<OptimizeResult | null>(null);\r\n  const [bestConverter, setBestConverter] = useState<OptimizeResult | null>(null);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [saveSuccess, setSaveSuccess] = useState(false);\r\n  \r\n  // Run simulation for a given vehicle config\r\n  const runSim = useCallback(async (testVehicle: Vehicle): Promise<{ et: number; mph: number }> => {\r\n    try {\r\n      const vb6Fixture = fromVehicleToVB6Fixture(testVehicle as any);\r\n      const simInputs = fixtureToSimInputs(vb6Fixture, raceLength);\r\n      simInputs.env = {\r\n        elevation: env.elevation ?? 0,\r\n        barometerInHg: env.barometerInHg ?? 29.92,\r\n        temperatureF: env.temperatureF ?? 75,\r\n        humidityPct: env.humidityPct ?? 50,\r\n        windMph: env.windMph ?? 0,\r\n        windAngleDeg: env.windAngleDeg ?? 0,\r\n        trackTempF: env.trackTempF ?? 100,\r\n        tractionIndex: env.tractionIndex ?? 5,\r\n      };\r\n      \r\n      const result = await simulate('VB6Exact', simInputs);\r\n      return { et: result.et_s, mph: result.mph };\r\n    } catch (err) {\r\n      console.error('Simulation failed:', err);\r\n      return { et: 999, mph: 0 };\r\n    }\r\n  }, [env, raceLength]);\r\n  \r\n  // Reset state\r\n  const reset = useCallback(() => {\r\n    setOptimizeType(null);\r\n    setProgress(0);\r\n    setProgressText('');\r\n    setGearResults([]);\r\n    setConverterResults([]);\r\n    setBestGear(null);\r\n    setBestConverter(null);\r\n    setSaveSuccess(false);\r\n  }, []);\r\n  \r\n  // Optimize gear ratio\r\n  const optimizeGear = useCallback(async (): Promise<OptimizeResult | null> => {\r\n    const currentGear = vehicle.rearGear ?? 3.73;\r\n    const minGear = Math.max(2.0, currentGear - 2.0);\r\n    const maxGear = Math.min(6.0, currentGear + 2.0);\r\n    const step = 0.05;\r\n    \r\n    const testResults: OptimizeResult[] = [];\r\n    const totalSteps = Math.ceil((maxGear - minGear) / step);\r\n    let stepCount = 0;\r\n    \r\n    for (let gear = minGear; gear <= maxGear; gear += step) {\r\n      const testVehicle = { ...vehicle, rearGear: gear };\r\n      const result = await runSim(testVehicle);\r\n      testResults.push({ value: gear, et: result.et, mph: result.mph });\r\n      stepCount++;\r\n      setProgress(Math.round((stepCount / totalSteps) * 50)); // 0-50%\r\n      setProgressText(`Testing gear ratio ${gear.toFixed(2)}...`);\r\n    }\r\n    \r\n    const best = testResults.reduce((a, b) => a.et < b.et ? a : b);\r\n    setGearResults(testResults);\r\n    setBestGear(best);\r\n    return best;\r\n  }, [vehicle, runSim]);\r\n  \r\n  // Optimize converter stall\r\n  const optimizeConverterStall = useCallback(async (baseVehicle?: Vehicle): Promise<OptimizeResult | null> => {\r\n    const testBase = baseVehicle || vehicle;\r\n    if (testBase.transmissionType !== 'converter') return null;\r\n    \r\n    const minStall = 1500;\r\n    const maxStall = 6000;\r\n    const step = 200;\r\n    \r\n    const testResults: OptimizeResult[] = [];\r\n    const totalSteps = Math.ceil((maxStall - minStall) / step);\r\n    let stepCount = 0;\r\n    \r\n    for (let stall = minStall; stall <= maxStall; stall += step) {\r\n      const testVehicle = { ...testBase, converterStallRPM: stall };\r\n      const result = await runSim(testVehicle);\r\n      testResults.push({ value: stall, et: result.et, mph: result.mph });\r\n      stepCount++;\r\n      setProgress(50 + Math.round((stepCount / totalSteps) * 50)); // 50-100%\r\n      setProgressText(`Testing stall speed ${stall} RPM...`);\r\n    }\r\n    \r\n    const best = testResults.reduce((a, b) => a.et < b.et ? a : b);\r\n    setConverterResults(testResults);\r\n    setBestConverter(best);\r\n    return best;\r\n  }, [vehicle, runSim]);\r\n  \r\n  // Run optimization\r\n  const runOptimization = useCallback(async (type: OptimizeType) => {\r\n    reset();\r\n    setIsOptimizing(true);\r\n    setOptimizeType(type);\r\n    \r\n    try {\r\n      if (type === 'gear' || type === 'both') {\r\n        await optimizeGear();\r\n      }\r\n      \r\n      if ((type === 'converter' || type === 'both') && vehicle.transmissionType === 'converter') {\r\n        // If optimizing both, use the best gear ratio found\r\n        const baseVehicle = type === 'both' && bestGear \r\n          ? { ...vehicle, rearGear: bestGear.value }\r\n          : vehicle;\r\n        await optimizeConverterStall(baseVehicle);\r\n      }\r\n    } finally {\r\n      setIsOptimizing(false);\r\n      setProgressText('');\r\n    }\r\n  }, [reset, optimizeGear, optimizeConverterStall, vehicle, bestGear]);\r\n  \r\n  // Get optimized vehicle\r\n  const getOptimizedVehicle = useCallback((): Vehicle => {\r\n    let optimized = { ...vehicle };\r\n    if (bestGear) optimized.rearGear = bestGear.value;\r\n    if (bestConverter) optimized.converterStallRPM = bestConverter.value;\r\n    return optimized;\r\n  }, [vehicle, bestGear, bestConverter]);\r\n  \r\n  // Apply to session only\r\n  const handleApplyToSession = useCallback(() => {\r\n    onApplyToSession(getOptimizedVehicle());\r\n    onClose();\r\n  }, [getOptimizedVehicle, onApplyToSession, onClose]);\r\n  \r\n  // Save to vehicle permanently\r\n  const handleSaveToVehicle = useCallback(async () => {\r\n    if (!onSaveToVehicle) return;\r\n    setIsSaving(true);\r\n    try {\r\n      await onSaveToVehicle(getOptimizedVehicle());\r\n      setSaveSuccess(true);\r\n      setTimeout(() => {\r\n        onClose();\r\n      }, 1000);\r\n    } catch (err) {\r\n      console.error('Failed to save vehicle:', err);\r\n      alert('Failed to save vehicle');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  }, [getOptimizedVehicle, onSaveToVehicle, onClose]);\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  const hasResults = bestGear || bestConverter;\r\n  const isAutomatic = vehicle.transmissionType === 'converter';\r\n  \r\n  return (\r\n    <>\r\n      {/* Backdrop */}\r\n      <div\r\n        onClick={onClose}\r\n        style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          backgroundColor: 'rgba(0,0,0,0.6)',\r\n          zIndex: 1000,\r\n        }}\r\n      />\r\n      \r\n      {/* Modal */}\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: '50%',\r\n        left: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n        backgroundColor: 'var(--color-bg)',\r\n        borderRadius: '12px',\r\n        boxShadow: '0 20px 60px rgba(0,0,0,0.4)',\r\n        zIndex: 1001,\r\n        width: '500px',\r\n        maxWidth: '95vw',\r\n        maxHeight: '90vh',\r\n        overflow: 'auto',\r\n      }}>\r\n        {/* Header */}\r\n        <div style={{\r\n          padding: '16px 20px',\r\n          borderBottom: '1px solid var(--color-border)',\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center',\r\n        }}>\r\n          <h3 style={{ margin: 0, fontSize: '1.1rem', color: 'var(--color-text)' }}>\r\n            âš¡ Performance Optimizer\r\n          </h3>\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              fontSize: '1.5rem',\r\n              cursor: 'pointer',\r\n              color: 'var(--color-text-muted)',\r\n              padding: '0 4px',\r\n            }}\r\n          >\r\n            Ã—\r\n          </button>\r\n        </div>\r\n        \r\n        {/* Content */}\r\n        <div style={{ padding: '20px' }}>\r\n          {/* Vehicle info */}\r\n          <div style={{\r\n            padding: '12px',\r\n            backgroundColor: 'var(--color-bg-secondary)',\r\n            borderRadius: '8px',\r\n            marginBottom: '16px',\r\n            fontSize: '0.85rem',\r\n          }}>\r\n            <div style={{ fontWeight: 600, color: 'var(--color-text)', marginBottom: '4px' }}>\r\n              {vehicle.name}\r\n            </div>\r\n            <div style={{ color: 'var(--color-text-muted)', fontSize: '0.8rem' }}>\r\n              Current: {vehicle.rearGear?.toFixed(2) ?? '3.73'} gear ratio\r\n              {isAutomatic && ` â€¢ ${vehicle.converterStallRPM ?? 3000} RPM stall`}\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Optimization buttons */}\r\n          {!isOptimizing && !hasResults && (\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>\r\n              <button\r\n                onClick={() => runOptimization('gear')}\r\n                style={{\r\n                  padding: '14px 16px',\r\n                  fontSize: '0.9rem',\r\n                  borderRadius: '8px',\r\n                  border: '2px solid var(--color-accent)',\r\n                  backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n                  color: 'var(--color-accent)',\r\n                  cursor: 'pointer',\r\n                  fontWeight: 600,\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  gap: '10px',\r\n                }}\r\n              >\r\n                <span style={{ fontSize: '1.2rem' }}>ðŸŽ¯</span>\r\n                <div style={{ textAlign: 'left' }}>\r\n                  <div>Optimize Gear Ratio</div>\r\n                  <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                    Find the best final drive ratio for quickest ET\r\n                  </div>\r\n                </div>\r\n              </button>\r\n              \r\n              {isAutomatic && (\r\n                <button\r\n                  onClick={() => runOptimization('converter')}\r\n                  style={{\r\n                    padding: '14px 16px',\r\n                    fontSize: '0.9rem',\r\n                    borderRadius: '8px',\r\n                    border: '2px solid #f59e0b',\r\n                    backgroundColor: 'rgba(245, 158, 11, 0.1)',\r\n                    color: '#f59e0b',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 600,\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '10px',\r\n                  }}\r\n                >\r\n                  <span style={{ fontSize: '1.2rem' }}>ðŸ”„</span>\r\n                  <div style={{ textAlign: 'left' }}>\r\n                    <div>Optimize Converter Stall</div>\r\n                    <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                      Find the best stall speed for quickest ET\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              )}\r\n              \r\n              {isAutomatic && (\r\n                <button\r\n                  onClick={() => runOptimization('both')}\r\n                  style={{\r\n                    padding: '14px 16px',\r\n                    fontSize: '0.9rem',\r\n                    borderRadius: '8px',\r\n                    border: '2px solid #22c55e',\r\n                    backgroundColor: 'rgba(34, 197, 94, 0.1)',\r\n                    color: '#22c55e',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 600,\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '10px',\r\n                  }}\r\n                >\r\n                  <span style={{ fontSize: '1.2rem' }}>ðŸš€</span>\r\n                  <div style={{ textAlign: 'left' }}>\r\n                    <div>Optimize Both</div>\r\n                    <div style={{ fontSize: '0.75rem', fontWeight: 400, opacity: 0.8 }}>\r\n                      Find best gear ratio AND converter stall together\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              )}\r\n            </div>\r\n          )}\r\n          \r\n          {/* Progress */}\r\n          {isOptimizing && (\r\n            <div style={{ textAlign: 'center', padding: '30px 0' }}>\r\n              <div style={{ fontSize: '1rem', marginBottom: '12px', color: 'var(--color-text)' }}>\r\n                Optimizing...\r\n              </div>\r\n              <div style={{ \r\n                width: '100%', \r\n                height: '10px', \r\n                backgroundColor: 'var(--color-bg-secondary)', \r\n                borderRadius: '5px',\r\n                overflow: 'hidden',\r\n                marginBottom: '8px',\r\n              }}>\r\n                <div style={{\r\n                  width: `${progress}%`,\r\n                  height: '100%',\r\n                  backgroundColor: 'var(--color-accent)',\r\n                  transition: 'width 0.2s ease',\r\n                }} />\r\n              </div>\r\n              <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)' }}>\r\n                {progressText || `${progress}% complete`}\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Results */}\r\n          {hasResults && !isOptimizing && (\r\n            <div>\r\n              {/* Gear ratio result */}\r\n              {bestGear && (\r\n                <div style={{\r\n                  padding: '16px',\r\n                  backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n                  borderRadius: '8px',\r\n                  marginBottom: '12px',\r\n                  border: '1px solid rgba(59, 130, 246, 0.3)',\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                    <div>\r\n                      <div style={{ fontSize: '0.75rem', color: 'var(--color-accent)', fontWeight: 600, marginBottom: '4px' }}>\r\n                        OPTIMAL GEAR RATIO\r\n                      </div>\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: 'var(--color-text)' }}>\r\n                        {bestGear.value.toFixed(2)}\r\n                      </div>\r\n                      <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)', marginTop: '4px' }}>\r\n                        ET: {bestGear.et.toFixed(3)}s @ {bestGear.mph.toFixed(1)} mph\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ textAlign: 'right', fontSize: '0.8rem' }}>\r\n                      <div style={{ color: 'var(--color-text-muted)' }}>\r\n                        Current: {(vehicle.rearGear ?? 3.73).toFixed(2)}\r\n                      </div>\r\n                      <div style={{ \r\n                        color: bestGear.value !== (vehicle.rearGear ?? 3.73) ? '#22c55e' : 'var(--color-text-muted)',\r\n                        fontWeight: 600,\r\n                      }}>\r\n                        {bestGear.value - (vehicle.rearGear ?? 3.73) >= 0 ? '+' : ''}\r\n                        {(bestGear.value - (vehicle.rearGear ?? 3.73)).toFixed(2)}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Mini chart */}\r\n                  <div style={{ marginTop: '12px' }}>\r\n                    <div style={{ \r\n                      display: 'flex', \r\n                      alignItems: 'flex-end', \r\n                      gap: '1px', \r\n                      height: '30px',\r\n                    }}>\r\n                      {gearResults.map((r, i) => {\r\n                        const minET = Math.min(...gearResults.map(x => x.et));\r\n                        const maxET = Math.max(...gearResults.map(x => x.et));\r\n                        const range = maxET - minET || 0.1;\r\n                        const height = ((maxET - r.et) / range) * 100;\r\n                        const isBest = r.value === bestGear.value;\r\n                        return (\r\n                          <div\r\n                            key={i}\r\n                            style={{\r\n                              flex: 1,\r\n                              height: `${Math.max(5, height)}%`,\r\n                              backgroundColor: isBest ? '#22c55e' : 'var(--color-accent)',\r\n                              opacity: isBest ? 1 : 0.3,\r\n                            }}\r\n                            title={`${r.value.toFixed(2)}: ${r.et.toFixed(3)}s`}\r\n                          />\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {/* Converter result */}\r\n              {bestConverter && (\r\n                <div style={{\r\n                  padding: '16px',\r\n                  backgroundColor: 'rgba(245, 158, 11, 0.1)',\r\n                  borderRadius: '8px',\r\n                  marginBottom: '12px',\r\n                  border: '1px solid rgba(245, 158, 11, 0.3)',\r\n                }}>\r\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                    <div>\r\n                      <div style={{ fontSize: '0.75rem', color: '#f59e0b', fontWeight: 600, marginBottom: '4px' }}>\r\n                        OPTIMAL CONVERTER STALL\r\n                      </div>\r\n                      <div style={{ fontSize: '1.5rem', fontWeight: 700, color: 'var(--color-text)' }}>\r\n                        {bestConverter.value.toFixed(0)} RPM\r\n                      </div>\r\n                      <div style={{ fontSize: '0.8rem', color: 'var(--color-text-muted)', marginTop: '4px' }}>\r\n                        ET: {bestConverter.et.toFixed(3)}s @ {bestConverter.mph.toFixed(1)} mph\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ textAlign: 'right', fontSize: '0.8rem' }}>\r\n                      <div style={{ color: 'var(--color-text-muted)' }}>\r\n                        Current: {vehicle.converterStallRPM ?? 3000} RPM\r\n                      </div>\r\n                      <div style={{ \r\n                        color: bestConverter.value !== (vehicle.converterStallRPM ?? 3000) ? '#22c55e' : 'var(--color-text-muted)',\r\n                        fontWeight: 600,\r\n                      }}>\r\n                        {bestConverter.value - (vehicle.converterStallRPM ?? 3000) >= 0 ? '+' : ''}\r\n                        {(bestConverter.value - (vehicle.converterStallRPM ?? 3000)).toFixed(0)} RPM\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Mini chart */}\r\n                  <div style={{ marginTop: '12px' }}>\r\n                    <div style={{ \r\n                      display: 'flex', \r\n                      alignItems: 'flex-end', \r\n                      gap: '1px', \r\n                      height: '30px',\r\n                    }}>\r\n                      {converterResults.map((r, i) => {\r\n                        const minET = Math.min(...converterResults.map(x => x.et));\r\n                        const maxET = Math.max(...converterResults.map(x => x.et));\r\n                        const range = maxET - minET || 0.1;\r\n                        const height = ((maxET - r.et) / range) * 100;\r\n                        const isBest = r.value === bestConverter.value;\r\n                        return (\r\n                          <div\r\n                            key={i}\r\n                            style={{\r\n                              flex: 1,\r\n                              height: `${Math.max(5, height)}%`,\r\n                              backgroundColor: isBest ? '#22c55e' : '#f59e0b',\r\n                              opacity: isBest ? 1 : 0.3,\r\n                            }}\r\n                            title={`${r.value} RPM: ${r.et.toFixed(3)}s`}\r\n                          />\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {/* Action buttons */}\r\n              <div style={{ display: 'flex', gap: '10px', marginTop: '16px' }}>\r\n                <button\r\n                  onClick={handleApplyToSession}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '12px 16px',\r\n                    fontSize: '0.9rem',\r\n                    borderRadius: '8px',\r\n                    border: 'none',\r\n                    backgroundColor: 'var(--color-accent)',\r\n                    color: 'white',\r\n                    cursor: 'pointer',\r\n                    fontWeight: 600,\r\n                  }}\r\n                >\r\n                  Apply to Session\r\n                </button>\r\n                \r\n                {onSaveToVehicle && (\r\n                  <button\r\n                    onClick={handleSaveToVehicle}\r\n                    disabled={isSaving}\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: '12px 16px',\r\n                      fontSize: '0.9rem',\r\n                      borderRadius: '8px',\r\n                      border: 'none',\r\n                      backgroundColor: saveSuccess ? '#22c55e' : '#22c55e',\r\n                      color: 'white',\r\n                      cursor: isSaving ? 'wait' : 'pointer',\r\n                      fontWeight: 600,\r\n                      opacity: isSaving ? 0.7 : 1,\r\n                    }}\r\n                  >\r\n                    {saveSuccess ? 'âœ“ Saved!' : isSaving ? 'Saving...' : 'Save to Vehicle'}\r\n                  </button>\r\n                )}\r\n              </div>\r\n              \r\n              {/* Run again button */}\r\n              <button\r\n                onClick={reset}\r\n                style={{\r\n                  width: '100%',\r\n                  marginTop: '10px',\r\n                  padding: '10px 16px',\r\n                  fontSize: '0.85rem',\r\n                  borderRadius: '8px',\r\n                  border: '1px solid var(--color-border)',\r\n                  backgroundColor: 'transparent',\r\n                  color: 'var(--color-text-muted)',\r\n                  cursor: 'pointer',\r\n                }}\r\n              >\r\n                Run Another Optimization\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n// Small trigger button component\r\nexport function OptimizerButton({ onClick }: { onClick: () => void }) {\r\n  return (\r\n    <button\r\n      onClick={onClick}\r\n      style={{\r\n        padding: '6px 12px',\r\n        fontSize: '0.75rem',\r\n        borderRadius: '4px',\r\n        border: '1px solid var(--color-accent)',\r\n        backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n        color: 'var(--color-accent)',\r\n        cursor: 'pointer',\r\n        fontWeight: 500,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '6px',\r\n      }}\r\n      title=\"Open Performance Optimizer\"\r\n    >\r\n      <span>âš¡</span>\r\n      <span>Optimize</span>\r\n    </button>\r\n  );\r\n}\r\n"],"names":["OptimizerModal","vehicle","env","raceLength","isOpen","onClose","onApplyToSession","onSaveToVehicle","isOptimizing","setIsOptimizing","useState","setOptimizeType","progress","setProgress","progressText","setProgressText","gearResults","setGearResults","converterResults","setConverterResults","bestGear","setBestGear","bestConverter","setBestConverter","isSaving","setIsSaving","saveSuccess","setSaveSuccess","runSim","useCallback","testVehicle","vb6Fixture","fromVehicleToVB6Fixture","simInputs","fixtureToSimInputs","result","simulate","err","reset","optimizeGear","currentGear","minGear","maxGear","step","testResults","totalSteps","stepCount","gear","best","a","b","optimizeConverterStall","baseVehicle","testBase","minStall","maxStall","stall","runOptimization","type","getOptimizedVehicle","optimized","handleApplyToSession","handleSaveToVehicle","hasResults","isAutomatic","jsxs","Fragment","jsx","_a","r","minET","x","maxET","range","height","isBest","OptimizerButton","onClick"],"mappings":"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"}