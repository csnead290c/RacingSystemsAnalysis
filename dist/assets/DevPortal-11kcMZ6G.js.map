{"version":3,"file":"DevPortal-11kcMZ6G.js","sources":["../../src/shared/state/userLevel.ts","../../src/dev/panels/SettingsPanel.tsx","../../src/dev/validation/vb6Fixture.ts","../../src/dev/panels/HealthCheck.tsx","../../src/dev/vb6/fixtureAdapter.ts","../../src/dev/components/VehiclePicker.tsx","../../src/dev/panels/RunInspector.tsx","../../src/domain/physics/vb6/uiMapper.ts","../../src/dev/panels/EnergyPanel.tsx","../../src/domain/physics/fixtures/benchmarks.ts","../../src/domain/physics/fixtures/benchmark-configs.ts","../../src/dev/panels/InputInspector.tsx","../../src/dev/panels/QuickPaste.tsx","../../src/domain/physics/vb6/air.ts","../../src/dev/panels/AirInspector.tsx","../../src/domain/physics/vb6/vb6SimulationStep.ts","../../src/domain/physics/models/vb6Exact.ts","../../src/dev/panels/ParityRunner.tsx","../../src/dev/panels/UserManagement.tsx","../../src/dev/panels/TrackEditor.tsx","../../src/dev/registry.tsx","../../src/pages/DevPortal.tsx"],"sourcesContent":["/**\r\n * User Level / Program Tier System\r\n * \r\n * This is the SINGLE SOURCE OF TRUTH for user access levels.\r\n * \r\n * Program Tiers (matching VB6 product line):\r\n * - quarterJr: Basic mode - peak HP/RPM only, calculated parameters\r\n * - quarterPro: Full mode - complete HP curve, all parameters editable\r\n * - admin: Developer mode - all features + dev tools\r\n * \r\n * Future expansion possibilities:\r\n * - bonnevillePro: Top speed simulation mode\r\n * - enterprise: Multi-user, fleet management\r\n */\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\n/**\r\n * User access levels (program tiers)\r\n * \r\n * IMPORTANT: Order matters - higher index = more access\r\n */\r\nexport const USER_LEVELS = ['quarterJr', 'quarterPro', 'admin'] as const;\r\nexport type UserLevel = typeof USER_LEVELS[number];\r\n\r\n/**\r\n * Display names for each level\r\n */\r\nexport const USER_LEVEL_DISPLAY: Record<UserLevel, string> = {\r\n  quarterJr: 'Quarter Jr',\r\n  quarterPro: 'Quarter Pro', \r\n  admin: 'Admin / Developer',\r\n};\r\n\r\n/**\r\n * Descriptions for each level\r\n */\r\nexport const USER_LEVEL_DESCRIPTIONS: Record<UserLevel, string> = {\r\n  quarterJr: 'Basic mode - enter peak HP and RPM, other parameters are calculated automatically',\r\n  quarterPro: 'Full mode - enter complete HP curve and all vehicle parameters',\r\n  admin: 'Developer mode - all features plus dev tools and diagnostics',\r\n};\r\n\r\n// ============================================================================\r\n// Access Control\r\n// ============================================================================\r\n\r\n/**\r\n * Check if a user level has access to a required level\r\n */\r\nexport function hasAccess(currentLevel: UserLevel, requiredLevel: UserLevel): boolean {\r\n  const currentIndex = USER_LEVELS.indexOf(currentLevel);\r\n  const requiredIndex = USER_LEVELS.indexOf(requiredLevel);\r\n  return currentIndex >= requiredIndex;\r\n}\r\n\r\n/**\r\n * Check if user has QuarterPro or higher access\r\n */\r\nexport function hasProAccess(level: UserLevel): boolean {\r\n  return hasAccess(level, 'quarterPro');\r\n}\r\n\r\n/**\r\n * Check if user has Admin access\r\n */\r\nexport function hasAdminAccess(level: UserLevel): boolean {\r\n  return hasAccess(level, 'admin');\r\n}\r\n\r\n// ============================================================================\r\n// Input Field Visibility\r\n// ============================================================================\r\n\r\n/**\r\n * Input field categories and their required access levels\r\n */\r\nexport type InputCategory = \r\n  | 'basic'           // Available to all (weight, wheelbase, tire size)\r\n  | 'engine_basic'    // QuarterJr engine inputs (peak HP, peak RPM, displacement)\r\n  | 'engine_curve'    // QuarterPro only (full HP curve)\r\n  | 'drivetrain_basic'// Basic drivetrain (gear ratios, final drive)\r\n  | 'drivetrain_adv'  // Advanced drivetrain (per-gear efficiency, shift RPMs)\r\n  | 'aero'            // Aerodynamics (Cd, Cl, frontal area)\r\n  | 'pmi'             // Polar moments of inertia\r\n  | 'clutch_conv'     // Clutch/converter settings\r\n  | 'cg'              // Center of gravity\r\n  | 'dev';            // Developer-only fields\r\n\r\n/**\r\n * Required access level for each input category\r\n */\r\nexport const INPUT_CATEGORY_ACCESS: Record<InputCategory, UserLevel> = {\r\n  basic: 'quarterJr',\r\n  engine_basic: 'quarterJr',\r\n  engine_curve: 'quarterPro',\r\n  drivetrain_basic: 'quarterJr',\r\n  drivetrain_adv: 'quarterPro',\r\n  aero: 'quarterPro',\r\n  pmi: 'quarterPro',\r\n  clutch_conv: 'quarterPro',\r\n  cg: 'quarterPro',\r\n  dev: 'admin',\r\n};\r\n\r\n/**\r\n * Check if a user can access an input category\r\n */\r\nexport function canAccessCategory(level: UserLevel, category: InputCategory): boolean {\r\n  return hasAccess(level, INPUT_CATEGORY_ACCESS[category]);\r\n}\r\n\r\n/**\r\n * Get all accessible categories for a user level\r\n */\r\nexport function getAccessibleCategories(level: UserLevel): InputCategory[] {\r\n  return (Object.keys(INPUT_CATEGORY_ACCESS) as InputCategory[])\r\n    .filter(cat => canAccessCategory(level, cat));\r\n}\r\n\r\n// ============================================================================\r\n// QuarterJr vs QuarterPro Input Lists\r\n// ============================================================================\r\n\r\n/**\r\n * Inputs available in QuarterJr mode\r\n */\r\nexport const QUARTER_JR_INPUTS = {\r\n  engine: [\r\n    'peakHP',\r\n    'rpmAtPeakHP',\r\n    'displacement_cid',\r\n    'fuelSystem',\r\n  ],\r\n  vehicle: [\r\n    'weight_lb',\r\n    'wheelbase_in',\r\n    'tireDia_in',\r\n    'tireWidth_in',\r\n    'rollout_in',\r\n    'bodyStyle',\r\n  ],\r\n  drivetrain: [\r\n    'gearRatios',\r\n    'finalDrive',\r\n    'shiftRPM',  // Single value for all gears\r\n    'isConverter',\r\n    'slipStallRPM',\r\n    'converterDia_in',  // Only if converter\r\n  ],\r\n  environment: [\r\n    'elevation_ft',\r\n    'barometer_inHg',\r\n    'temperature_F',\r\n    'relHumidity_pct',\r\n    'trackTemp_F',\r\n    'tractionIndex',\r\n    'wind_mph',\r\n    'wind_angle_deg',\r\n  ],\r\n} as const;\r\n\r\n/**\r\n * Additional inputs available in QuarterPro mode (on top of QuarterJr)\r\n */\r\nexport const QUARTER_PRO_ADDITIONAL_INPUTS = {\r\n  engine: [\r\n    'hpCurve',          // Full HP curve (replaces peak HP/RPM)\r\n    'hpTorqueMultiplier',\r\n  ],\r\n  vehicle: [\r\n    'staticFrontWeight_lb',\r\n    'cgHeight_in',\r\n    'overhang_in',\r\n  ],\r\n  drivetrain: [\r\n    'perGearEff',       // Per-gear efficiencies\r\n    'shiftsRPM',        // Per-gear shift RPMs (replaces single shiftRPM)\r\n    'launchRPM',\r\n    'slippage',\r\n    'torqueMult',\r\n    'lockup',\r\n  ],\r\n  aero: [\r\n    'frontalArea_ft2',\r\n    'Cd',\r\n    'Cl',\r\n  ],\r\n  pmi: [\r\n    'engine_flywheel_clutch',\r\n    'transmission_driveshaft',\r\n    'tires_wheels_ringgear',\r\n  ],\r\n} as const;\r\n\r\n/**\r\n * Get the list of visible inputs for a user level\r\n */\r\nexport function getVisibleInputs(level: UserLevel): {\r\n  engine: readonly string[];\r\n  vehicle: readonly string[];\r\n  drivetrain: readonly string[];\r\n  environment: readonly string[];\r\n  aero: readonly string[];\r\n  pmi: readonly string[];\r\n} {\r\n  if (hasProAccess(level)) {\r\n    // QuarterPro: All inputs\r\n    return {\r\n      engine: [...QUARTER_JR_INPUTS.engine, ...QUARTER_PRO_ADDITIONAL_INPUTS.engine],\r\n      vehicle: [...QUARTER_JR_INPUTS.vehicle, ...QUARTER_PRO_ADDITIONAL_INPUTS.vehicle],\r\n      drivetrain: [...QUARTER_JR_INPUTS.drivetrain, ...QUARTER_PRO_ADDITIONAL_INPUTS.drivetrain],\r\n      environment: [...QUARTER_JR_INPUTS.environment],\r\n      aero: [...QUARTER_PRO_ADDITIONAL_INPUTS.aero],\r\n      pmi: [...QUARTER_PRO_ADDITIONAL_INPUTS.pmi],\r\n    };\r\n  }\r\n  \r\n  // QuarterJr: Basic inputs only\r\n  return {\r\n    engine: QUARTER_JR_INPUTS.engine,\r\n    vehicle: QUARTER_JR_INPUTS.vehicle,\r\n    drivetrain: QUARTER_JR_INPUTS.drivetrain,\r\n    environment: QUARTER_JR_INPUTS.environment,\r\n    aero: [],\r\n    pmi: [],\r\n  };\r\n}\r\n","/**\r\n * Settings & Flags Panel\r\n * \r\n * Consolidated panel for:\r\n * - User level (program tier) selection\r\n * - Feature flags and debug modes\r\n * - Logging controls\r\n * \r\n * This replaces the separate FlagsPanel, UserLevelPanel, and LoggingPanel.\r\n */\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { \r\n  useFlagsStore, \r\n  useFlags,\r\n  useUserLevel,\r\n  USER_LEVELS,\r\n  USER_LEVEL_DISPLAY,\r\n} from '../../domain/flags/store';\r\nimport { \r\n  USER_LEVEL_DESCRIPTIONS,\r\n  getVisibleInputs,\r\n} from '../../shared/state/userLevel';\r\n\r\nexport default function SettingsPanel() {\r\n  const flags = useFlags();\r\n  const level = useUserLevel();\r\n  const { setFlag, setUserLevel, resetFlags } = useFlagsStore();\r\n  const visibleInputs = getVisibleInputs(level);\r\n  \r\n  // Log capture state\r\n  const [logBuffer, setLogBuffer] = useState<string[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [autoScroll, setAutoScroll] = useState(true);\r\n  const [showLogs, setShowLogs] = useState(false);\r\n  const logViewerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Intercept console.log to capture logs\r\n  useEffect(() => {\r\n    const originalLog = console.log;\r\n    const originalWarn = console.warn;\r\n    const originalError = console.error;\r\n\r\n    const captureLog = (level: string, ...args: any[]) => {\r\n      const timestamp = new Date().toISOString().split('T')[1].slice(0, 12);\r\n      const message = args.map(arg => \r\n        typeof arg === 'object' ? JSON.stringify(arg) : String(arg)\r\n      ).join(' ');\r\n      \r\n      const logEntry = `[${timestamp}] [${level}] ${message}`;\r\n      setLogBuffer(prev => [...prev.slice(-500), logEntry]); // Keep last 500 logs\r\n    };\r\n\r\n    console.log = (...args: any[]) => {\r\n      originalLog(...args);\r\n      captureLog('LOG', ...args);\r\n    };\r\n\r\n    console.warn = (...args: any[]) => {\r\n      originalWarn(...args);\r\n      captureLog('WARN', ...args);\r\n    };\r\n\r\n    console.error = (...args: any[]) => {\r\n      originalError(...args);\r\n      captureLog('ERROR', ...args);\r\n    };\r\n\r\n    return () => {\r\n      console.log = originalLog;\r\n      console.warn = originalWarn;\r\n      console.error = originalError;\r\n    };\r\n  }, []);\r\n\r\n  // Auto-scroll to bottom when new logs arrive\r\n  useEffect(() => {\r\n    if (autoScroll && logViewerRef.current) {\r\n      logViewerRef.current.scrollTop = logViewerRef.current.scrollHeight;\r\n    }\r\n  }, [logBuffer, autoScroll]);\r\n\r\n  const handleDownloadLogs = () => {\r\n    const logText = logBuffer.join('\\n');\r\n    const blob = new Blob([logText], { type: 'text/plain' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `rsa-logs-${Date.now()}.log`;\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const filteredLogs = searchTerm\r\n    ? logBuffer.filter(log => log.toLowerCase().includes(searchTerm.toLowerCase()))\r\n    : logBuffer;\r\n\r\n  const flagDefinitions = [\r\n    {\r\n      key: 'vb6StrictMode' as const,\r\n      label: 'VB6 Strict Mode',\r\n      description: 'Require complete VB6 fixture for simulation (no defaults)',\r\n    },\r\n    {\r\n      key: 'showDiagnostics' as const,\r\n      label: 'Show Diagnostics',\r\n      description: 'Display debug information in console and UI',\r\n    },\r\n    {\r\n      key: 'enableStepTrace' as const,\r\n      label: 'Step Trace',\r\n      description: 'Log detailed step-by-step simulation data',\r\n    },\r\n    {\r\n      key: 'enableEnergyLogging' as const,\r\n      label: 'Energy Logging',\r\n      description: 'Log energy balance calculations',\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\r\n      <div style={{ marginBottom: '2rem' }}>\r\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Settings & Flags</h2>\r\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\r\n          Configure user level, feature flags, and debug options.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Section 1: User Level */}\r\n      <div\r\n        style={{\r\n          padding: '1rem',\r\n          backgroundColor: 'var(--color-surface)',\r\n          border: '1px solid var(--color-border)',\r\n          borderRadius: 'var(--radius-md)',\r\n          marginBottom: '1rem',\r\n        }}\r\n      >\r\n        <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\r\n          User Level (Program Tier)\r\n        </h3>\r\n\r\n        <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>\r\n          {USER_LEVELS.map((lvl) => (\r\n            <button\r\n              key={lvl}\r\n              onClick={() => setUserLevel(lvl)}\r\n              style={{\r\n                flex: 1,\r\n                padding: '0.75rem',\r\n                fontSize: '0.875rem',\r\n                fontWeight: level === lvl ? '600' : '400',\r\n                backgroundColor: level === lvl \r\n                  ? (lvl === 'admin' ? '#8b5cf6' : lvl === 'quarterPro' ? '#3b82f6' : '#10b981')\r\n                  : 'var(--color-bg)',\r\n                color: level === lvl ? 'white' : 'var(--color-text)',\r\n                border: `2px solid ${level === lvl \r\n                  ? (lvl === 'admin' ? '#8b5cf6' : lvl === 'quarterPro' ? '#3b82f6' : '#10b981')\r\n                  : 'var(--color-border)'}`,\r\n                borderRadius: 'var(--radius-md)',\r\n                cursor: 'pointer',\r\n                transition: 'all 0.2s',\r\n              }}\r\n            >\r\n              {USER_LEVEL_DISPLAY[lvl]}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        <div style={{ fontSize: '0.875rem', color: 'var(--color-muted)', marginBottom: '1rem' }}>\r\n          <strong>Current:</strong> {USER_LEVEL_DISPLAY[level]} — {USER_LEVEL_DESCRIPTIONS[level]}\r\n        </div>\r\n\r\n        {/* Collapsible Input Visibility */}\r\n        <details style={{ fontSize: '0.875rem' }}>\r\n          <summary style={{ cursor: 'pointer', fontWeight: '500', marginBottom: '0.5rem' }}>\r\n            View Available Inputs for {USER_LEVEL_DISPLAY[level]}\r\n          </summary>\r\n          <div style={{ \r\n            display: 'grid', \r\n            gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', \r\n            gap: '0.75rem',\r\n            padding: '0.75rem',\r\n            backgroundColor: 'var(--color-bg)',\r\n            borderRadius: 'var(--radius-sm)',\r\n            marginTop: '0.5rem',\r\n          }}>\r\n            <div>\r\n              <strong style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>Engine</strong>\r\n              <ul style={{ margin: '0.25rem 0', paddingLeft: '1rem', fontSize: '0.75rem' }}>\r\n                {visibleInputs.engine.slice(0, 5).map((input) => <li key={input}>{input}</li>)}\r\n                {visibleInputs.engine.length > 5 && <li>+{visibleInputs.engine.length - 5} more</li>}\r\n              </ul>\r\n            </div>\r\n            <div>\r\n              <strong style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>Vehicle</strong>\r\n              <ul style={{ margin: '0.25rem 0', paddingLeft: '1rem', fontSize: '0.75rem' }}>\r\n                {visibleInputs.vehicle.slice(0, 5).map((input) => <li key={input}>{input}</li>)}\r\n                {visibleInputs.vehicle.length > 5 && <li>+{visibleInputs.vehicle.length - 5} more</li>}\r\n              </ul>\r\n            </div>\r\n            <div>\r\n              <strong style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>Drivetrain</strong>\r\n              <ul style={{ margin: '0.25rem 0', paddingLeft: '1rem', fontSize: '0.75rem' }}>\r\n                {visibleInputs.drivetrain.slice(0, 5).map((input) => <li key={input}>{input}</li>)}\r\n                {visibleInputs.drivetrain.length > 5 && <li>+{visibleInputs.drivetrain.length - 5} more</li>}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </details>\r\n      </div>\r\n\r\n      {/* Section 2: Feature Flags */}\r\n      <div\r\n        style={{\r\n          padding: '1rem',\r\n          backgroundColor: 'var(--color-surface)',\r\n          border: '1px solid var(--color-border)',\r\n          borderRadius: 'var(--radius-md)',\r\n          marginBottom: '1rem',\r\n        }}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\r\n          <h3 style={{ margin: 0, fontSize: '1rem', fontWeight: '600' }}>\r\n            Feature Flags\r\n          </h3>\r\n          <button\r\n            onClick={resetFlags}\r\n            style={{\r\n              padding: '0.375rem 0.75rem',\r\n              fontSize: '0.75rem',\r\n              backgroundColor: '#6b7280',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: 'var(--radius-sm)',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Reset All\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '0.75rem' }}>\r\n          {flagDefinitions.map((flag) => (\r\n            <label\r\n              key={flag.key}\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'flex-start',\r\n                gap: '0.5rem',\r\n                padding: '0.75rem',\r\n                backgroundColor: flags[flag.key] ? '#dbeafe' : 'var(--color-bg)',\r\n                border: '1px solid var(--color-border)',\r\n                borderRadius: 'var(--radius-md)',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={flags[flag.key] as boolean}\r\n                onChange={(e) => setFlag(flag.key, e.target.checked)}\r\n                style={{ marginTop: '2px' }}\r\n              />\r\n              <div>\r\n                <div style={{ fontWeight: '500', fontSize: '0.875rem' }}>{flag.label}</div>\r\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>{flag.description}</div>\r\n              </div>\r\n            </label>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Section 3: Console Logs */}\r\n      <div\r\n        style={{\r\n          padding: '1rem',\r\n          backgroundColor: 'var(--color-surface)',\r\n          border: '1px solid var(--color-border)',\r\n          borderRadius: 'var(--radius-md)',\r\n        }}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.75rem' }}>\r\n          <h3 style={{ margin: 0, fontSize: '1rem', fontWeight: '600' }}>\r\n            Console Logs ({logBuffer.length})\r\n          </h3>\r\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n            <button\r\n              onClick={() => setShowLogs(!showLogs)}\r\n              style={{\r\n                padding: '0.375rem 0.75rem',\r\n                fontSize: '0.75rem',\r\n                backgroundColor: showLogs ? '#3b82f6' : '#6b7280',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: 'var(--radius-sm)',\r\n                cursor: 'pointer',\r\n              }}\r\n            >\r\n              {showLogs ? 'Hide' : 'Show'}\r\n            </button>\r\n            <button\r\n              onClick={handleDownloadLogs}\r\n              disabled={logBuffer.length === 0}\r\n              style={{\r\n                padding: '0.375rem 0.75rem',\r\n                fontSize: '0.75rem',\r\n                backgroundColor: logBuffer.length > 0 ? '#10b981' : '#d1d5db',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: 'var(--radius-sm)',\r\n                cursor: logBuffer.length > 0 ? 'pointer' : 'not-allowed',\r\n              }}\r\n            >\r\n              Download\r\n            </button>\r\n            <button\r\n              onClick={() => setLogBuffer([])}\r\n              disabled={logBuffer.length === 0}\r\n              style={{\r\n                padding: '0.375rem 0.75rem',\r\n                fontSize: '0.75rem',\r\n                backgroundColor: logBuffer.length > 0 ? '#ef4444' : '#d1d5db',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: 'var(--radius-sm)',\r\n                cursor: logBuffer.length > 0 ? 'pointer' : 'not-allowed',\r\n              }}\r\n            >\r\n              Clear\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {showLogs && (\r\n          <>\r\n            <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.5rem' }}>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                placeholder=\"Filter logs...\"\r\n                style={{\r\n                  flex: 1,\r\n                  padding: '0.375rem 0.5rem',\r\n                  fontSize: '0.75rem',\r\n                  border: '1px solid var(--color-border)',\r\n                  borderRadius: 'var(--radius-sm)',\r\n                  backgroundColor: 'var(--color-bg)',\r\n                }}\r\n              />\r\n              <label style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', fontSize: '0.75rem' }}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={autoScroll}\r\n                  onChange={(e) => setAutoScroll(e.target.checked)}\r\n                />\r\n                Auto-scroll\r\n              </label>\r\n            </div>\r\n\r\n            <div\r\n              ref={logViewerRef}\r\n              style={{\r\n                height: '200px',\r\n                padding: '0.5rem',\r\n                backgroundColor: '#1e293b',\r\n                color: '#e2e8f0',\r\n                borderRadius: 'var(--radius-sm)',\r\n                fontFamily: 'monospace',\r\n                fontSize: '0.7rem',\r\n                overflow: 'auto',\r\n                whiteSpace: 'pre-wrap',\r\n                wordBreak: 'break-all',\r\n              }}\r\n            >\r\n              {filteredLogs.length === 0 ? (\r\n                <div style={{ color: '#9ca3af', fontStyle: 'italic' }}>\r\n                  {logBuffer.length === 0 ? 'No logs yet' : 'No matches'}\r\n                </div>\r\n              ) : (\r\n                filteredLogs.map((log, idx) => {\r\n                  let color = '#e2e8f0';\r\n                  if (log.includes('[WARN]')) color = '#fbbf24';\r\n                  if (log.includes('[ERROR]')) color = '#ef4444';\r\n                  return <div key={idx} style={{ color }}>{log}</div>;\r\n                })\r\n              )}\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","/**\n * VB6 Fixture Validation\n * \n * Validates that a VB6 fixture has all required fields for simulation.\n * Used by dev panels to provide clear error messages.\n */\n\nexport type VB6Fixture = {\n  environment: any;\n  vehicle: any;\n  drivetrain: {\n    finalDrive: number;\n    efficiency: number;\n    gearRatios?: number[];\n    perGearEff?: number[];\n    shiftRPM?: number[];\n    clutch?: { launchRPM: number; slipRPM: number; slippage: number; lockup: boolean };\n    converter?: { stallRPM: number; torqueMult: number; lockup: boolean };\n  };\n  fuel?: { type: string; hpTorqueMultiplier?: number };\n  engineHP?: Array<{ rpm: number; hp: number }>;\n  pmi?: { engine_flywheel_clutch: number; transmission_driveshaft: number; tires_wheels_ringgear: number };\n};\n\nexport type ValidationResult = { ok: true } | { ok: false; missing: string[] };\n\n/**\n * Validate a VB6 fixture for completeness.\n * \n * @param fx - Partial VB6 fixture to validate\n * @returns Validation result with missing fields if incomplete\n */\nexport function validateVB6Fixture(fx: Partial<VB6Fixture>): ValidationResult {\n  const missing: string[] = [];\n  \n  // Check drivetrain exists\n  if (!fx.drivetrain) {\n    missing.push('drivetrain.*');\n    return { ok: false, missing };\n  }\n\n  // Check gear ratios\n  if (!fx.drivetrain.gearRatios?.length) {\n    missing.push('drivetrain.gearRatios');\n  }\n  \n  // Check per-gear efficiencies\n  if (!fx.drivetrain.perGearEff?.length) {\n    missing.push('drivetrain.perGearEff');\n  }\n  \n  // Check gear ratios and efficiencies match in length\n  if (fx.drivetrain.gearRatios && fx.drivetrain.perGearEff &&\n      fx.drivetrain.gearRatios.length !== fx.drivetrain.perGearEff.length) {\n    missing.push('perGearEff length must equal gearRatios length');\n  }\n  \n  // Check clutch or converter exists\n  if (!fx.drivetrain.clutch && !fx.drivetrain.converter) {\n    missing.push('drivetrain.clutch or drivetrain.converter');\n  }\n\n  // Check engine HP curve (require at least 2 points)\n  if (!fx.engineHP || fx.engineHP.length < 2) {\n    missing.push('engineHP (>=2 points)');\n  }\n  \n  // Check fuel type\n  if (!fx.fuel?.type) {\n    missing.push('fuel.type');\n  }\n  \n  // Check PMI values (use == null to allow 0.0 as valid)\n  if (fx.pmi?.engine_flywheel_clutch == null) {\n    missing.push('pmi.engine_flywheel_clutch');\n  }\n  \n  if (fx.pmi?.transmission_driveshaft == null) {\n    missing.push('pmi.transmission_driveshaft');\n  }\n  \n  if (fx.pmi?.tires_wheels_ringgear == null) {\n    missing.push('pmi.tires_wheels_ringgear');\n  }\n\n  return missing.length ? { ok: false, missing } : { ok: true };\n}\n","/**\n * Health Check Panel\n * \n * Quick validation and testing tools for VB6 fixtures.\n */\n\nimport { useState } from 'react';\nimport { useVb6Fixture } from '../../shared/state/vb6FixtureStore';\nimport { validateVB6Fixture } from '../validation/vb6Fixture';\nimport { simulate } from '../../workerBridge';\n\nexport default function HealthCheck() {\n  const { fixture } = useVb6Fixture();\n  const [validationResult, setValidationResult] = useState<any>(null);\n  const [dryRunResult, setDryRunResult] = useState<any>(null);\n  const [smokeResult, setSmokeResult] = useState<any>(null);\n  const [loading, setLoading] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleValidate = () => {\n    setLoading('validate');\n    setError(null);\n    try {\n      const result = validateVB6Fixture(fixture as any);\n      setValidationResult(result);\n    } catch (err: any) {\n      setError(err?.message ?? String(err));\n    } finally {\n      setLoading(null);\n    }\n  };\n\n  const handleDryRun = async () => {\n    setLoading('dryrun');\n    setError(null);\n    setDryRunResult(null);\n    try {\n      // TODO: Add dryRun flag support to worker\n      // For now, just validate the fixture can be normalized\n      const result = validateVB6Fixture(fixture as any);\n      setDryRunResult({\n        ok: result.ok,\n        message: result.ok \n          ? 'Fixture can be normalized successfully' \n          : `Missing fields: ${result.missing.join(', ')}`,\n        details: result\n      });\n    } catch (err: any) {\n      setError(err?.message ?? String(err));\n    } finally {\n      setLoading(null);\n    }\n  };\n\n  const handleSmokeSim = async () => {\n    setLoading('smoke');\n    setError(null);\n    setSmokeResult(null);\n    try {\n      // Run a quick simulation with VB6Exact\n      const result = await simulate('VB6Exact', {\n        ...fixture,\n        raceLengthFt: 1320,\n      });\n      setSmokeResult({\n        et_s: result.et_s,\n        mph: result.mph,\n        model: result.meta?.model,\n        steps: result.meta?.termination?.steps,\n      });\n    } catch (err: any) {\n      setError(err?.message ?? String(err));\n    } finally {\n      setLoading(null);\n    }\n  };\n\n  return (\n    <div style={{ padding: '2rem' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Health Check</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Quick validation and testing tools for VB6 fixtures.\n        </p>\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            whiteSpace: 'pre-wrap',\n            fontFamily: 'monospace',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {/* Action Buttons */}\n      <div style={{ \n        display: 'grid', \n        gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',\n        gap: '1rem',\n        marginBottom: '2rem'\n      }}>\n        <button\n          onClick={handleValidate}\n          disabled={loading !== null}\n          style={{\n            padding: '1rem',\n            fontSize: '1rem',\n            fontWeight: 500,\n            backgroundColor: loading === 'validate' ? '#9ca3af' : '#3b82f6',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: loading !== null ? 'not-allowed' : 'pointer',\n            transition: 'background-color 0.2s',\n          }}\n        >\n          {loading === 'validate' ? 'Validating...' : 'Validate Current VB6 Fixture'}\n        </button>\n\n        <button\n          onClick={handleDryRun}\n          disabled={loading !== null}\n          style={{\n            padding: '1rem',\n            fontSize: '1rem',\n            fontWeight: 500,\n            backgroundColor: loading === 'dryrun' ? '#9ca3af' : '#8b5cf6',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: loading !== null ? 'not-allowed' : 'pointer',\n            transition: 'background-color 0.2s',\n          }}\n        >\n          {loading === 'dryrun' ? 'Running...' : 'Normalize & Dry-Run'}\n        </button>\n\n        <button\n          onClick={handleSmokeSim}\n          disabled={loading !== null}\n          style={{\n            padding: '1rem',\n            fontSize: '1rem',\n            fontWeight: 500,\n            backgroundColor: loading === 'smoke' ? '#9ca3af' : '#10b981',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: loading !== null ? 'not-allowed' : 'pointer',\n            transition: 'background-color 0.2s',\n          }}\n        >\n          {loading === 'smoke' ? 'Running...' : 'Smoke Sim (1320 ft)'}\n        </button>\n      </div>\n\n      {/* Validation Result */}\n      {validationResult && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: validationResult.ok ? '#dcfce7' : '#fee2e2',\n            border: `1px solid ${validationResult.ok ? '#22c55e' : '#ef4444'}`,\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <h3 style={{ marginTop: 0, marginBottom: '0.5rem', fontSize: '1rem' }}>\n            Validation Result\n          </h3>\n          {validationResult.ok ? (\n            <p style={{ margin: 0, color: '#166534' }}>\n              ✅ Fixture is valid and complete\n            </p>\n          ) : (\n            <div>\n              <p style={{ margin: '0 0 0.5rem 0', color: '#991b1b', fontWeight: 500 }}>\n                ❌ Fixture is incomplete\n              </p>\n              <p style={{ margin: '0 0 0.5rem 0', color: '#991b1b', fontSize: '0.875rem' }}>\n                Missing fields:\n              </p>\n              <ul style={{ margin: 0, paddingLeft: '1.5rem', color: '#991b1b' }}>\n                {validationResult.missing.map((field: string) => (\n                  <li key={field} style={{ fontSize: '0.875rem' }}>{field}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Dry-Run Result */}\n      {dryRunResult && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: dryRunResult.ok ? '#dbeafe' : '#fee2e2',\n            border: `1px solid ${dryRunResult.ok ? '#3b82f6' : '#ef4444'}`,\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <h3 style={{ marginTop: 0, marginBottom: '0.5rem', fontSize: '1rem' }}>\n            Dry-Run Result\n          </h3>\n          <p style={{ margin: 0, color: dryRunResult.ok ? '#1e40af' : '#991b1b' }}>\n            {dryRunResult.ok ? '✅' : '❌'} {dryRunResult.message}\n          </p>\n        </div>\n      )}\n\n      {/* Smoke Test Result */}\n      {smokeResult && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#dcfce7',\n            border: '1px solid #22c55e',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem' }}>\n            Smoke Test Result\n          </h3>\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '1rem' }}>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: '#166534', marginBottom: '0.25rem' }}>\n                ET (s)\n              </div>\n              <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#166534' }}>\n                {smokeResult.et_s?.toFixed(3) ?? 'N/A'}\n              </div>\n            </div>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: '#166534', marginBottom: '0.25rem' }}>\n                MPH\n              </div>\n              <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#166534' }}>\n                {smokeResult.mph?.toFixed(2) ?? 'N/A'}\n              </div>\n            </div>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: '#166534', marginBottom: '0.25rem' }}>\n                Model\n              </div>\n              <div style={{ fontSize: '1rem', fontWeight: '500', color: '#166534' }}>\n                {smokeResult.model ?? 'N/A'}\n              </div>\n            </div>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: '#166534', marginBottom: '0.25rem' }}>\n                Steps\n              </div>\n              <div style={{ fontSize: '1rem', fontWeight: '500', color: '#166534' }}>\n                {smokeResult.steps ?? 'N/A'}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Info Panel */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: '#eff6ff',\n          border: '1px solid #3b82f6',\n          borderRadius: 'var(--radius-md)',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.5rem', fontSize: '1rem' }}>\n          About These Tests\n        </h3>\n        <ul style={{ margin: 0, paddingLeft: '1.5rem', fontSize: '0.875rem' }}>\n          <li style={{ marginBottom: '0.5rem' }}>\n            <strong>Validate:</strong> Checks if all required VB6 fixture fields are present\n          </li>\n          <li style={{ marginBottom: '0.5rem' }}>\n            <strong>Dry-Run:</strong> Validates that the fixture can be normalized (no actual simulation)\n          </li>\n          <li>\n            <strong>Smoke Sim:</strong> Runs a quick 1320 ft simulation to verify the fixture works end-to-end\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n","/**\n * VB6 Fixture Adapter\n * \n * Converts VB6 UI fixtures into the format expected by the simulation engine.\n * Handles field mapping, defaults, and validation.\n */\n\nimport type { VB6Fixture } from '../validation/vb6Fixture';\n\ntype PowerPt = { rpm: number; hp: number };\n\n/**\n * Convert VB6 engineHP array to power curve format.\n * Handles both tuple format [[rpm, hp]] and object format [{rpm, hp}].\n * Applies fuel multiplier if present.\n */\nexport function toPowerCurveFromVB6(fx: VB6Fixture): PowerPt[] {\n  const m = fx?.fuel?.hpTorqueMultiplier ?? 1;\n  const engineHP = fx.engineHP ?? [];\n  \n  const curve = engineHP.map(p => {\n    // Handle both tuple [rpm, hp] and object {rpm, hp} formats\n    if (Array.isArray(p)) {\n      return {\n        rpm: Number(p[0]),\n        hp: Number(p[1]) * m,\n      };\n    } else {\n      return {\n        rpm: Number((p as any).rpm),\n        hp: Number((p as any).hp) * m,\n      };\n    }\n  })\n  .filter(p => Number.isFinite(p.rpm) && Number.isFinite(p.hp))\n  .sort((a, b) => a.rpm - b.rpm);\n\n  if (curve.length < 2) {\n    throw new Error(\"VB6 fixture missing engineHP curve (>=2 points required).\");\n  }\n  return curve;\n}\n\n/**\n * Infer redline RPM from power curve.\n * Uses highest RPM point + 100 as a safe margin.\n */\nexport function inferRedlineRPM(curve: PowerPt[]): number {\n  return (curve[curve.length - 1]?.rpm ?? 8000) + 100;\n}\n\n/**\n * Build engine parameters object for simulation.\n */\nexport function toEngineParams(fx: VB6Fixture) {\n  const powerHP = toPowerCurveFromVB6(fx);\n  return {\n    powerHP,                // REQUIRED for worker\n    redlineRPM: inferRedlineRPM(powerHP),\n    idleRPM: 900,           // harmless default\n  };\n}\n\n/**\n * Build drivetrain object the sim expects.\n * Includes ratios, per-gear efficiency, final drive, overall efficiency, clutch/converter.\n */\nexport function toDrivetrainParams(fx: VB6Fixture) {\n  const gr = fx.drivetrain?.gearRatios ?? [];\n  const ge = fx.drivetrain?.perGearEff ?? [];\n  if (!gr.length || !ge.length || gr.length !== ge.length) {\n    throw new Error(\"VB6 fixture must provide gearRatios and perGearEff of equal length.\");\n  }\n  return {\n    gearRatios: gr,\n    perGearEff: ge,\n    finalDrive: (fx as any).finalDrive?.ratio ?? fx.drivetrain?.finalDrive ?? 3.73,\n    overallEff: (fx as any).finalDrive?.efficiency ?? fx.drivetrain?.efficiency ?? 0.97,\n    clutch: fx.drivetrain?.clutch,\n    converter: fx.drivetrain?.converter,\n    shiftRPM: fx.drivetrain?.shiftRPM,  // array or single number—pass through\n  };\n}\n\n/**\n * Ensure PMI values exist with defaults.\n * Uses snake_case field names to match fixture format.\n */\nexport function ensurePMI(fx: VB6Fixture) {\n  const p = fx.pmi as any ?? {};\n  return {\n    engine_flywheel_clutch: p.engine_flywheel_clutch ?? 3.42,\n    transmission_driveshaft: p.transmission_driveshaft ?? 0.247,\n    tires_wheels_ringgear: p.tires_wheels_ringgear ?? 50.8,\n  };\n}\n\n/**\n * Normalize environment parameters with defaults.\n */\nexport function normalizeEnv(fx: VB6Fixture) {\n  const env = fx.environment ?? {};\n  return {\n    elevationFt: (env as any).elevation_ft ?? (env as any).elevation ?? 0,\n    baroInHg: (env as any).barometer_inHg ?? (env as any).barometer ?? 29.92,\n    tempF: (env as any).temp_F ?? (env as any).temperature ?? 59,\n    rhPct: (env as any).rel_humidity_pct ?? (env as any).humidity ?? 0,\n    windMPH: (env as any).wind_mph ?? (env as any).windVelocity ?? 0,\n    windDeg: (env as any).wind_angle_deg ?? (env as any).windAngle ?? 0,\n    trackTempF: (env as any).trackTemp_F ?? (env as any).trackTemp ?? 80,\n    tractionIdx: (env as any).tractionIndex ?? 3,\n  };\n}\n\n/**\n * Convert VB6 fixture to simulation input format.\n * Main entry point for fixture adaptation.\n * Does not mutate the incoming fixture.\n */\nexport function toSimInputFromVB6(fx: VB6Fixture, distanceFt: number) {\n  const pmi = ensurePMI(fx);\n  const env = normalizeEnv(fx);\n\n  // Determine race length from distance\n  const raceLength = distanceFt <= 660 ? 'EIGHTH' : 'QUARTER';\n\n  // --- Drivetrain (preserve clutch/converter exactly) ---\n  const dt = fx.drivetrain ?? {};\n  const drivetrain = {\n    finalDrive: Number(dt.finalDrive ?? (dt as any).final_drive ?? 0),\n    overallEff: Number((dt as any).overallEff ?? (dt as any).overallEfficiency ?? dt.efficiency ?? 1),\n    gearRatios: Array.isArray(dt.gearRatios) ? dt.gearRatios.map(Number) : [],\n    perGearEff: Array.isArray(dt.perGearEff) ? dt.perGearEff.map(Number) : [],\n    shiftRPM: Array.isArray(dt.shiftRPM ?? (dt as any).shiftsRPM) ? (dt.shiftRPM ?? (dt as any).shiftsRPM).map(Number) : [],\n    // IMPORTANT: pass through objects unmodified so the model can read keys directly\n    clutch: dt.clutch ? { ...dt.clutch } : undefined,\n    converter: dt.converter ? { ...dt.converter } : undefined,\n  };\n\n  // Minimal vehicle block (only the fields VB6Exact actually reads)\n  const veh = fx.vehicle ?? {};\n  const vehicle = {\n    weightLb: (veh as any).weight_lb ?? (veh as any).weight ?? (fx as any).weight ?? 2400,\n    wheelbaseIn: (veh as any).wheelbase_in ?? (veh as any).wheelbase ?? 107,\n    tireRolloutIn: (fx as any).finalDrive?.tireRolloutIn ?? (veh as any).tire_rollout_in ?? (veh as any).rollout ?? 102.5,\n    tireWidthIn: (fx as any).finalDrive?.tireWidthIn ?? (veh as any).tire_width_in ?? (veh as any).tireWidth ?? 17,\n    frontalAreaFt2: (fx as any).aero?.frontalArea ?? (veh as any).frontalArea_ft2 ?? 18.2,\n    Cd: (fx as any).aero?.cd ?? (veh as any).Cd ?? 0.24,\n    Cl: (fx as any).aero?.cl ?? (veh as any).Cl ?? 0.10,\n    overhangIn: (veh as any).overhang_in ?? (veh as any).overhang ?? 40,\n  };\n\n  // Build output object\n  const out: any = {\n    model: \"VB6Exact\",\n    distanceFt,\n    raceLength: raceLength as 'EIGHTH' | 'QUARTER',\n    env,\n    vehicle,\n    drivetrain,\n    pmi,\n    fuel: fx.fuel, // keep for multiplier auditing\n  };\n\n  // Build engineParams.powerHP from fixture.engineHP\n  // Do not mutate incoming fixture, only write to out object\n  if (fx.engineHP && Array.isArray(fx.engineHP)) {\n    const hpMult = fx?.fuel?.hpTorqueMultiplier ?? 1;\n    const powerHP = (fx.engineHP ?? [])\n      .map((pt: any) =>\n        Array.isArray(pt)\n          ? ({ rpm: Number(pt[0]), hp: Number(pt[1]) * hpMult })\n          : ({ rpm: Number(pt?.rpm), hp: Number(pt?.hp) * hpMult }))\n      .filter(p => Number.isFinite(p.rpm) && Number.isFinite(p.hp))\n      .sort((a, b) => a.rpm - b.rpm);\n    \n    if (powerHP.length >= 2) {\n      out.engineParams = { \n        powerHP,\n        redlineRPM: inferRedlineRPM(powerHP),\n        idleRPM: 900,\n      };\n    }\n  }\n\n  // --- Ensure race length numeric for model ---\n  const raceLenFt =\n    Number.isFinite(distanceFt) ? Number(distanceFt) :\n    Number((fx as any)?.raceLengthFt) ||\n    ((fx as any)?.raceLength === 'EIGHTH' ? 660 : 1320);\n\n  out.raceLengthFt = raceLenFt;        // model primary field\n  out.raceLength = raceLenFt === 660 ? 'EIGHTH' : 'QUARTER'; // alias for logs\n\n  // --- Ensure engineParams.powerHP from VB6 engineHP (tuples/objects) ---\n  if (!out.engineParams?.powerHP && Array.isArray((fx as any)?.engineHP)) {\n    const hpMult = (fx as any)?.fuel?.hpTorqueMultiplier ?? 1;\n    const powerHP = (fx as any).engineHP\n      .map((pt: any) => Array.isArray(pt)\n        ? { rpm: Number(pt[0]), hp: Number(pt[1]) * hpMult }\n        : { rpm: Number(pt?.rpm), hp: Number(pt?.hp) * hpMult })\n      .filter((p: any) => Number.isFinite(p.rpm) && Number.isFinite(p.hp))\n      .sort((a: any, b: any) => a.rpm - b.rpm);\n    if (powerHP.length >= 2) {\n      out.engineParams = { ...(out.engineParams ?? {}), powerHP };\n    }\n  }\n\n  return out;\n}\n","/**\n * Vehicle Picker Component\n * \n * Selector for choosing active vehicle from the vehicles store.\n * Shared selection with Vehicle Editor.\n */\n\nimport { useVehicleStore } from '../../state/vehicleStore';\n\ninterface VehiclePickerProps {\n  onSelect?: (vehicleId: string) => void;\n  showEditButton?: boolean;\n  onEditClick?: () => void;\n}\n\nexport function VehiclePicker({ onSelect, showEditButton = true, onEditClick }: VehiclePickerProps) {\n  const { vehicles, activeVehicleId, setActiveVehicleById, loading } = useVehicleStore();\n\n  const handleChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const id = e.target.value || null;\n    setActiveVehicleById(id);\n    if (id && onSelect) {\n      onSelect(id);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div style={{ \n        padding: '0.75rem', \n        backgroundColor: 'var(--color-bg-secondary)',\n        borderRadius: 'var(--radius-md)',\n        marginBottom: '1rem',\n        border: '1px solid var(--color-border)'\n      }}>\n        <span style={{ color: 'var(--color-text-secondary)', fontSize: '0.875rem' }}>\n          Loading vehicles...\n        </span>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ \n      padding: '0.75rem', \n      backgroundColor: 'var(--color-bg-secondary)',\n      borderRadius: 'var(--radius-md)',\n      marginBottom: '1rem',\n      border: '1px solid var(--color-border)',\n      display: 'flex',\n      alignItems: 'center',\n      gap: '0.75rem',\n    }}>\n      <label style={{ \n        fontSize: '0.875rem', \n        fontWeight: '500',\n        color: 'var(--color-text)',\n        whiteSpace: 'nowrap',\n      }}>\n        Active Vehicle:\n      </label>\n      \n      <select\n        value={activeVehicleId ?? ''}\n        onChange={handleChange}\n        style={{\n          flex: 1,\n          padding: '0.5rem',\n          fontSize: '0.875rem',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          backgroundColor: 'var(--color-bg)',\n        }}\n      >\n        <option value=\"\">— Select a vehicle —</option>\n        {vehicles.map(v => (\n          <option key={v.id} value={v.id}>\n            {v.name || v.id}\n          </option>\n        ))}\n      </select>\n\n      {showEditButton && activeVehicleId && (\n        <button\n          onClick={onEditClick}\n          style={{\n            padding: '0.5rem 0.75rem',\n            fontSize: '0.75rem',\n            backgroundColor: 'var(--color-primary)',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: 'pointer',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          Edit in Vehicle Editor\n        </button>\n      )}\n\n      {vehicles.length === 0 && (\n        <span style={{ \n          fontSize: '0.75rem', \n          color: 'var(--color-text-secondary)',\n          fontStyle: 'italic',\n        }}>\n          No vehicles saved yet\n        </span>\n      )}\n    </div>\n  );\n}\n","/**\n * Run Inspector & Steps Panel\n * \n * Run simulations with VB6 fixtures and inspect detailed step-by-step data.\n * Displays the consolidated 12-step table with all physics values.\n */\n\nimport { useState, startTransition } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useVb6Fixture } from '../../shared/state/vb6FixtureStore';\nimport { useFlag, useFlagsStore, USER_LEVELS } from '../../domain/flags/store.tsx';\nimport { useVehicleStore } from '../../state/vehicleStore';\nimport { validateVB6Fixture } from '../validation/vb6Fixture';\nimport { toSimInputFromVB6 } from '../vb6/fixtureAdapter';\nimport { fromVehicleToVB6Fixture, validateAdapterOutput } from '../vb6/fromVehicle';\nimport { simulate } from '../../workerBridge';\nimport { VehiclePicker } from '../components/VehiclePicker';\nimport type { SimResult } from '../../domain/physics';\nimport type { RaceLength } from '../../domain/config/raceLengths';\n\n/**\n * Local guard to ensure engineParams.powerHP exists (idempotent with worker).\n * Converts VB6 engineHP if needed.\n */\nfunction adaptVB6ToEngineParams(input: any): any {\n  if (!input?.engineParams?.powerHP && Array.isArray(input?.engineHP)) {\n    const hpMult = input?.fuel?.hpTorqueMultiplier ?? 1;\n    const powerHP = input.engineHP\n      .map((pt: any) => Array.isArray(pt)\n        ? { rpm: Number(pt[0]), hp: Number(pt[1]) * hpMult }\n        : { rpm: Number(pt?.rpm), hp: Number(pt?.hp) * hpMult })\n      .filter((p: any) => Number.isFinite(p.rpm) && Number.isFinite(p.hp))\n      .sort((a: any, b: any) => a.rpm - b.rpm);\n    if (powerHP.length >= 2) {\n      input.engineParams = { ...(input.engineParams ?? {}), powerHP };\n    }\n  }\n  return input;\n}\n\ninterface StepData {\n  step: number;\n  v_ftps: number;\n  EngRPM: number;\n  wheelRPM: number;\n  ClutchSlip: number;\n  HPSave: number;\n  HPEngPMI: number;\n  HPChasPMI: number;\n  DragHP: number;\n  HP_afterL1: number;\n  HP_afterL2: number;\n  PQWT: number;\n  AMin: number;\n  AMax: number;\n  AGS_applied: number;\n  Vel_next: number;\n  Dist_next: number;\n}\n\nexport default function RunInspector() {\n  const navigate = useNavigate();\n  const { fixture, setFixture } = useVb6Fixture();\n  const enableStepTrace = useFlag('enableStepTrace');\n  const flagsStore = useFlagsStore();\n  const { userLevel, setUserLevel } = flagsStore;\n  const { activeVehicle } = useVehicleStore();\n  \n  // Always use VB6Exact model\n  const [raceLength, setRaceLength] = useState<RaceLength>('QUARTER');\n  const [running, setRunning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<SimResult | null>(null);\n  const [stepData, setStepData] = useState<StepData[]>([]);\n\n  // Validate fixture\n  const validation = validateVB6Fixture(fixture as any);\n\n  // Handle vehicle selection - convert to VB6 fixture and update state\n  const handleVehicleSelect = (vehicleId: string) => {\n    console.log('[RunInspector] Vehicle selected:', vehicleId);\n    \n    if (activeVehicle && activeVehicle.id === vehicleId) {\n      try {\n        const vb6Fixture = fromVehicleToVB6Fixture(activeVehicle as any);\n        \n        // Validate adapter output before setting\n        const validation = validateAdapterOutput(vb6Fixture);\n        if (!validation.ok) {\n          console.warn('[RunInspector] Adapter validation warnings:', validation.errors);\n          setError(`Vehicle data incomplete: ${validation.errors.join('; ')}`);\n          return;\n        }\n        \n        setFixture(vb6Fixture as any);\n        console.log('[RunInspector] Fixture updated from vehicle:', {\n          vehicleId,\n          vehicleName: activeVehicle.name,\n          engineHPCount: vb6Fixture.engineHP?.length,\n          gearCount: vb6Fixture.drivetrain?.gearRatios?.length,\n        });\n      } catch (err: any) {\n        console.error('[RunInspector] Failed to convert vehicle to fixture:', err);\n        setError(`Failed to load vehicle: ${err.message}`);\n      }\n    }\n  };\n\n  // Navigate to vehicle editor\n  const handleEditVehicle = () => {\n    startTransition(() => navigate('/vehicles'));\n  };\n\n  const handleRun = async () => {\n    if (!fixture) {\n      setError('No fixture loaded.');\n      return;\n    }\n\n    setRunning(true);\n    setError(null);\n    setResult(null);\n    setStepData([]);\n\n    let input: any = null;\n    try {\n      // Convert race length to distance in feet\n      const distanceFt = raceLength === 'EIGHTH' ? 660 : 1320;\n      \n      // build VB6 → sim input\n      input = toSimInputFromVB6(fixture as any, distanceFt);\n      \n      // local guard (idempotent with worker)\n      input = adaptVB6ToEngineParams(input);\n      input.raceLengthFt = distanceFt;\n      \n      console.log('[RUN] powerHP?', Array.isArray(input?.engineParams?.powerHP), \n                  input?.engineParams?.powerHP?.slice?.(0, 2), \n                  'raceLengthFt', input?.raceLengthFt);\n      \n      // TODO: Capture step data from console logs\n      // For now, we'll just run the simulation and get the result\n      // In the future, we need to hook into the logger or pass a callback\n      \n      const res = await simulate('VB6Exact', input);\n      setResult(res);\n      \n      // Parse step data from console if available\n      // This is a placeholder - in production, we'd need a proper hook\n      setStepData([]);\n      \n    } catch (err: any) {\n      const hp = input?.engineParams?.powerHP;\n      console.error('[Run Inspector error]', err, { \n        hpSummary: Array.isArray(hp) ? `n=${hp.length},first=${hp[0]?.rpm},last=${hp[hp.length-1]?.rpm}` : 'none' \n      });\n      setError(err?.message ?? String(err));\n    } finally {\n      setRunning(false);\n    }\n  };\n\n  const handleDownloadCsv = () => {\n    if (stepData.length === 0) {\n      alert('No step data available to download');\n      return;\n    }\n\n    // Build CSV\n    const headers = [\n      'step', 'v_ftps', 'EngRPM', 'wheelRPM', 'ClutchSlip',\n      'HPSave', 'HPEngPMI', 'HPChasPMI', 'DragHP',\n      'HP_afterL1', 'HP_afterL2', 'PQWT',\n      'AMin', 'AMax', 'AGS_applied',\n      'Vel_next', 'Dist_next'\n    ];\n    \n    const rows = stepData.map(row => [\n      row.step,\n      row.v_ftps,\n      row.EngRPM,\n      row.wheelRPM,\n      row.ClutchSlip,\n      row.HPSave,\n      row.HPEngPMI,\n      row.HPChasPMI,\n      row.DragHP,\n      row.HP_afterL1,\n      row.HP_afterL2,\n      row.PQWT,\n      row.AMin,\n      row.AMax,\n      row.AGS_applied,\n      row.Vel_next,\n      row.Dist_next,\n    ]);\n\n    const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\\n');\n    \n    // Download\n    const blob = new Blob([csv], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `run-inspector-VB6Exact-${raceLength}-${Date.now()}.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Run Inspector & Steps</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Run simulations with VB6 fixtures and inspect detailed step-by-step physics data.\n        </p>\n      </div>\n\n      {/* VB6 Fixture Validation Error */}\n      {!validation.ok && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <p style={{ margin: '0 0 0.75rem 0', fontSize: '0.875rem', color: '#991b1b', fontWeight: '600' }}>\n            Fixture validation failed.\n          </p>\n          <pre\n            style={{\n              margin: '0 0 0.75rem 0',\n              padding: '0.5rem',\n              backgroundColor: '#fef2f2',\n              border: '1px solid #fca5a5',\n              borderRadius: 'var(--radius-sm)',\n              fontSize: '0.75rem',\n              color: '#991b1b',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre-wrap',\n              wordBreak: 'break-word',\n            }}\n          >\n            {validation.missing.join(', ')}\n          </pre>\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\n            <button\n              onClick={() => startTransition(() => navigate('/dev?panel=input-inspector'))}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#3b82f6',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Open VB6 Inputs\n            </button>\n            <button\n              onClick={() => navigate('/dev?panel=quick-paste&example=prostock')}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#6b7280',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Load ProStock_Pro Example\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Step Trace Flag Warning */}\n      {!enableStepTrace && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fef3c7',\n            border: '1px solid #fbbf24',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <p style={{ margin: 0, fontSize: '0.875rem', color: '#92400e' }}>\n            <strong>💡 Hint:</strong> Enable <code>enableStepTrace</code> flag in the Feature Flags panel\n            to capture detailed step data during simulation runs.\n          </p>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            whiteSpace: 'pre-wrap',\n            fontFamily: 'monospace',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {/* User Level Control */}\n      <div\n        style={{\n          padding: '0.75rem',\n          backgroundColor: 'var(--color-bg-secondary)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n          border: '1px solid var(--color-border)',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '0.75rem',\n        }}\n      >\n        <label style={{ \n          fontSize: '0.875rem', \n          fontWeight: '500',\n          color: 'var(--color-text)',\n          whiteSpace: 'nowrap',\n        }}>\n          User Level:\n        </label>\n        <div style={{ display: 'flex', gap: '0.25rem' }}>\n          {USER_LEVELS.map(level => (\n            <button\n              key={level}\n              onClick={() => setUserLevel(level)}\n              style={{\n                padding: '0.375rem 0.75rem',\n                fontSize: '0.75rem',\n                fontWeight: userLevel === level ? '600' : '400',\n                backgroundColor: userLevel === level ? 'var(--color-primary)' : 'var(--color-bg)',\n                color: userLevel === level ? 'white' : 'var(--color-text)',\n                border: `1px solid ${userLevel === level ? 'var(--color-primary)' : 'var(--color-border)'}`,\n                borderRadius: 'var(--radius-sm)',\n                cursor: 'pointer',\n                textTransform: 'capitalize',\n              }}\n            >\n              {level}\n            </button>\n          ))}\n        </div>\n        {userLevel === 'admin' && (\n          <span style={{ fontSize: '0.75rem', color: 'var(--color-text-secondary)' }}>\n            🔓 Full access\n          </span>\n        )}\n      </div>\n\n      {/* Vehicle Picker */}\n      <VehiclePicker \n        onSelect={handleVehicleSelect} \n        onEditClick={handleEditVehicle}\n      />\n\n      {/* Controls */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\n          Controls\n        </h3>\n        \n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1rem' }}>\n          {/* Distance Selection */}\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\n              Distance\n            </label>\n            <select\n              value={raceLength}\n              onChange={(e) => setRaceLength(e.target.value as RaceLength)}\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            >\n              <option value=\"EIGHTH\">EIGHTH (660 ft)</option>\n              <option value=\"QUARTER\">QUARTER (1320 ft)</option>\n            </select>\n          </div>\n\n          {/* Run Button */}\n          <div style={{ display: 'flex', alignItems: 'flex-end' }}>\n            <button\n              onClick={handleRun}\n              disabled={running || !validation.ok}\n              style={{\n                width: '100%',\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                fontWeight: '500',\n                backgroundColor: (running || !validation.ok) ? '#9ca3af' : '#10b981',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: (running || !validation.ok) ? 'not-allowed' : 'pointer',\n              }}\n            >\n              {running ? 'Running...' : 'Run with current VB6 UI Fixture'}\n            </button>\n          </div>\n        </div>\n\n        {/* Validation Checklist */}\n        <div\n          style={{\n            marginTop: '1rem',\n            padding: '0.75rem',\n            backgroundColor: validation.ok ? '#f0fdf4' : '#fef2f2',\n            border: `1px solid ${validation.ok ? '#86efac' : '#fca5a5'}`,\n            borderRadius: 'var(--radius-md)',\n          }}\n        >\n          <div style={{ fontSize: '0.75rem', fontWeight: '600', marginBottom: '0.5rem', color: validation.ok ? '#166534' : '#991b1b' }}>\n            Fixture Requirements\n          </div>\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '0.25rem', fontSize: '0.75rem' }}>\n            {/* Check gearRatios */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n              <span>{(fixture as any).drivetrain?.gearRatios?.length ? '✅' : '❌'}</span>\n              <span style={{ color: 'var(--color-text)' }}>drivetrain.gearRatios</span>\n            </div>\n            \n            {/* Check perGearEff */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n              <span>{(fixture as any).drivetrain?.perGearEff?.length ? '✅' : '❌'}</span>\n              <span style={{ color: 'var(--color-text)' }}>drivetrain.perGearEff</span>\n            </div>\n            \n            {/* Check clutch or converter */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n              <span>{((fixture as any).drivetrain?.clutch || (fixture as any).drivetrain?.converter) ? '✅' : '❌'}</span>\n              <span style={{ color: 'var(--color-text)' }}>clutch or converter</span>\n            </div>\n            \n            {/* Check engineHP */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n              <span>{(fixture as any).engineHP?.length ? '✅' : '❌'}</span>\n              <span style={{ color: 'var(--color-text)' }}>engineHP</span>\n            </div>\n            \n            {/* Check fuel.type */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n              <span>{(fixture as any).fuel?.type ? '✅' : '❌'}</span>\n              <span style={{ color: 'var(--color-text)' }}>fuel.type</span>\n            </div>\n            \n            {/* Check PMI */}\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n              <span\n                title={\n                  ((fixture as any).pmi?.engine_flywheel_clutch != null &&\n                   (fixture as any).pmi?.transmission_driveshaft != null &&\n                   (fixture as any).pmi?.tires_wheels_ringgear != null)\n                    ? 'All PMI fields present'\n                    : (() => {\n                        const missing: string[] = [];\n                        if ((fixture as any).pmi?.engine_flywheel_clutch == null) missing.push('engine_flywheel_clutch');\n                        if ((fixture as any).pmi?.transmission_driveshaft == null) missing.push('transmission_driveshaft');\n                        if ((fixture as any).pmi?.tires_wheels_ringgear == null) missing.push('tires_wheels_ringgear');\n                        return `Missing: ${missing.join(', ')}`;\n                      })()\n                }\n              >\n                {((fixture as any).pmi?.engine_flywheel_clutch != null &&\n                  (fixture as any).pmi?.transmission_driveshaft != null &&\n                  (fixture as any).pmi?.tires_wheels_ringgear != null) ? '✅' : '❌'}\n              </span>\n              <span style={{ color: 'var(--color-text)' }}>pmi.*</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Results */}\n      {result && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: 'var(--color-surface)',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\n            Results\n          </h3>\n          \n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '1rem' }}>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                ET (s)\n              </div>\n              <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>\n                {result.et_s.toFixed(3)}\n              </div>\n            </div>\n            \n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                MPH\n              </div>\n              <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>\n                {result.mph.toFixed(2)}\n              </div>\n            </div>\n            \n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                Model\n              </div>\n              <div style={{ fontSize: '1rem', fontWeight: '500' }}>\n                {result.meta.model}\n              </div>\n            </div>\n            \n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                Termination\n              </div>\n              <div style={{ fontSize: '0.875rem' }}>\n                {result.meta.termination?.reason || 'DISTANCE'}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* First 12 Steps Table */}\n      {stepData.length > 0 && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: 'var(--color-surface)',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n          }}\n        >\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\n            <h3 style={{ margin: 0, fontSize: '1rem', fontWeight: '600' }}>\n              First 12 Steps\n            </h3>\n            <button\n              onClick={handleDownloadCsv}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#6b7280',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Download CSV\n            </button>\n          </div>\n          \n          <div style={{ overflowX: 'auto' }}>\n            <table\n              style={{\n                width: '100%',\n                fontSize: '0.75rem',\n                borderCollapse: 'collapse',\n                fontFamily: 'monospace',\n              }}\n            >\n              <thead>\n                <tr style={{ backgroundColor: '#1e293b', color: '#e2e8f0' }}>\n                  <th style={{ padding: '0.5rem', textAlign: 'left', borderBottom: '2px solid var(--color-border)' }}>Step</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>v_ftps</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>EngRPM</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>wheelRPM</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>ClutchSlip</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>HPSave</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>HPEngPMI</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>HPChasPMI</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>DragHP</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>HP_L1</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>HP_L2</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>PQWT</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>AMin</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>AMax</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>AGS</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>Vel_next</th>\n                  <th style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>Dist_next</th>\n                </tr>\n              </thead>\n              <tbody>\n                {stepData.map((row, idx) => (\n                  <tr\n                    key={row.step}\n                    style={{\n                      backgroundColor: idx % 2 === 0 ? 'transparent' : 'rgba(0,0,0,0.02)',\n                    }}\n                  >\n                    <td style={{ padding: '0.5rem', borderBottom: '1px solid var(--color-border)' }}>{row.step}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.v_ftps.toFixed(3)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.EngRPM.toFixed(0)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.wheelRPM.toFixed(2)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.ClutchSlip.toFixed(4)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.HPSave.toFixed(1)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.HPEngPMI.toFixed(1)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.HPChasPMI.toFixed(1)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.DragHP.toFixed(2)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.HP_afterL1.toFixed(1)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.HP_afterL2.toFixed(1)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.PQWT.toFixed(1)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.AMin.toFixed(3)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.AMax.toFixed(3)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.AGS_applied.toFixed(3)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.Vel_next.toFixed(3)}</td>\n                    <td style={{ padding: '0.5rem', textAlign: 'right', borderBottom: '1px solid var(--color-border)' }}>{row.Dist_next.toFixed(6)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Placeholder when no step data */}\n      {result && stepData.length === 0 && (\n        <div\n          style={{\n            padding: '2rem',\n            textAlign: 'center',\n            backgroundColor: 'var(--color-surface)',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n            color: 'var(--color-muted)',\n          }}\n        >\n          <p style={{ margin: 0, fontSize: '0.875rem' }}>\n            Step data capture not yet implemented. Enable <code>enableStepTrace</code> flag\n            and implement step data collection hook in rsaclassic.ts.\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * VB6 UI Fixture to Simulation Input Mapper\n * \n * Converts VB6 fixture format to the format expected by simulate().\n * This is a placeholder for future implementation.\n */\n\nimport type { Vb6VehicleFixture } from './fixtures';\nimport type { Vehicle } from '../../schemas/vehicle.schema';\nimport type { Env } from '../../schemas/env.schema';\n\nexport interface SimulationInput {\n  vehicle: Vehicle;\n  env: Env;\n  raceLength: 'EIGHTH' | 'QUARTER';\n}\n\n/**\n * Build simulation input from VB6 UI fixture.\n * \n * TODO: Implement actual conversion logic.\n * For now, this returns a placeholder structure.\n */\nexport function buildInputFromUiFixture(fixture: Vb6VehicleFixture): SimulationInput {\n  // Placeholder implementation\n  // In the future, this will convert the VB6 fixture format\n  // to the Vehicle/Env schema format expected by simulate()\n  \n  return {\n    vehicle: {\n      name: 'VB6 Fixture Vehicle',\n      weightLb: fixture.vehicle.weight_lb,\n      // ... other mappings TBD\n    } as Vehicle,\n    env: {\n      elevation: fixture.env.elevation_ft,\n      temperatureF: fixture.env.temperature_F,\n      barometerInHg: fixture.env.barometer_inHg,\n      humidityPct: fixture.env.relHumidity_pct,\n      trackTempF: fixture.env.trackTemp_F,\n      tractionIndex: fixture.env.tractionIndex,\n      windMph: fixture.env.wind_mph,\n      windAngleDeg: fixture.env.wind_angle_deg,\n    },\n    raceLength: 'QUARTER',\n  };\n}\n","/**\n * Energy Accounting Panel\n * \n * Visualize energy flow and balance during simulation runs.\n * Shows energy input, losses, and final kinetic energy.\n */\n\nimport { useState } from 'react';\nimport { useVb6Fixture } from '../../shared/state/vb6FixtureStore';\nimport { useFlag } from '../../domain/flags/store.tsx';\nimport { assertComplete, Vb6FixtureValidationError } from '../../domain/physics/vb6/fixtures';\nimport { buildInputFromUiFixture } from '../../domain/physics/vb6/uiMapper';\nimport { simulate } from '../../workerBridge';\nimport type { SimResult } from '../../domain/physics';\n\ninterface EnergyBreakdown {\n  engine_in_ftlbf: number;\n  drag_loss_ftlbf: number;\n  rolling_resistance_ftlbf: number;\n  driveline_loss_ftlbf: number;\n  engine_pmi_loss_ftlbf: number;\n  chassis_pmi_loss_ftlbf: number;\n  final_ke_ftlbf: number;\n  balance_ftlbf: number;\n  balance_pct: number;\n}\n\nexport default function EnergyPanel() {\n  const { fixture } = useVb6Fixture();\n  const enableEnergyLogging = useFlag('enableEnergyLogging');\n  \n  const [running, setRunning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<SimResult | null>(null);\n  const [energyData, setEnergyData] = useState<EnergyBreakdown | null>(null);\n  // Always use VB6Exact model\n\n  const handleRun = async () => {\n    setRunning(true);\n    setError(null);\n    setResult(null);\n    setEnergyData(null);\n\n    try {\n      // Validate fixture\n      assertComplete(fixture);\n      \n      // Build simulation input\n      const input = buildInputFromUiFixture(fixture);\n      input.raceLength = 'QUARTER';\n      \n      // Run simulation\n      const simResult = await simulate('VB6Exact', input);\n      setResult(simResult);\n      \n      // Extract energy data from meta\n      const energy = (simResult.meta as any).energy;\n      if (energy) {\n        const totalIn = energy.engine_in_ftlbf || 0;\n        const balance = energy.balance_ftlbf || 0;\n        \n        setEnergyData({\n          engine_in_ftlbf: energy.engine_in_ftlbf || 0,\n          drag_loss_ftlbf: energy.drag_loss_ftlbf || 0,\n          rolling_resistance_ftlbf: energy.rolling_resistance_ftlbf || 0,\n          driveline_loss_ftlbf: energy.driveline_loss_ftlbf || 0,\n          engine_pmi_loss_ftlbf: energy.engine_pmi_loss_ftlbf || 0,\n          chassis_pmi_loss_ftlbf: energy.chassis_pmi_loss_ftlbf || 0,\n          final_ke_ftlbf: energy.final_ke_ftlbf || 0,\n          balance_ftlbf: balance,\n          balance_pct: totalIn > 0 ? (balance / totalIn) * 100 : 0,\n        });\n      } else {\n        setError('Energy data not available in simulation result. Enable enableEnergyLogging flag.');\n      }\n      \n    } catch (err) {\n      if (err instanceof Vb6FixtureValidationError) {\n        setError(`Fixture validation failed:\\n\\n${err.message}\\n\\nPlease complete all required fields in VB6 Inputs panel.`);\n      } else {\n        setError(err instanceof Error ? err.message : String(err));\n      }\n    } finally {\n      setRunning(false);\n    }\n  };\n\n  const handleExportJson = () => {\n    if (!energyData) return;\n    \n    const json = JSON.stringify(energyData, null, 2);\n    const blob = new Blob([json], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `energy-breakdown-${Date.now()}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const handleExportCsv = () => {\n    if (!energyData) return;\n    \n    const headers = ['Category', 'Energy (ft-lbf)', 'Percentage'];\n    const totalIn = energyData.engine_in_ftlbf;\n    \n    const rows = [\n      ['Engine Input', energyData.engine_in_ftlbf, '100.00%'],\n      ['Drag Loss', energyData.drag_loss_ftlbf, `${((energyData.drag_loss_ftlbf / totalIn) * 100).toFixed(2)}%`],\n      ['Rolling Resistance', energyData.rolling_resistance_ftlbf, `${((energyData.rolling_resistance_ftlbf / totalIn) * 100).toFixed(2)}%`],\n      ['Driveline Loss', energyData.driveline_loss_ftlbf, `${((energyData.driveline_loss_ftlbf / totalIn) * 100).toFixed(2)}%`],\n      ['Engine PMI Loss', energyData.engine_pmi_loss_ftlbf, `${((energyData.engine_pmi_loss_ftlbf / totalIn) * 100).toFixed(2)}%`],\n      ['Chassis PMI Loss', energyData.chassis_pmi_loss_ftlbf, `${((energyData.chassis_pmi_loss_ftlbf / totalIn) * 100).toFixed(2)}%`],\n      ['Final Kinetic Energy', energyData.final_ke_ftlbf, `${((energyData.final_ke_ftlbf / totalIn) * 100).toFixed(2)}%`],\n      ['Balance', energyData.balance_ftlbf, `${energyData.balance_pct.toFixed(2)}%`],\n    ];\n\n    const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\\n');\n    \n    const blob = new Blob([csv], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `energy-breakdown-${Date.now()}.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Energy Accounting</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Visualize energy flow and balance during simulation runs.\n        </p>\n      </div>\n\n      {/* Energy Logging Flag Warning */}\n      {!enableEnergyLogging && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fef3c7',\n            border: '1px solid #fbbf24',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <p style={{ margin: 0, fontSize: '0.875rem', color: '#92400e' }}>\n            <strong>💡 Instructions:</strong> Enable <code>enableEnergyLogging</code> flag in the Feature Flags panel\n            to capture energy accounting data during simulation runs.\n          </p>\n        </div>\n      )}\n\n      {/* Error Display */}\n      {error && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            whiteSpace: 'pre-wrap',\n            fontFamily: 'monospace',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {/* Run Button */}\n      <div style={{ marginBottom: '1rem' }}>\n        <button\n          onClick={handleRun}\n          disabled={running}\n          style={{\n            padding: '0.75rem 1.5rem',\n            fontSize: '0.875rem',\n            fontWeight: '500',\n            backgroundColor: running ? '#9ca3af' : '#10b981',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: running ? 'not-allowed' : 'pointer',\n          }}\n        >\n          {running ? 'Running...' : 'Run VB6Exact (QUARTER)'}\n        </button>\n      </div>\n\n      {/* Results Summary */}\n      {result && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: 'var(--color-surface)',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n            Run Results\n          </h3>\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '1rem' }}>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>ET (s)</div>\n              <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{result.et_s.toFixed(3)}</div>\n            </div>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>MPH</div>\n              <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{result.mph.toFixed(2)}</div>\n            </div>\n            <div>\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>Model</div>\n              <div style={{ fontSize: '1rem', fontWeight: '500' }}>{result.meta.model}</div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Energy Breakdown */}\n      {energyData && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: 'var(--color-surface)',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\n            <h3 style={{ margin: 0, fontSize: '1rem', fontWeight: '600' }}>\n              Energy Breakdown\n            </h3>\n            <div style={{ display: 'flex', gap: '0.5rem' }}>\n              <button\n                onClick={handleExportJson}\n                style={{\n                  padding: '0.5rem 1rem',\n                  fontSize: '0.875rem',\n                  backgroundColor: '#6b7280',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: 'var(--radius-md)',\n                  cursor: 'pointer',\n                }}\n              >\n                Export JSON\n              </button>\n              <button\n                onClick={handleExportCsv}\n                style={{\n                  padding: '0.5rem 1rem',\n                  fontSize: '0.875rem',\n                  backgroundColor: '#6b7280',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: 'var(--radius-md)',\n                  cursor: 'pointer',\n                }}\n              >\n                Export CSV\n              </button>\n            </div>\n          </div>\n\n          {/* Energy Bars */}\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>\n            {/* Engine Input */}\n            <EnergyBar\n              label=\"Engine Input\"\n              value={energyData.engine_in_ftlbf}\n              percentage={100}\n              color=\"#10b981\"\n              isInput\n            />\n\n            {/* Losses */}\n            <EnergyBar\n              label=\"Drag Loss\"\n              value={energyData.drag_loss_ftlbf}\n              percentage={(energyData.drag_loss_ftlbf / energyData.engine_in_ftlbf) * 100}\n              color=\"#ef4444\"\n            />\n            <EnergyBar\n              label=\"Rolling Resistance\"\n              value={energyData.rolling_resistance_ftlbf}\n              percentage={(energyData.rolling_resistance_ftlbf / energyData.engine_in_ftlbf) * 100}\n              color=\"#f59e0b\"\n            />\n            <EnergyBar\n              label=\"Driveline Loss\"\n              value={energyData.driveline_loss_ftlbf}\n              percentage={(energyData.driveline_loss_ftlbf / energyData.engine_in_ftlbf) * 100}\n              color=\"#f59e0b\"\n            />\n            <EnergyBar\n              label=\"Engine PMI Loss\"\n              value={energyData.engine_pmi_loss_ftlbf}\n              percentage={(energyData.engine_pmi_loss_ftlbf / energyData.engine_in_ftlbf) * 100}\n              color=\"#f59e0b\"\n            />\n            <EnergyBar\n              label=\"Chassis PMI Loss\"\n              value={energyData.chassis_pmi_loss_ftlbf}\n              percentage={(energyData.chassis_pmi_loss_ftlbf / energyData.engine_in_ftlbf) * 100}\n              color=\"#f59e0b\"\n            />\n\n            {/* Final KE */}\n            <EnergyBar\n              label=\"Final Kinetic Energy\"\n              value={energyData.final_ke_ftlbf}\n              percentage={(energyData.final_ke_ftlbf / energyData.engine_in_ftlbf) * 100}\n              color=\"#3b82f6\"\n            />\n\n            {/* Balance */}\n            <EnergyBar\n              label=\"Balance (Error)\"\n              value={energyData.balance_ftlbf}\n              percentage={energyData.balance_pct}\n              color={Math.abs(energyData.balance_pct) < 1 ? '#10b981' : '#ef4444'}\n              showSign\n            />\n          </div>\n\n          {/* Summary Stats */}\n          <div\n            style={{\n              marginTop: '1.5rem',\n              padding: '1rem',\n              backgroundColor: '#1e293b',\n              borderRadius: 'var(--radius-md)',\n              color: '#e2e8f0',\n              fontFamily: 'monospace',\n              fontSize: '0.875rem',\n            }}\n          >\n            <div style={{ marginBottom: '0.5rem' }}>\n              <strong>Total Energy In:</strong> {energyData.engine_in_ftlbf.toLocaleString()} ft-lbf\n            </div>\n            <div style={{ marginBottom: '0.5rem' }}>\n              <strong>Total Losses:</strong>{' '}\n              {(\n                energyData.drag_loss_ftlbf +\n                energyData.rolling_resistance_ftlbf +\n                energyData.driveline_loss_ftlbf +\n                energyData.engine_pmi_loss_ftlbf +\n                energyData.chassis_pmi_loss_ftlbf\n              ).toLocaleString()}{' '}\n              ft-lbf\n            </div>\n            <div style={{ marginBottom: '0.5rem' }}>\n              <strong>Final KE:</strong> {energyData.final_ke_ftlbf.toLocaleString()} ft-lbf\n            </div>\n            <div>\n              <strong>Balance:</strong> {energyData.balance_ftlbf.toLocaleString()} ft-lbf (\n              {energyData.balance_pct.toFixed(2)}%)\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface EnergyBarProps {\n  label: string;\n  value: number;\n  percentage: number;\n  color: string;\n  isInput?: boolean;\n  showSign?: boolean;\n}\n\nfunction EnergyBar({ label, value, percentage, color, isInput, showSign }: EnergyBarProps) {\n  const displayValue = showSign && value >= 0 ? `+${value.toLocaleString()}` : value.toLocaleString();\n  const barWidth = Math.min(Math.abs(percentage), 100);\n\n  return (\n    <div>\n      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.25rem', fontSize: '0.875rem' }}>\n        <span style={{ fontWeight: isInput ? '600' : '400' }}>{label}</span>\n        <span style={{ fontFamily: 'monospace' }}>\n          {displayValue} ft-lbf ({percentage.toFixed(2)}%)\n        </span>\n      </div>\n      <div\n        style={{\n          width: '100%',\n          height: '24px',\n          backgroundColor: '#e5e7eb',\n          borderRadius: 'var(--radius-sm)',\n          overflow: 'hidden',\n        }}\n      >\n        <div\n          style={{\n            width: `${barWidth}%`,\n            height: '100%',\n            backgroundColor: color,\n            transition: 'width 0.3s ease',\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n","/**\n * Legacy RSA benchmarks from Quarter Pro / Quarter Jr.\n * Expected outputs from VB6 printouts for validation of RSACLASSIC model.\n * Tolerances start loose; tighten as the simulator matures.\n */\n\nexport type RaceLength = 'EIGHTH' | 'QUARTER';\n\n/**\n * Target performance for a specific race length.\n */\nexport interface RaceLengthTarget {\n  /** Expected elapsed time in seconds */\n  et_s: number;\n  /** Expected trap speed in mph */\n  mph: number;\n  /** Tolerance for ET in seconds (±) */\n  tolET_s: number;\n  /** Tolerance for MPH (±) */\n  tolMPH: number;\n  /** Optional sanity anchors for key splits (e.g., t60_s, t330_s) */\n  anchors?: Record<string, number>;\n}\n\n/**\n * Legacy benchmark from Quarter Pro or Quarter Jr.\n */\nexport interface LegacyBenchmark {\n  /** Benchmark name (vehicle/class identifier) */\n  name: string;\n  /** Source application */\n  source: 'QuarterPro' | 'QuarterJr';\n  /** Performance targets by race length */\n  raceLengthTargets: {\n    EIGHTH?: RaceLengthTarget;\n    QUARTER?: RaceLengthTarget;\n  };\n}\n\n/**\n * Legacy benchmarks from Quarter Pro / Quarter Jr printouts.\n * Values come from uploaded VB6 output files.\n * \n * NOTE: These represent the \"gold standard\" from the original VB6 applications.\n * RSACLASSIC should match these within specified tolerances.\n */\nexport const LEGACY_BENCHMARKS: LegacyBenchmark[] = [\n  {\n    name: 'SuperGas_Pro',\n    source: 'QuarterPro',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 6.27, mph: 108.2, tolET_s: 0.20, tolMPH: 3.0, anchors: { t60_s: 1.35 } },\n      QUARTER: { et_s: 9.90, mph: 135.1, tolET_s: 0.30, tolMPH: 4.0 },\n    },\n  },\n  {\n    name: 'TA_Dragster_Pro',\n    source: 'QuarterPro',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 3.56, mph: 205.3, tolET_s: 0.12, tolMPH: 5.0 },\n      QUARTER: { et_s: 5.52, mph: 243.1, tolET_s: 0.12, tolMPH: 6.0 },\n    },\n  },\n  {\n    name: 'ProStock_Pro',\n    source: 'QuarterPro',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 4.37, mph: 160.9, tolET_s: 0.12, tolMPH: 4.0, anchors: { t60_s: 1.01 } },\n      QUARTER: { et_s: 6.80, mph: 202.3, tolET_s: 0.15, tolMPH: 5.0 },\n    },\n  },\n  {\n    name: 'FunnyCar_Pro',\n    source: 'QuarterPro',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 3.37, mph: 243.5, tolET_s: 0.10, tolMPH: 6.0 },\n      QUARTER: { et_s: 4.98, mph: 297.0, tolET_s: 0.10, tolMPH: 7.0 },\n    },\n  },\n  {\n    name: 'Motorcycle_Pro',\n    source: 'QuarterPro',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 7.63, mph: 91.1, tolET_s: 0.25, tolMPH: 3.0 },\n      QUARTER: { et_s: 11.99, mph: 111.3, tolET_s: 0.30, tolMPH: 3.0 },\n    },\n  },\n  {\n    name: 'SuperComp_Pro',\n    source: 'QuarterPro',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 5.66, mph: 120.4, tolET_s: 0.18, tolMPH: 4.0 },\n      QUARTER: { et_s: 8.90, mph: 151.6, tolET_s: 0.20, tolMPH: 4.0 },\n    },\n  },\n  {\n    name: 'Motorcycle_Jr',\n    source: 'QuarterJr',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 7.45, mph: 89.4, tolET_s: 0.25, tolMPH: 3.0 },\n      QUARTER: { et_s: 12.00, mph: 104.5, tolET_s: 0.30, tolMPH: 3.0 },\n    },\n  },\n  {\n    name: 'ETRacer_Jr',\n    source: 'QuarterJr',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 8.60, mph: 80.3, tolET_s: 0.30, tolMPH: 3.0 },\n      QUARTER: { et_s: 13.50, mph: 100.8, tolET_s: 0.35, tolMPH: 3.5 },\n    },\n  },\n  {\n    name: 'EXP_Jr',\n    source: 'QuarterJr',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 5.15, mph: 130.3, tolET_s: 0.15, tolMPH: 4.0 },\n      QUARTER: { et_s: 8.18, mph: 160.2, tolET_s: 0.20, tolMPH: 4.0 },\n    },\n  },\n  {\n    name: 'EXP_050523_Jr',\n    source: 'QuarterJr',\n    raceLengthTargets: {\n      EIGHTH: { et_s: 5.06, mph: 132.5, tolET_s: 0.15, tolMPH: 4.0 },\n      QUARTER: { et_s: 8.04, mph: 163.5, tolET_s: 0.20, tolMPH: 4.0 },\n    },\n  },\n];\n\n/**\n * Get benchmark by name.\n * \n * @param name - Benchmark name\n * @returns Benchmark if found, undefined otherwise\n */\nexport function getBenchmark(name: string): LegacyBenchmark | undefined {\n  return LEGACY_BENCHMARKS.find((b) => b.name === name);\n}\n\n/**\n * Get all benchmarks from a specific source.\n * \n * @param source - Source application\n * @returns Array of benchmarks from that source\n */\nexport function getBenchmarksBySource(\n  source: 'QuarterPro' | 'QuarterJr'\n): LegacyBenchmark[] {\n  return LEGACY_BENCHMARKS.filter((b) => b.source === source);\n}\n\n/**\n * Validate simulation result against benchmark.\n * \n * @param benchmark - Benchmark to validate against\n * @param raceLength - Race length to check\n * @param et_s - Simulated elapsed time\n * @param mph - Simulated trap speed\n * @returns Validation result with pass/fail and deltas\n */\nexport function validateAgainstBenchmark(\n  benchmark: LegacyBenchmark,\n  raceLength: RaceLength,\n  et_s: number,\n  mph: number\n): {\n  pass: boolean;\n  etPass: boolean;\n  mphPass: boolean;\n  etDelta: number;\n  mphDelta: number;\n  etTolerance: number;\n  mphTolerance: number;\n} {\n  const target = benchmark.raceLengthTargets[raceLength];\n\n  if (!target) {\n    throw new Error(\n      `Benchmark ${benchmark.name} has no target for ${raceLength}`\n    );\n  }\n\n  const etDelta = et_s - target.et_s;\n  const mphDelta = mph - target.mph;\n\n  const etPass = Math.abs(etDelta) <= target.tolET_s;\n  const mphPass = Math.abs(mphDelta) <= target.tolMPH;\n\n  return {\n    pass: etPass && mphPass,\n    etPass,\n    mphPass,\n    etDelta,\n    mphDelta,\n    etTolerance: target.tolET_s,\n    mphTolerance: target.tolMPH,\n  };\n}\n","/**\n * Extended vehicle configurations for legacy benchmark validation.\n * Values pulled from Quarter Pro / Quarter Jr printouts.\n * \n * IMPORTANT: All required VB6 parameters must be present - NO DEFAULTS.\n * Use validateBenchmarkConfig() to ensure completeness.\n */\n\nimport { VB6_PROSTOCK_PRO } from './vb6-prostock-pro';\n\nexport type FuelType = 'GAS' | 'METHANOL' | 'NITRO';\n\nexport interface ExtendedVehicleConfig {\n  name: string;\n  fuel?: FuelType;\n  env: {\n    elevation: number;\n    barometerInHg: number;\n    temperatureF: number;\n    humidityPct: number;\n    windMph?: number;\n    windAngleDeg?: number;\n    trackTempF?: number;\n    tractionIndex?: number;\n  };\n  vehicle: {\n    // REQUIRED: Core vehicle parameters (no defaults allowed)\n    weightLb: number;\n    tireDiaIn?: number; // Either this OR tireRolloutIn required\n    tireRolloutIn?: number; // Either this OR tireDiaIn required\n    rolloutIn: number;\n    rearGear?: number; // Either this OR finalDrive required\n    finalDrive?: number; // Either this OR rearGear required\n    gearRatios: number[]; // [g1,g2,...] - REQUIRED\n    shiftRPM: number[]; // Per-gear upshift RPM - REQUIRED\n    \n    // REQUIRED: Aerodynamics (no defaults allowed)\n    frontalArea_ft2: number;\n    cd: number; // Drag coefficient\n    \n    // REQUIRED: Torque curve (no defaults allowed)\n    torqueCurve: { rpm: number; hp?: number; tq_lbft?: number }[];\n    \n    // OPTIONAL: Additional parameters\n    wheelbaseIn?: number;\n    overhangIn?: number;\n    tireWidthIn?: number;\n    liftCoeff?: number;\n    transEff?: number;\n    gearEff?: number[]; // Per-gear efficiency\n    rrCoeff?: number; // Rolling resistance coefficient\n\n    // OPTIONAL: Launch device (converter OR clutch)\n    converter?: {\n      launchRPM?: number;\n      stallRPM?: number;\n      slipRatio?: number; // e.g. 1.06\n      slippageFactor?: number; // VB6's gc_Slippage.Value\n      torqueMult?: number; // e.g. 1.70\n      lockup?: boolean;\n      diameterIn?: number;\n    };\n\n    clutch?: {\n      launchRPM?: number;\n      slipRPM?: number;\n      slipRatio?: number;\n      slippageFactor?: number; // VB6's gc_Slippage.Value (typically 1.002-1.01)\n      lockup?: boolean;\n    };\n\n    // OPTIONAL: Polar moments of inertia (VB6 printout values)\n    pmi?: {\n      engine_flywheel_clutch?: number; // slug-ft²\n      transmission_driveshaft?: number; // slug-ft²\n      tires_wheels_ringgear?: number; // slug-ft²\n    };\n\n    // OPTIONAL: Engine configuration\n    engine?: {\n      hpCurve?: { rpm: number; hp: number }[]; // HP-based curve (preferred)\n      fuelType?: string;\n      hpTorqueMultiplier?: number; // Applied to HP/torque calculations\n    };\n\n    powerHP?: number; // Deprecated - use torqueCurve instead\n  };\n}\n\n/**\n * Validate that a benchmark config has all required VB6 parameters.\n * Throws detailed error if any required fields are missing.\n * \n * This ensures VB6 parity by preventing silent defaults in the simulation.\n * All values must come from actual VB6 printouts.\n * \n * @param config - Benchmark config to validate\n * @throws Error with list of missing fields\n */\nexport function validateBenchmarkConfig(config: ExtendedVehicleConfig): void {\n  const missing: string[] = [];\n  \n  // Check required environment parameters (VB6 air density calculation)\n  if (config.env.elevation === undefined) missing.push('env.elevation');\n  if (config.env.barometerInHg === undefined) missing.push('env.barometerInHg');\n  if (config.env.temperatureF === undefined) missing.push('env.temperatureF');\n  if (config.env.humidityPct === undefined) missing.push('env.humidityPct');\n  \n  // Check required vehicle parameters\n  if (!config.vehicle.weightLb) missing.push('vehicle.weightLb');\n  if (!config.vehicle.tireDiaIn && !config.vehicle.tireRolloutIn) {\n    missing.push('vehicle.tireDiaIn OR vehicle.tireRolloutIn');\n  }\n  if (config.vehicle.rolloutIn === undefined) missing.push('vehicle.rolloutIn');\n  if (!config.vehicle.rearGear && !config.vehicle.finalDrive) {\n    missing.push('vehicle.rearGear OR vehicle.finalDrive');\n  }\n  if (!config.vehicle.gearRatios || config.vehicle.gearRatios.length === 0) {\n    missing.push('vehicle.gearRatios[]');\n  }\n  if (!config.vehicle.shiftRPM || config.vehicle.shiftRPM.length === 0) {\n    missing.push('vehicle.shiftRPM[]');\n  }\n  \n  // Check required aerodynamics (VB6 drag calculation)\n  if (config.vehicle.frontalArea_ft2 === undefined) missing.push('vehicle.frontalArea_ft2');\n  if (config.vehicle.cd === undefined) missing.push('vehicle.cd');\n  \n  // Check required rolling resistance (VB6 uses CMU = 0.025 if not specified)\n  // We allow this to be optional since VB6 has a default\n  \n  // Check required torque curve\n  if (!config.vehicle.torqueCurve || config.vehicle.torqueCurve.length === 0) {\n    missing.push('vehicle.torqueCurve[]');\n  } else {\n    // Validate torque curve has either hp or tq_lbft\n    const hasValidData = config.vehicle.torqueCurve.every(pt => \n      pt.rpm !== undefined && (pt.hp !== undefined || pt.tq_lbft !== undefined)\n    );\n    if (!hasValidData) {\n      missing.push('vehicle.torqueCurve[] must have rpm and (hp OR tq_lbft) for each point');\n    }\n  }\n  \n  // Validate converter parameters if present\n  if (config.vehicle.converter) {\n    if (config.vehicle.converter.stallRPM === undefined) {\n      missing.push('vehicle.converter.stallRPM (required if converter present)');\n    }\n    if (config.vehicle.converter.torqueMult === undefined) {\n      missing.push('vehicle.converter.torqueMult (required if converter present)');\n    }\n    if (config.vehicle.converter.slipRatio === undefined) {\n      missing.push('vehicle.converter.slipRatio (required if converter present)');\n    }\n  }\n  \n  // Validate clutch parameters if present\n  if (config.vehicle.clutch) {\n    if (config.vehicle.clutch.slipRPM === undefined && config.vehicle.clutch.launchRPM === undefined) {\n      missing.push('vehicle.clutch.slipRPM OR vehicle.clutch.launchRPM (required if clutch present)');\n    }\n    if (config.vehicle.clutch.slipRatio === undefined) {\n      missing.push('vehicle.clutch.slipRatio (required if clutch present)');\n    }\n  }\n  \n  // Validate gear ratios and shift RPM match\n  if (config.vehicle.gearRatios && config.vehicle.shiftRPM) {\n    const numGears = config.vehicle.gearRatios.length;\n    const numShifts = config.vehicle.shiftRPM.length;\n    // shiftRPM should have numGears-1 entries (no shift after last gear)\n    if (numShifts !== numGears - 1 && numShifts !== numGears) {\n      missing.push(`vehicle.shiftRPM[] length mismatch (${numShifts} shifts for ${numGears} gears)`);\n    }\n  }\n  \n  // Validate gear efficiency if present\n  if (config.vehicle.gearEff && config.vehicle.gearRatios) {\n    if (config.vehicle.gearEff.length !== config.vehicle.gearRatios.length) {\n      missing.push(`vehicle.gearEff[] length mismatch (${config.vehicle.gearEff.length} vs ${config.vehicle.gearRatios.length} gears)`);\n    }\n  }\n  \n  if (missing.length > 0) {\n    throw new Error(\n      `Benchmark config '${config.name}' is missing required VB6 parameters:\\n` +\n      missing.map(f => `  - ${f}`).join('\\n') +\n      `\\n\\nAll required fields must be present from VB6 printouts - NO DEFAULTS ALLOWED.` +\n      `\\nThis ensures VB6 parity by preventing silent defaults in the simulation.`\n    );\n  }\n}\n\n// NOTE: These configs are transcribed from your Quarter Pro / Jr sheets.\n// If any field says TODO, we'll fill from the exact row on the printout in the next pass.\n\nexport const BENCHMARK_CONFIGS: Record<string, ExtendedVehicleConfig> = {\n  // ===== QUARTER PRO CASES =====\n  ProStock_Pro: {\n    name: 'ProStock_Pro',\n    fuel: 'GAS',\n    env: {\n      elevation: 32,\n      barometerInHg: 29.92,\n      temperatureF: 75,\n      humidityPct: 55,\n      windMph: 5,\n      windAngleDeg: 135,\n      trackTempF: 105,\n      tractionIndex: 3,\n    },\n    vehicle: {\n      weightLb: 2355,\n      wheelbaseIn: 107,\n      overhangIn: 40,\n      rolloutIn: 9,\n      tireRolloutIn: 102.5,\n      tireWidthIn: 17.0,\n\n      frontalArea_ft2: 18.2,\n      cd: 0.24,\n      liftCoeff: 0.1,\n\n      finalDrive: 4.86,\n      transEff: 0.975,\n\n      gearRatios: [2.6, 1.9, 1.5, 1.2, 1.0],\n      gearEff: [0.99, 0.991, 0.992, 0.993, 0.994],\n      shiftRPM: [9400, 9400, 9400, 9400],\n\n      clutch: { launchRPM: 7200, slipRPM: 7600, slipRatio: 1.004, lockup: false },\n\n      // Full HP curve from Quarter Pro printout\n      torqueCurve: [\n        { rpm: 7000, hp: 1220 },\n        { rpm: 7200, hp: 1235 },\n        { rpm: 7400, hp: 1248 },\n        { rpm: 7600, hp: 1258 },\n        { rpm: 7800, hp: 1266 },\n        { rpm: 8000, hp: 1272 },\n        { rpm: 8200, hp: 1276 },\n        { rpm: 8400, hp: 1278 },\n        { rpm: 8600, hp: 1279 },\n        { rpm: 8800, hp: 1278 },\n        { rpm: 9000, hp: 1276 },\n        { rpm: 9200, hp: 1272 },\n        { rpm: 9400, hp: 1266 },\n        { rpm: 9500, hp: 1263 },\n      ],\n    },\n  },\n\n  FunnyCar_Pro: {\n    name: 'FunnyCar_Pro',\n    fuel: 'NITRO',\n    env: {\n      elevation: 300,\n      barometerInHg: 29.92,\n      temperatureF: 76,\n      humidityPct: 50,\n      windMph: 0,\n      trackTempF: 112,\n      tractionIndex: 1,\n    },\n    vehicle: {\n      weightLb: 2350,\n      wheelbaseIn: 125,\n      overhangIn: 40,\n      rolloutIn: 12,\n      tireRolloutIn: 118.0,\n      tireWidthIn: 18.0,\n\n      frontalArea_ft2: 24.1,\n      cd: 0.5,\n      liftCoeff: 0.8,\n\n      finalDrive: 3.2,\n      transEff: 0.96,\n\n      gearRatios: [1.0],\n      gearEff: [1.0],\n      shiftRPM: [100], // direct\n\n      clutch: { launchRPM: 6400, slipRPM: 6800, slippageFactor: 1.0068, lockup: false },\n\n      // PMI from VB6 printout (funnycar.dat)\n      pmi: {\n        engine_flywheel_clutch: 6.03,\n        transmission_driveshaft: 0.107,\n        tires_wheels_ringgear: 75.4,\n      },\n\n      // HP curve from VB6 printout (funnycar.dat) - peaks at 6800 RPM then drops\n      torqueCurve: [\n        { rpm: 6400, hp: 6116 },\n        { rpm: 6600, hp: 6276 },\n        { rpm: 6800, hp: 6306 },  // Peak HP\n        { rpm: 7000, hp: 6139 },\n        { rpm: 7200, hp: 5829 },\n        { rpm: 7400, hp: 5344 },\n        { rpm: 7600, hp: 4732 },\n        { rpm: 7800, hp: 3993 },\n        { rpm: 9000, hp: 1297 },\n        { rpm: 9250, hp: 1269 },\n        { rpm: 9500, hp: 1222 },\n      ],\n    },\n  },\n\n  TA_Dragster_Pro: {\n    name: 'TA_Dragster_Pro',\n    fuel: 'METHANOL',\n    env: {\n      elevation: 0,\n      barometerInHg: 29.92,\n      temperatureF: 77,\n      humidityPct: 45,\n      windMph: 0,\n      trackTempF: 110,\n      tractionIndex: 2,\n    },\n    vehicle: {\n      weightLb: 1980,\n      wheelbaseIn: 280,\n      overhangIn: 30,\n      rolloutIn: 12,\n      tireRolloutIn: 110.0,\n      tireWidthIn: 17.0,\n\n      frontalArea_ft2: 19.5,\n      cd: 0.58,\n      liftCoeff: 0.4,\n\n      finalDrive: 4.56,\n      transEff: 0.97,\n\n      gearRatios: [1.85, 1.3, 1.0],\n      gearEff: [0.97, 0.98, 0.99],\n      shiftRPM: [9200, 9400],\n\n      clutch: { launchRPM: 6000, slipRPM: 7200, slipRatio: 1.01, lockup: false },\n\n      // Full methanol HP curve from Quarter Pro printout\n      torqueCurve: [\n        { rpm: 6000, hp: 1800 },\n        { rpm: 6500, hp: 2000 },\n        { rpm: 7000, hp: 2180 },\n        { rpm: 7500, hp: 2340 },\n        { rpm: 8000, hp: 2480 },\n        { rpm: 8500, hp: 2600 },\n        { rpm: 9000, hp: 2700 },\n        { rpm: 9500, hp: 2780 },\n        { rpm: 10000, hp: 2840 },\n        { rpm: 10500, hp: 2880 },\n        { rpm: 11000, hp: 2900 },\n        { rpm: 11500, hp: 2900 },\n      ],\n    },\n  },\n\n  SuperComp_Pro: {\n    name: 'SuperComp_Pro',\n    fuel: 'GAS',\n    env: {\n      elevation: 600,\n      barometerInHg: 29.92,\n      temperatureF: 87,\n      humidityPct: 35,\n      windMph: 0,\n      trackTempF: 112,\n      tractionIndex: 5,\n    },\n    vehicle: {\n      weightLb: 1700,\n      wheelbaseIn: 225,\n      overhangIn: 30,\n      rolloutIn: 12,\n      tireDiaIn: 32.6,\n      tireWidthIn: 13.2,\n\n      frontalArea_ft2: 13.6,\n      cd: 0.5,\n      liftCoeff: 0.15,\n\n      finalDrive: 4.56,\n      transEff: 0.97,\n\n      gearRatios: [1.76, 1.0],\n      gearEff: [0.97, 0.99],\n      shiftRPM: [7500],\n\n      converter: {\n        launchRPM: 5000,\n        stallRPM: 5500,\n        slipRatio: 1.06,\n        torqueMult: 1.70,\n        lockup: false,\n        diameterIn: 10,\n      },\n\n      // Full HP curve from Quarter Pro printout\n      torqueCurve: [\n        { rpm: 3500, hp: 520 },\n        { rpm: 4000, hp: 560 },\n        { rpm: 4500, hp: 600 },\n        { rpm: 5000, hp: 640 },\n        { rpm: 5500, hp: 680 },\n        { rpm: 6000, hp: 715 },\n        { rpm: 6500, hp: 745 },\n        { rpm: 7000, hp: 770 },\n        { rpm: 7500, hp: 790 },\n        { rpm: 8000, hp: 805 },\n        { rpm: 8500, hp: 815 },\n        { rpm: 9000, hp: 820 },\n        { rpm: 9500, hp: 820 },\n        { rpm: 10000, hp: 815 },\n      ],\n    },\n  },\n\n  SuperGas_Pro: {\n    name: 'SuperGas_Pro',\n    fuel: 'GAS',\n    env: {\n      elevation: 850,\n      barometerInHg: 29.92,\n      temperatureF: 77,\n      humidityPct: 30,\n      windMph: 0,\n      trackTempF: 102,\n      tractionIndex: 5,\n    },\n    vehicle: {\n      weightLb: 2300,\n      wheelbaseIn: 103,\n      overhangIn: 30,\n      rolloutIn: 12,\n      tireDiaIn: 32.4,\n      tireWidthIn: 14.4,\n\n      frontalArea_ft2: 22.1,\n      cd: 0.4,\n      liftCoeff: 0.25,\n\n      finalDrive: 5.14,\n      transEff: 0.97,\n\n      gearRatios: [1.76, 1.0],\n      gearEff: [0.97, 0.99],\n      shiftRPM: [7600],\n\n      converter: {\n        launchRPM: 5000,\n        stallRPM: 5500,\n        slipRatio: 1.06,\n        torqueMult: 1.70,\n        lockup: false,\n        diameterIn: 10,\n      },\n\n      // Full HP curve from Quarter Pro printout\n      torqueCurve: [\n        { rpm: 3500, hp: 450 },\n        { rpm: 4000, hp: 490 },\n        { rpm: 4500, hp: 530 },\n        { rpm: 5000, hp: 565 },\n        { rpm: 5500, hp: 600 },\n        { rpm: 6000, hp: 630 },\n        { rpm: 6500, hp: 655 },\n        { rpm: 7000, hp: 675 },\n        { rpm: 7500, hp: 690 },\n        { rpm: 8000, hp: 700 },\n        { rpm: 8500, hp: 705 },\n        { rpm: 9000, hp: 705 },\n        { rpm: 9500, hp: 700 },\n      ],\n    },\n  },\n\n  Motorcycle_Pro: {\n    name: 'Motorcycle_Pro',\n    fuel: 'GAS',\n    env: {\n      elevation: 500,\n      barometerInHg: 29.92,\n      temperatureF: 75,\n      humidityPct: 50,\n      windMph: 0,\n      trackTempF: 100,\n      tractionIndex: 4,\n    },\n    vehicle: {\n      weightLb: 650,\n      wheelbaseIn: 54,\n      rolloutIn: 12,\n      tireDiaIn: 28.0,\n      tireWidthIn: 5.0,\n\n      frontalArea_ft2: 7.5,\n      cd: 0.55,\n      liftCoeff: 0.05,\n\n      finalDrive: 6.5,\n      transEff: 0.99,\n\n      gearRatios: [2.74, 1.96, 1.4, 1.0],\n      shiftRPM: [8000, 8000, 8000],\n\n      clutch: { launchRPM: 6000, slipRPM: 6000, slipRatio: 1.0, lockup: true },\n\n      // Full HP curve from Quarter Pro printout\n      torqueCurve: [\n        { rpm: 5000, hp: 60 },\n        { rpm: 5500, hp: 64 },\n        { rpm: 6000, hp: 68 },\n        { rpm: 6500, hp: 71 },\n        { rpm: 7000, hp: 73 },\n        { rpm: 7200, hp: 74 },\n        { rpm: 7500, hp: 74 },\n        { rpm: 8000, hp: 73 },\n        { rpm: 8500, hp: 71 },\n      ],\n    },\n  },\n\n  // ===== QUARTER JR CASES =====\n\n  Motorcycle_Jr: {\n    name: 'Motorcycle_Jr',\n    fuel: 'GAS',\n    env: {\n      elevation: 900,\n      barometerInHg: 29.92,\n      temperatureF: 74,\n      humidityPct: 40,\n      tractionIndex: 4,\n    },\n    vehicle: {\n      weightLb: 730,\n      wheelbaseIn: 54,\n      rolloutIn: 12,\n      tireDiaIn: 28.0,\n      tireWidthIn: 5.0,\n\n      frontalArea_ft2: 7.9,\n      cd: 0.55, // worksheet effective; adjust if exact differs\n      liftCoeff: 0.05,\n\n      finalDrive: 6.81,\n      transEff: 0.99,\n\n      gearRatios: [2.74, 1.96, 1.4, 1.0],\n      shiftRPM: [8000, 8000, 8000],\n\n      clutch: { launchRPM: 6000, slipRPM: 6000, slipRatio: 1.0, lockup: true },\n\n      // Full HP curve from Quarter Jr printout\n      torqueCurve: [\n        { rpm: 5000, hp: 62 },\n        { rpm: 5500, hp: 68 },\n        { rpm: 6000, hp: 73 },\n        { rpm: 6500, hp: 77 },\n        { rpm: 7000, hp: 80 },\n        { rpm: 7200, hp: 81 },\n        { rpm: 7500, hp: 81 },\n        { rpm: 8000, hp: 80 },\n        { rpm: 8500, hp: 78 },\n      ],\n    },\n  },\n\n  ETRacer_Jr: {\n    name: 'ETRacer_Jr',\n    fuel: 'GAS',\n    env: {\n      elevation: 680,\n      barometerInHg: 29.92,\n      temperatureF: 86,\n      humidityPct: 60,\n      tractionIndex: 5,\n    },\n    vehicle: {\n      weightLb: 3600,\n      wheelbaseIn: 108,\n      rolloutIn: 14,\n      tireDiaIn: 28.0,\n      tireWidthIn: 10.0,\n\n      frontalArea_ft2: 26.1,\n      cd: 0.45,\n      liftCoeff: 0.2,\n\n      finalDrive: 4.11,\n      transEff: 0.97,\n\n      gearRatios: [2.48, 1.48, 1.0],\n      shiftRPM: [6000, 6000],\n\n      converter: {\n        launchRPM: 2500,\n        stallRPM: 3000,\n        lockup: false,\n        diameterIn: 10,\n        slipRatio: 1.05,\n        torqueMult: 1.60,\n      },\n\n      powerHP: 325,\n      // Full HP curve from Quarter Jr printout\n      torqueCurve: [\n        { rpm: 3000, hp: 220 },\n        { rpm: 3500, hp: 250 },\n        { rpm: 4000, hp: 275 },\n        { rpm: 4500, hp: 295 },\n        { rpm: 5000, hp: 310 },\n        { rpm: 5500, hp: 322 },\n        { rpm: 5600, hp: 325 },\n        { rpm: 6000, hp: 325 },\n        { rpm: 6500, hp: 320 },\n      ],\n    },\n  },\n\n  EXP_Jr: {\n    name: 'EXP_Jr',\n    fuel: 'GAS',\n    env: {\n      elevation: 400,\n      barometerInHg: 29.92,\n      temperatureF: 80,\n      humidityPct: 45,\n      tractionIndex: 4,\n    },\n    vehicle: {\n      weightLb: 2100,\n      wheelbaseIn: 180,\n      rolloutIn: 12,\n      tireDiaIn: 30.0,\n      tireWidthIn: 12.0,\n\n      frontalArea_ft2: 15.5,\n      cd: 0.48,\n      liftCoeff: 0.18,\n\n      finalDrive: 4.3,\n      transEff: 0.97,\n\n      gearRatios: [1.8, 1.3, 1.0],\n      shiftRPM: [7800, 8000],\n\n      clutch: { launchRPM: 5500, slipRPM: 6000, slipRatio: 1.005, lockup: false },\n\n      // Full HP curve from Quarter Jr printout\n      torqueCurve: [\n        { rpm: 5000, hp: 750 },\n        { rpm: 5500, hp: 810 },\n        { rpm: 6000, hp: 860 },\n        { rpm: 6500, hp: 900 },\n        { rpm: 7000, hp: 930 },\n        { rpm: 7500, hp: 950 },\n        { rpm: 8000, hp: 960 },\n        { rpm: 8500, hp: 960 },\n        { rpm: 9000, hp: 950 },\n      ],\n    },\n  },\n\n  EXP_050523_Jr: {\n    name: 'EXP_050523_Jr',\n    fuel: 'GAS',\n    env: {\n      elevation: 420,\n      barometerInHg: 29.92,\n      temperatureF: 78,\n      humidityPct: 48,\n      tractionIndex: 4,\n    },\n    vehicle: {\n      weightLb: 2080,\n      wheelbaseIn: 180,\n      rolloutIn: 12,\n      tireDiaIn: 30.5,\n      tireWidthIn: 12.5,\n\n      frontalArea_ft2: 15.2,\n      cd: 0.46,\n      liftCoeff: 0.16,\n\n      finalDrive: 4.25,\n      transEff: 0.975,\n\n      gearRatios: [1.82, 1.32, 1.0],\n      shiftRPM: [7900, 8100],\n\n      clutch: { launchRPM: 5600, slipRPM: 6100, slipRatio: 1.004, lockup: false },\n\n      // Full HP curve from Quarter Jr printout\n      torqueCurve: [\n        { rpm: 5000, hp: 770 },\n        { rpm: 5500, hp: 830 },\n        { rpm: 6000, hp: 880 },\n        { rpm: 6500, hp: 920 },\n        { rpm: 7000, hp: 955 },\n        { rpm: 7500, hp: 980 },\n        { rpm: 8000, hp: 995 },\n        { rpm: 8500, hp: 1000 },\n        { rpm: 9000, hp: 995 },\n      ],\n    },\n  },\n};\n\n// Apply VB6 overrides for ProStock_Pro from exact printout values\n(() => {\n  const bm = BENCHMARK_CONFIGS['ProStock_Pro'];\n  if (!bm) return;\n  \n  const vb = VB6_PROSTOCK_PRO;\n  const v = bm.vehicle;\n\n  // Mass & geometry\n  v.weightLb = vb.vehicle.weight_lb;\n  v.wheelbaseIn = vb.vehicle.wheelbase_in;\n  v.overhangIn = vb.vehicle.overhang_in ?? v.overhangIn;\n  v.rolloutIn = vb.vehicle.rollout_in ?? v.rolloutIn;\n\n  // Tires (diameter -> rollout)\n  v.tireDiaIn = vb.vehicle.tire.diameter_in;\n  v.tireRolloutIn = vb.vehicle.tire.diameter_in * Math.PI;\n  v.tireWidthIn = vb.vehicle.tire.width_in;\n\n  // Aero\n  v.frontalArea_ft2 = vb.aero.frontalArea_ft2;\n  v.cd = vb.aero.Cd;\n  v.liftCoeff = vb.aero.Cl ?? v.liftCoeff;\n\n  // Drivetrain\n  v.finalDrive = vb.drivetrain.finalDrive;\n  v.transEff = vb.drivetrain.overallEfficiency;\n  v.gearRatios = [ ...vb.drivetrain.gearRatios ];\n  v.gearEff = [ ...vb.drivetrain.perGearEff ];\n  v.shiftRPM = [ ...vb.drivetrain.shiftsRPM ];\n  v.clutch = {\n    launchRPM: vb.drivetrain.clutch.launchRPM,\n    slipRPM: vb.drivetrain.clutch.slipRPM,\n    slipRatio: vb.drivetrain.clutch.slippageFactor,\n    lockup: vb.drivetrain.clutch.lockup,\n  };\n\n  // PMIs (VB6 printout values)\n  v.pmi = {\n    engine_flywheel_clutch: vb.pmi.engine_flywheel_clutch,\n    transmission_driveshaft: vb.pmi.transmission_driveshaft,\n    tires_wheels_ringgear: vb.pmi.tires_wheels_ringgear,\n  };\n\n  // Engine dyno (HP curve - preferred over torqueCurve)\n  v.engine = {\n    hpCurve: vb.engineHP.map(([rpm, hp]) => ({ rpm, hp })),\n    fuelType: vb.fuel.type,\n    hpTorqueMultiplier: vb.fuel.hpTorqueMultiplier,\n  };\n\n  // Test-time environment overrides\n  bm.env.elevation = vb.env.elevation_ft;\n  bm.env.barometerInHg = vb.env.barometer_inHg;\n  bm.env.temperatureF = vb.env.temperature_F;\n  bm.env.humidityPct = vb.env.relHumidity_pct;\n  bm.env.windMph = vb.env.wind_mph;\n  bm.env.windAngleDeg = vb.env.wind_angle_deg;\n  bm.env.trackTempF = vb.env.trackTemp_F;\n  bm.env.tractionIndex = vb.env.tractionIndex;\n})();\n","/**\n * Input Inspector Panel\n * \n * Visualize and compare VB6 fixtures and simulation inputs.\n * Inspect, validate, and diff fixtures without altering values.\n */\n\nimport { useState } from 'react';\nimport { useVb6Fixture } from '../../shared/state/vb6FixtureStore';\nimport { assertComplete, Vb6FixtureValidationError, type Vb6VehicleFixture } from '../../domain/physics/vb6/fixtures';\nimport { buildInputFromUiFixture, type SimulationInput } from '../../domain/physics/vb6/uiMapper';\nimport { VB6_PROSTOCK_PRO } from '../../domain/physics/fixtures/vb6-prostock-pro';\nimport { LEGACY_BENCHMARKS } from '../../domain/physics/fixtures/benchmarks';\nimport { BENCHMARK_CONFIGS } from '../../domain/physics/fixtures/benchmark-configs';\n\n// Available code fixtures for comparison\nconst CODE_FIXTURES = {\n  ProStock_Pro: VB6_PROSTOCK_PRO,\n};\n\ntype FixtureName = keyof typeof CODE_FIXTURES;\n\n/**\n * Map a benchmark config to VB6 UI fixture shape.\n * No math, just structural mapping.\n */\nfunction mapBenchmarkToVB6Fixture(benchmarkName: string): Partial<Vb6VehicleFixture> {\n  const config = BENCHMARK_CONFIGS[benchmarkName];\n  if (!config) {\n    throw new Error(`Benchmark config not found: ${benchmarkName}`);\n  }\n\n  const fixture: Partial<Vb6VehicleFixture> = {\n    env: {\n      elevation_ft: config.env.elevation,\n      barometer_inHg: config.env.barometerInHg,\n      temperature_F: config.env.temperatureF,\n      relHumidity_pct: config.env.humidityPct,\n      wind_mph: config.env.windMph ?? 0,\n      wind_angle_deg: config.env.windAngleDeg ?? 0,\n      trackTemp_F: config.env.trackTempF ?? config.env.temperatureF,\n      tractionIndex: config.env.tractionIndex ?? 1.0,\n    },\n    vehicle: {\n      weight_lb: config.vehicle.weightLb,\n      wheelbase_in: config.vehicle.wheelbaseIn ?? 100,\n      overhang_in: config.vehicle.overhangIn ?? 40,\n      rollout_in: config.vehicle.rolloutIn,\n      staticFrontWeight_lb: config.vehicle.weightLb * 0.38, // Default 38% front\n      cgHeight_in: (config.vehicle.tireDiaIn ?? 32) / 2 + 3.75, // VB6 default\n      bodyStyle: 1, // Car\n      tire: {\n        diameter_in: config.vehicle.tireDiaIn ?? (config.vehicle.tireRolloutIn ?? 100) / Math.PI,\n        width_in: config.vehicle.tireWidthIn ?? 10,\n      },\n    },\n    aero: {\n      frontalArea_ft2: config.vehicle.frontalArea_ft2,\n      Cd: config.vehicle.cd,\n      Cl: config.vehicle.liftCoeff ?? 0,\n    },\n    drivetrain: {\n      finalDrive: config.vehicle.finalDrive ?? config.vehicle.rearGear ?? 3.0,\n      overallEfficiency: config.vehicle.transEff ?? 0.95,\n      gearRatios: config.vehicle.gearRatios ?? [1.0],\n      perGearEff: config.vehicle.gearEff ?? [0.95],\n      shiftsRPM: config.vehicle.shiftRPM ?? [7000],\n      clutch: config.vehicle.clutch ? {\n        launchRPM: config.vehicle.clutch.launchRPM ?? 3000,\n        slipRPM: config.vehicle.clutch.slipRPM ?? 3500,\n        slippageFactor: config.vehicle.clutch.slipRatio ?? 0.1,\n        lockup: config.vehicle.clutch.lockup ?? false,\n      } : undefined,\n      converter: config.vehicle.converter ? {\n        stallRPM: config.vehicle.converter.stallRPM ?? 2500,\n        torqueMult: config.vehicle.converter.torqueMult ?? 2.0,\n        slippageFactor: config.vehicle.converter.slipRatio ?? 0.1,\n        lockup: config.vehicle.converter.lockup ?? false,\n      } : undefined,\n    },\n    pmi: {\n      engine_flywheel_clutch: 0.5, // Default placeholder\n      transmission_driveshaft: 0.2, // Default placeholder\n      tires_wheels_ringgear: 0.3, // Default placeholder\n    },\n    engineHP: config.vehicle.torqueCurve?.map(p => [p.rpm, p.hp ?? 0] as [number, number]) ?? [],\n    fuel: {\n      type: config.fuel ?? 'GAS',\n      hpTorqueMultiplier: 1.0,\n    },\n  };\n\n  return fixture;\n}\n\nexport default function InputInspector() {\n  const { fixture, setFixture } = useVb6Fixture();\n  const [fixtureJson, setFixtureJson] = useState(JSON.stringify(fixture, null, 2));\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const [simulationInput, setSimulationInput] = useState<SimulationInput | null>(null);\n  const [selectedFixture, setSelectedFixture] = useState<FixtureName>('ProStock_Pro');\n  const [selectedBenchmark, setSelectedBenchmark] = useState<string>('ProStock_Pro');\n  const [diffResult, setDiffResult] = useState<string | null>(null);\n\n  const handleValidate = () => {\n    try {\n      const parsed = JSON.parse(fixtureJson);\n      assertComplete(parsed);\n      setValidationError(null);\n      alert('✓ Fixture is valid and complete!');\n    } catch (err) {\n      if (err instanceof Vb6FixtureValidationError) {\n        setValidationError(err.message);\n      } else if (err instanceof SyntaxError) {\n        setValidationError(`JSON Syntax Error: ${err.message}`);\n      } else {\n        setValidationError(err instanceof Error ? err.message : String(err));\n      }\n    }\n  };\n\n  const handleApplyToUi = () => {\n    try {\n      const parsed = JSON.parse(fixtureJson);\n      setFixture(parsed);\n      setValidationError(null);\n      alert('✓ Applied to UI fixture store!');\n    } catch (err) {\n      if (err instanceof SyntaxError) {\n        setValidationError(`JSON Syntax Error: ${err.message}`);\n      } else {\n        setValidationError(err instanceof Error ? err.message : String(err));\n      }\n    }\n  };\n\n  const handleBuildInput = () => {\n    try {\n      const parsed = JSON.parse(fixtureJson);\n      assertComplete(parsed);\n      const input = buildInputFromUiFixture(parsed);\n      setSimulationInput(input);\n      setValidationError(null);\n    } catch (err) {\n      if (err instanceof Vb6FixtureValidationError) {\n        setValidationError(err.message);\n        setSimulationInput(null);\n      } else if (err instanceof SyntaxError) {\n        setValidationError(`JSON Syntax Error: ${err.message}`);\n      } else {\n        setValidationError(err instanceof Error ? err.message : String(err));\n      }\n    }\n  };\n\n  const handleCopyInput = () => {\n    if (simulationInput) {\n      navigator.clipboard.writeText(JSON.stringify(simulationInput, null, 2));\n      alert('✓ Copied simulation input to clipboard!');\n    }\n  };\n\n  const handleDiff = () => {\n    try {\n      const currentFixture = JSON.parse(fixtureJson);\n      const codeFixture = CODE_FIXTURES[selectedFixture];\n      \n      const diff = computeDiff(currentFixture, codeFixture, '');\n      setDiffResult(diff.length > 0 ? diff.join('\\n') : 'No differences found');\n    } catch (err) {\n      setDiffResult(`Error: ${err instanceof Error ? err.message : String(err)}`);\n    }\n  };\n\n  const handlePopulateFromBenchmark = () => {\n    try {\n      const mappedFixture = mapBenchmarkToVB6Fixture(selectedBenchmark);\n      const json = JSON.stringify(mappedFixture, null, 2);\n      setFixtureJson(json);\n      setFixture(mappedFixture);\n      setValidationError(null);\n      alert(`✓ Populated from benchmark: ${selectedBenchmark}`);\n    } catch (err) {\n      setValidationError(err instanceof Error ? err.message : String(err));\n    }\n  };\n\n  return (\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Input Inspector (VB6)</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Visualize, validate, and compare VB6 fixtures and simulation inputs.\n        </p>\n      </div>\n\n      {/* Validation Error */}\n      {validationError && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            whiteSpace: 'pre-wrap',\n            fontFamily: 'monospace',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {validationError}\n        </div>\n      )}\n\n      {/* Benchmark Loader */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          Load from Benchmark\n        </h3>\n        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>\n          <select\n            value={selectedBenchmark}\n            onChange={(e) => setSelectedBenchmark(e.target.value)}\n            style={{\n              flex: 1,\n              padding: '0.5rem',\n              fontSize: '0.875rem',\n              border: '1px solid var(--color-border)',\n              borderRadius: 'var(--radius-md)',\n              backgroundColor: 'var(--color-bg)',\n            }}\n          >\n            {LEGACY_BENCHMARKS.map((bm) => (\n              <option key={bm.name} value={bm.name}>\n                {bm.name} ({bm.source})\n              </option>\n            ))}\n          </select>\n          <button\n            onClick={handlePopulateFromBenchmark}\n            style={{\n              padding: '0.5rem 1rem',\n              fontSize: '0.875rem',\n              backgroundColor: '#8b5cf6',\n              color: 'white',\n              border: 'none',\n              borderRadius: 'var(--radius-md)',\n              cursor: 'pointer',\n              whiteSpace: 'nowrap',\n            }}\n          >\n            Populate from Benchmark\n          </button>\n        </div>\n      </div>\n\n      {/* Two Column Layout */}\n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem', marginBottom: '1rem' }}>\n        {/* Column A: VB6 UI Fixture Editor */}\n        <div>\n          <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n            (A) VB6 UI Fixture (Editable)\n          </h3>\n          <textarea\n            value={fixtureJson}\n            onChange={(e) => setFixtureJson(e.target.value)}\n            style={{\n              width: '100%',\n              height: '400px',\n              padding: '0.75rem',\n              fontFamily: 'monospace',\n              fontSize: '0.75rem',\n              backgroundColor: '#1e293b',\n              color: '#e2e8f0',\n              border: '1px solid var(--color-border)',\n              borderRadius: 'var(--radius-md)',\n              resize: 'vertical',\n            }}\n          />\n          <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.5rem' }}>\n            <button\n              onClick={handleValidate}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#3b82f6',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Validate\n            </button>\n            <button\n              onClick={handleApplyToUi}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#10b981',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Apply to UI\n            </button>\n          </div>\n        </div>\n\n        {/* Column B: Computed Simulation Input */}\n        <div>\n          <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n            (B) Simulation Input (Readonly)\n          </h3>\n          <pre\n            style={{\n              width: '100%',\n              height: '400px',\n              padding: '0.75rem',\n              fontFamily: 'monospace',\n              fontSize: '0.75rem',\n              backgroundColor: '#1e293b',\n              color: '#e2e8f0',\n              border: '1px solid var(--color-border)',\n              borderRadius: 'var(--radius-md)',\n              overflow: 'auto',\n              margin: 0,\n            }}\n          >\n            {simulationInput ? JSON.stringify(simulationInput, null, 2) : '// Click \"Build Input From UI\" to generate'}\n          </pre>\n          <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.5rem' }}>\n            <button\n              onClick={handleBuildInput}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#8b5cf6',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Build Input From UI\n            </button>\n            <button\n              onClick={handleCopyInput}\n              disabled={!simulationInput}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: simulationInput ? '#6b7280' : '#d1d5db',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: simulationInput ? 'pointer' : 'not-allowed',\n              }}\n            >\n              Copy Input JSON\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Diff Section */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          Diff vs Code Fixture\n        </h3>\n        <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.75rem', alignItems: 'center' }}>\n          <label style={{ fontSize: '0.875rem', fontWeight: '500' }}>\n            Compare against:\n          </label>\n          <select\n            value={selectedFixture}\n            onChange={(e) => setSelectedFixture(e.target.value as FixtureName)}\n            style={{\n              padding: '0.5rem',\n              fontSize: '0.875rem',\n              border: '1px solid var(--color-border)',\n              borderRadius: 'var(--radius-md)',\n              backgroundColor: 'var(--color-bg)',\n            }}\n          >\n            {Object.keys(CODE_FIXTURES).map((name) => (\n              <option key={name} value={name}>\n                {name}\n              </option>\n            ))}\n          </select>\n          <button\n            onClick={handleDiff}\n            style={{\n              padding: '0.5rem 1rem',\n              fontSize: '0.875rem',\n              backgroundColor: '#f59e0b',\n              color: 'white',\n              border: 'none',\n              borderRadius: 'var(--radius-md)',\n              cursor: 'pointer',\n            }}\n          >\n            Diff vs Fixture\n          </button>\n        </div>\n        {diffResult && (\n          <pre\n            style={{\n              padding: '0.75rem',\n              backgroundColor: '#1e293b',\n              color: '#e2e8f0',\n              borderRadius: 'var(--radius-sm)',\n              fontSize: '0.75rem',\n              overflow: 'auto',\n              margin: 0,\n              maxHeight: '300px',\n              whiteSpace: 'pre-wrap',\n            }}\n          >\n            {diffResult}\n          </pre>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/**\n * Simple diff computation for nested objects\n * Returns array of diff lines showing added/removed/changed paths\n */\nfunction computeDiff(current: any, reference: any, path: string): string[] {\n  const diffs: string[] = [];\n\n  // Check all keys in reference\n  for (const key in reference) {\n    const currentPath = path ? `${path}.${key}` : key;\n    \n    if (!(key in current)) {\n      diffs.push(`- MISSING: ${currentPath}`);\n    } else if (typeof reference[key] === 'object' && reference[key] !== null && !Array.isArray(reference[key])) {\n      // Recurse for nested objects\n      diffs.push(...computeDiff(current[key], reference[key], currentPath));\n    } else if (JSON.stringify(current[key]) !== JSON.stringify(reference[key])) {\n      diffs.push(`~ CHANGED: ${currentPath}`);\n      diffs.push(`  Reference: ${JSON.stringify(reference[key])}`);\n      diffs.push(`  Current:   ${JSON.stringify(current[key])}`);\n    }\n  }\n\n  // Check for added keys in current\n  for (const key in current) {\n    if (!(key in reference)) {\n      const currentPath = path ? `${path}.${key}` : key;\n      diffs.push(`+ ADDED: ${currentPath} = ${JSON.stringify(current[key])}`);\n    }\n  }\n\n  return diffs;\n}\n","/**\n * Quick Paste Panel (Dyno & PMI)\n * \n * Quickly paste dyno tables and PMI values into VB6 fixtures.\n * Supports local profile saving/loading.\n */\n\nimport { useState, useEffect, startTransition } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { useVb6Fixture } from '../../shared/state/vb6FixtureStore';\nimport { assertComplete, Vb6FixtureValidationError } from '../../domain/physics/vb6/fixtures';\nimport { validateVB6Fixture } from '../validation/vb6Fixture';\n\ninterface SavedProfile {\n  name: string;\n  timestamp: number;\n  fixture: any;\n}\n\nconst PROFILES_STORAGE_KEY = 'rsa.quickpaste.profiles.v1';\n\nexport default function QuickPaste() {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const { fixture, setFixture } = useVb6Fixture();\n  \n  const [dynoText, setDynoText] = useState('');\n  const [dynoPreview, setDynoPreview] = useState<Array<{ rpm: number; hp: number }>>([]);\n  const [dynoError, setDynoError] = useState<string | null>(null);\n  \n  const [pmiEngine, setPmiEngine] = useState('');\n  const [pmiChassis, setPmiChassis] = useState('');\n  const [gearEff, setGearEff] = useState('');\n  const [pmiError, setPmiError] = useState<string | null>(null);\n  \n  const [profiles, setProfiles] = useState<SavedProfile[]>([]);\n  const [selectedProfile, setSelectedProfile] = useState<string>('');\n  const [newProfileName, setNewProfileName] = useState('');\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  // Load profiles from localStorage\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(PROFILES_STORAGE_KEY);\n      if (stored) {\n        setProfiles(JSON.parse(stored));\n      }\n    } catch (err) {\n      console.error('Failed to load profiles:', err);\n    }\n  }, []);\n\n  const saveProfiles = (newProfiles: SavedProfile[]) => {\n    try {\n      localStorage.setItem(PROFILES_STORAGE_KEY, JSON.stringify(newProfiles));\n      setProfiles(newProfiles);\n    } catch (err) {\n      console.error('Failed to save profiles:', err);\n    }\n  };\n\n  const parseDynoTable = (text: string): Array<{ rpm: number; hp: number }> => {\n    const lines = text.trim().split('\\n');\n    const parsed: Array<{ rpm: number; hp: number }> = [];\n\n    for (const line of lines) {\n      const trimmed = line.trim();\n      if (!trimmed) continue;\n\n      // Support both space and comma delimiters\n      const parts = trimmed.split(/[\\s,]+/);\n      if (parts.length < 2) {\n        throw new Error(`Invalid line: \"${line}\" - expected \"RPM HP\" or \"RPM,HP\"`);\n      }\n\n      const rpm = parseFloat(parts[0]);\n      const hp = parseFloat(parts[1]);\n\n      if (isNaN(rpm) || isNaN(hp)) {\n        throw new Error(`Invalid numbers in line: \"${line}\"`);\n      }\n\n      parsed.push({ rpm, hp });\n    }\n\n    if (parsed.length === 0) {\n      throw new Error('No valid dyno data found');\n    }\n\n    // Sort by RPM\n    parsed.sort((a, b) => a.rpm - b.rpm);\n\n    return parsed;\n  };\n\n  const handleDynoPreview = () => {\n    try {\n      const parsed = parseDynoTable(dynoText);\n      setDynoPreview(parsed);\n      setDynoError(null);\n    } catch (err) {\n      setDynoError(err instanceof Error ? err.message : String(err));\n      setDynoPreview([]);\n    }\n  };\n\n  const handleApplyDyno = () => {\n    try {\n      const parsed = parseDynoTable(dynoText);\n      \n      // Update fixture with dyno data (engineHP field)\n      setFixture({\n        ...fixture,\n        engineHP: parsed.map(p => [p.rpm, p.hp] as [number, number]),\n      });\n\n      setDynoError(null);\n      alert(`✓ Applied ${parsed.length} dyno points to VB6 UI Fixture!`);\n    } catch (err) {\n      setDynoError(err instanceof Error ? err.message : String(err));\n    }\n  };\n\n  const handleApplyPMI = () => {\n    try {\n      setPmiError(null);\n\n      const pmiUpdates: any = {};\n      const drivetrainUpdates: any = {};\n\n      // Parse PMI Engine\n      if (pmiEngine.trim()) {\n        const val = parseFloat(pmiEngine);\n        if (isNaN(val)) {\n          throw new Error('Invalid PMI Engine value');\n        }\n        pmiUpdates.engine_flywheel_clutch = val;\n      }\n\n      // Parse PMI Chassis\n      if (pmiChassis.trim()) {\n        const val = parseFloat(pmiChassis);\n        if (isNaN(val)) {\n          throw new Error('Invalid PMI Chassis value');\n        }\n        pmiUpdates.tires_wheels_ringgear = val;\n      }\n\n      // Parse Gear Efficiencies (comma-separated array)\n      if (gearEff.trim()) {\n        const parts = gearEff.split(',').map(s => s.trim());\n        const effArray: number[] = [];\n        \n        for (const part of parts) {\n          const val = parseFloat(part);\n          if (isNaN(val)) {\n            throw new Error(`Invalid gear efficiency value: \"${part}\"`);\n          }\n          effArray.push(val);\n        }\n        \n        drivetrainUpdates.perGearEff = effArray;\n      }\n\n      if (Object.keys(pmiUpdates).length === 0 && Object.keys(drivetrainUpdates).length === 0) {\n        setPmiError('No values to apply');\n        return;\n      }\n\n      // Update fixture\n      const updates: any = { ...fixture };\n      \n      if (Object.keys(pmiUpdates).length > 0) {\n        updates.pmi = {\n          ...fixture.pmi,\n          ...pmiUpdates,\n        };\n      }\n      \n      if (Object.keys(drivetrainUpdates).length > 0) {\n        updates.drivetrain = {\n          ...fixture.drivetrain,\n          ...drivetrainUpdates,\n        };\n      }\n      \n      setFixture(updates);\n\n      alert('✓ Applied PMI values to VB6 UI Fixture!');\n    } catch (err) {\n      setPmiError(err instanceof Error ? err.message : String(err));\n    }\n  };\n\n  const handleSaveProfile = () => {\n    if (!newProfileName.trim()) {\n      alert('Please enter a profile name');\n      return;\n    }\n\n    const newProfile: SavedProfile = {\n      name: newProfileName.trim(),\n      timestamp: Date.now(),\n      fixture: JSON.parse(JSON.stringify(fixture)), // Deep clone\n    };\n\n    const updated = [...profiles, newProfile];\n    saveProfiles(updated);\n    setNewProfileName('');\n    alert(`✓ Saved profile \"${newProfile.name}\"`);\n  };\n\n  const handleLoadProfile = () => {\n    if (!selectedProfile) {\n      alert('Please select a profile');\n      return;\n    }\n\n    const profile = profiles.find(p => p.name === selectedProfile);\n    if (!profile) {\n      alert('Profile not found');\n      return;\n    }\n\n    setFixture(profile.fixture);\n    alert(`✓ Loaded profile \"${profile.name}\"`);\n  };\n\n  const handleDeleteProfile = () => {\n    if (!selectedProfile) {\n      alert('Please select a profile');\n      return;\n    }\n\n    if (!confirm(`Delete profile \"${selectedProfile}\"?`)) {\n      return;\n    }\n\n    const updated = profiles.filter(p => p.name !== selectedProfile);\n    saveProfiles(updated);\n    setSelectedProfile('');\n  };\n\n  const handleValidate = () => {\n    try {\n      assertComplete(fixture);\n      setValidationError(null);\n      alert('✓ Fixture is complete and valid!');\n    } catch (err) {\n      if (err instanceof Vb6FixtureValidationError) {\n        setValidationError(err.message);\n      } else {\n        setValidationError(err instanceof Error ? err.message : String(err));\n      }\n    }\n  };\n\n  const handleLoadProStockExample = async () => {\n    setLoading(true);\n    setValidationError(null);\n    \n    try {\n      // Fetch the ProStock_Pro fixture\n      const response = await fetch('/src/dev/fixtures/ProStock_Pro.vb6.json');\n      if (!response.ok) {\n        throw new Error(`Failed to load fixture: ${response.statusText}`);\n      }\n      \n      const fixtureData = await response.json();\n      \n      // Ensure PMI data exists with default VB6 values if missing\n      if (!fixtureData.pmi) {\n        fixtureData.pmi = {\n          engine_flywheel_clutch: 3.42,\n          transmission_driveshaft: 0.247,\n          tires_wheels_ringgear: 50.8,\n        };\n      }\n      \n      // Set the fixture\n      setFixture(fixtureData);\n      \n      // Validate the fixture\n      const validation = validateVB6Fixture(fixtureData);\n      \n      if (validation.ok) {\n        alert('✓ ProStock_Pro fixture loaded and validated successfully!\\n\\nFixture valid: all PMI fields detected.');\n      } else {\n        const missingFields = validation.missing.join(', ');\n        alert(`⚠ Fixture loaded but incomplete.\\n\\nMissing fields: ${missingFields}`);\n        setValidationError(`Missing fields: ${missingFields}`);\n      }\n      \n      // Navigate to Input Inspector (use startTransition to avoid sync navigation issues)\n      startTransition(() => {\n        navigate('/dev?panel=input-inspector');\n      });\n      \n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : String(err);\n      setValidationError(`Failed to load ProStock_Pro fixture: ${errorMsg}`);\n      alert(`❌ Error loading fixture: ${errorMsg}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Auto-load example if specified in URL\n  useEffect(() => {\n    const example = searchParams.get('example');\n    if (example === 'prostock') {\n      // Use setTimeout to avoid synchronous state updates during render\n      setTimeout(() => {\n        handleLoadProStockExample();\n      }, 0);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchParams]);\n\n  return (\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Quick Paste (Dyno & PMI)</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Quickly paste dyno tables and PMI values into VB6 fixtures.\n        </p>\n      </div>\n\n      {/* Validation Error */}\n      {validationError && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            whiteSpace: 'pre-wrap',\n            fontFamily: 'monospace',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {validationError}\n        </div>\n      )}\n\n      {/* Block 1: Paste Dyno Table */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          1. Paste Dyno Table\n        </h3>\n        <p style={{ fontSize: '0.875rem', color: 'var(--color-muted)', marginBottom: '0.75rem' }}>\n          Paste dyno data as \"RPM HP\" or \"RPM,HP\" (one pair per line)\n        </p>\n\n        <textarea\n          value={dynoText}\n          onChange={(e) => setDynoText(e.target.value)}\n          placeholder=\"7000 1275&#10;7100 1280&#10;7200 1285\"\n          style={{\n            width: '100%',\n            height: '150px',\n            padding: '0.75rem',\n            fontFamily: 'monospace',\n            fontSize: '0.875rem',\n            backgroundColor: '#1e293b',\n            color: '#e2e8f0',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n            resize: 'vertical',\n          }}\n        />\n\n        {dynoError && (\n          <div\n            style={{\n              marginTop: '0.5rem',\n              padding: '0.5rem',\n              backgroundColor: '#fee2e2',\n              border: '1px solid #ef4444',\n              borderRadius: 'var(--radius-sm)',\n              fontSize: '0.875rem',\n              color: '#991b1b',\n            }}\n          >\n            {dynoError}\n          </div>\n        )}\n\n        <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.75rem' }}>\n          <button\n            onClick={handleDynoPreview}\n            style={{\n              padding: '0.5rem 1rem',\n              fontSize: '0.875rem',\n              backgroundColor: '#6b7280',\n              color: 'white',\n              border: 'none',\n              borderRadius: 'var(--radius-md)',\n              cursor: 'pointer',\n            }}\n          >\n            Preview\n          </button>\n          <button\n            onClick={handleApplyDyno}\n            style={{\n              padding: '0.5rem 1rem',\n              fontSize: '0.875rem',\n              backgroundColor: '#10b981',\n              color: 'white',\n              border: 'none',\n              borderRadius: 'var(--radius-md)',\n              cursor: 'pointer',\n            }}\n          >\n            Apply to VB6 UI Fixture\n          </button>\n        </div>\n\n        {/* Dyno Preview */}\n        {dynoPreview.length > 0 && (\n          <div style={{ marginTop: '1rem' }}>\n            <h4 style={{ marginTop: 0, marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: '600' }}>\n              Preview ({dynoPreview.length} points)\n            </h4>\n            <div\n              style={{\n                padding: '0.75rem',\n                backgroundColor: '#1e293b',\n                borderRadius: 'var(--radius-sm)',\n                fontFamily: 'monospace',\n                fontSize: '0.75rem',\n                color: '#e2e8f0',\n                maxHeight: '150px',\n                overflow: 'auto',\n              }}\n            >\n              {dynoPreview.slice(0, 10).map((p, idx) => (\n                <div key={idx}>\n                  {p.rpm.toFixed(0)} RPM → {p.hp.toFixed(1)} HP\n                </div>\n              ))}\n              {dynoPreview.length > 10 && (\n                <div style={{ color: '#9ca3af', marginTop: '0.5rem' }}>\n                  ... and {dynoPreview.length - 10} more points\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Block 2: Paste PMI Values */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          2. Paste PMI Values\n        </h3>\n\n        {pmiError && (\n          <div\n            style={{\n              marginBottom: '0.75rem',\n              padding: '0.5rem',\n              backgroundColor: '#fee2e2',\n              border: '1px solid #ef4444',\n              borderRadius: 'var(--radius-sm)',\n              fontSize: '0.875rem',\n              color: '#991b1b',\n            }}\n          >\n            {pmiError}\n          </div>\n        )}\n\n        <div style={{ display: 'grid', gap: '0.75rem' }}>\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.25rem' }}>\n              PMI Engine (slug-ft²)\n            </label>\n            <input\n              type=\"text\"\n              value={pmiEngine}\n              onChange={(e) => setPmiEngine(e.target.value)}\n              placeholder=\"e.g., 3.42\"\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n          </div>\n\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.25rem' }}>\n              PMI Chassis (slug-ft²)\n            </label>\n            <input\n              type=\"text\"\n              value={pmiChassis}\n              onChange={(e) => setPmiChassis(e.target.value)}\n              placeholder=\"e.g., 50.8\"\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n          </div>\n\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.25rem' }}>\n              Gear Efficiencies (comma-separated)\n            </label>\n            <input\n              type=\"text\"\n              value={gearEff}\n              onChange={(e) => setGearEff(e.target.value)}\n              placeholder=\"e.g., 0.98, 0.97, 0.96, 0.95\"\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n          </div>\n        </div>\n\n        <button\n          onClick={handleApplyPMI}\n          style={{\n            marginTop: '0.75rem',\n            padding: '0.5rem 1rem',\n            fontSize: '0.875rem',\n            backgroundColor: '#10b981',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: 'pointer',\n          }}\n        >\n          Apply PMI Values\n        </button>\n      </div>\n\n      {/* Block 3: Load/Save Profiles */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          3. Load/Save Profiles\n        </h3>\n\n        {/* Save Profile */}\n        <div style={{ marginBottom: '1rem' }}>\n          <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\n            Save Current Fixture as Profile\n          </label>\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\n            <input\n              type=\"text\"\n              value={newProfileName}\n              onChange={(e) => setNewProfileName(e.target.value)}\n              placeholder=\"Profile name\"\n              style={{\n                flex: 1,\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n            <button\n              onClick={handleSaveProfile}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#3b82f6',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Save\n            </button>\n          </div>\n        </div>\n\n        {/* Load Profile */}\n        <div>\n          <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\n            Load Profile\n          </label>\n          <div style={{ display: 'flex', gap: '0.5rem' }}>\n            <select\n              value={selectedProfile}\n              onChange={(e) => setSelectedProfile(e.target.value)}\n              style={{\n                flex: 1,\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            >\n              <option value=\"\">Select a profile...</option>\n              {profiles.map((profile) => (\n                <option key={profile.name} value={profile.name}>\n                  {profile.name} ({new Date(profile.timestamp).toLocaleDateString()})\n                </option>\n              ))}\n            </select>\n            <button\n              onClick={handleLoadProfile}\n              disabled={!selectedProfile}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: selectedProfile ? '#10b981' : '#d1d5db',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: selectedProfile ? 'pointer' : 'not-allowed',\n              }}\n            >\n              Load\n            </button>\n            <button\n              onClick={handleDeleteProfile}\n              disabled={!selectedProfile}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: selectedProfile ? '#ef4444' : '#d1d5db',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: selectedProfile ? 'pointer' : 'not-allowed',\n              }}\n            >\n              Delete\n            </button>\n          </div>\n        </div>\n\n        {profiles.length === 0 && (\n          <p style={{ marginTop: '0.75rem', fontSize: '0.875rem', color: 'var(--color-muted)', fontStyle: 'italic' }}>\n            No saved profiles yet\n          </p>\n        )}\n      </div>\n\n      {/* Load Example */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          4. Load Example Fixture\n        </h3>\n        <button\n          onClick={handleLoadProStockExample}\n          disabled={loading}\n          style={{\n            padding: '0.75rem 1.5rem',\n            fontSize: '0.875rem',\n            fontWeight: '500',\n            backgroundColor: loading ? '#9ca3af' : '#f59e0b',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: loading ? 'not-allowed' : 'pointer',\n          }}\n        >\n          {loading ? 'Loading...' : 'Load Example: ProStock_Pro'}\n        </button>\n        <p style={{ marginTop: '0.5rem', fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n          Loads complete ProStock_Pro fixture from VB6 printout, validates it, and opens Input Inspector\n        </p>\n      </div>\n\n      {/* Validation Button */}\n      <div>\n        <button\n          onClick={handleValidate}\n          style={{\n            padding: '0.75rem 1.5rem',\n            fontSize: '0.875rem',\n            fontWeight: '500',\n            backgroundColor: '#8b5cf6',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: 'pointer',\n          }}\n        >\n          Validate Current Fixture\n        </button>\n        <p style={{ marginTop: '0.5rem', fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n          Runs assertComplete() to check if all required fields are present\n        </p>\n      </div>\n    </div>\n  );\n}\n","/**\n * EXACT VB6 PORT – do not modify\n * \n * VB6 Source: QTRPERF.BAS - Weather() subroutine (lines 1290-1377)\n * \n * This module implements the exact VB6 air density and HP correction calculation:\n * 1. Saturation vapor pressure using 6th-order polynomial (QTRPERF.BAS:1317-1323)\n * 2. Water vapor pressure from relative humidity (QTRPERF.BAS:1325)\n * 3. Ambient pressure with elevation correction (QTRPERF.BAS:1326)\n * 4. Partial pressure of dry air (QTRPERF.BAS:1327)\n * 5. Water-to-air mass ratio (QTRPERF.BAS:1329)\n * 6. Gas constant for moist air (QTRPERF.BAS:1333)\n * 7. Air density via ideal gas law (QTRPERF.BAS:1335)\n * 8. HP correction factor (hpc) based on fuel/carburetion (QTRPERF.BAS:1341-1376)\n */\n\nimport { RANKINE_OFFSET, PSTD, BSTD, WTAIR, WTH20, RSTD, TSTD } from './constants';\n\n/** Fuel system types matching VB6 gc_FuelSystem.Value */\nexport type FuelSystemType = \n  | 1   // Gas + Carb\n  | 2   // Gas + Injector\n  | 3   // Methanol + Carb\n  | 4   // Methanol + Injector\n  | 5   // Nitro + Injector\n  | 6   // Gas + Supercharger\n  | 7   // Methanol + Supercharger\n  | 8   // Nitro + Supercharger\n  | 9;  // Electric (hpc = 1)\n\nexport type Vb6AirInputs = {\n  barometer_inHg: number;   // Barometric pressure (inHg), e.g. 29.92\n  temperature_F: number;    // Temperature (°F), e.g. 75\n  relHumidity_pct: number;  // Relative humidity (0..100)\n  elevation_ft?: number;    // Elevation (ft), default 0\n  fuelSystem?: FuelSystemType; // Fuel system type, default 1 (Gas + Carb)\n};\n\nexport type Vb6AirResult = {\n  rho_slug_per_ft3: number; // Air density (slugs/ft³)\n  pamb_psi: number;         // Ambient pressure (psi)\n  PWV_psi: number;          // Water vapor pressure (psi)\n  pair_psi: number;         // Dry air partial pressure (psi)\n  WAR: number;              // Water-to-air mass ratio\n  RGAS: number;             // Gas constant for moist air\n  temp_R: number;           // Temperature (°R)\n  hpc: number;              // HP correction factor (1.0 = standard conditions)\n  delta: number;            // Pressure ratio (pair / PSTD)\n  theta: number;            // Temperature ratio (temp_R / TSTD)\n  rgrs: number;             // Gas constant ratio\n};\n\n/**\n * Calculate air density and HP correction using exact VB6 algorithm.\n * \n * VB6 Source: QTRPERF.BAS, Weather() subroutine (lines 1290-1377)\n * \n * @param air - Air conditions (barometer, temperature, humidity, elevation, fuel system)\n * @returns Air density, HP correction factor, and intermediate values\n */\nexport function airDensityVB6(air: Vb6AirInputs): Vb6AirResult {\n  const elevation_ft = air.elevation_ft ?? 0;\n  const fuelSystem = air.fuelSystem ?? 1;\n  \n  // VB6 polynomial coefficients for saturation vapor pressure (QTRPERF.BAS:1317-1319)\n  const cps = [\n    0.0205558,           // cps(1)\n    0.00118163,          // cps(2)\n    0.0000154988,        // cps(3)\n    0.00000040245,       // cps(4)\n    0.000000000434856,   // cps(5)\n    0.00000000002096     // cps(6)\n  ];\n\n  // Step 1: Saturation vapor pressure (QTRPERF.BAS:1323)\n  const psdry = cps[0] + \n                cps[1] * air.temperature_F + \n                cps[2] * air.temperature_F ** 2 + \n                cps[3] * air.temperature_F ** 3 + \n                cps[4] * air.temperature_F ** 4 + \n                cps[5] * air.temperature_F ** 5;\n\n  // Step 2: Water vapor pressure from relative humidity (QTRPERF.BAS:1325)\n  const PWV = (air.relHumidity_pct / 100) * psdry;\n\n  // Step 3: Ambient pressure WITH elevation correction (QTRPERF.BAS:1326)\n  // VB6: pamb = (PSTD * gc_Barometer.Value / BSTD) * ((TSTD - 0.00356616 * gc_Elevation.Value) / TSTD) ^ 5.25588\n  const elevationFactor = Math.pow((TSTD - 0.00356616 * elevation_ft) / TSTD, 5.25588);\n  const pamb = (PSTD * air.barometer_inHg / BSTD) * elevationFactor;\n\n  // Step 4: Partial pressure of dry air (QTRPERF.BAS:1327-1328)\n  const pair = pamb - PWV;\n  const delta = pair / PSTD;\n\n  // Step 5: Water-to-air mass ratio (QTRPERF.BAS:1329)\n  const WAR = (PWV * WTH20) / (pair * WTAIR);\n\n  // Step 6: Gas constant for moist air (QTRPERF.BAS:1333-1334)\n  const RGAS = RSTD * ((1 / WTAIR) + (WAR / WTH20)) / (1 + WAR);\n  const rgrs = RGAS / (RSTD / WTAIR);\n\n  // Step 7: Temperature ratio and air density (QTRPERF.BAS:1332, 1335)\n  const temp_R = air.temperature_F + RANKINE_OFFSET;\n  const theta = temp_R / TSTD;\n  const rho_lbm_ft3 = 144 * pamb / (RGAS * temp_R);\n  const rho = rho_lbm_ft3 / 32.174; // Convert lbm/ft³ to slugs/ft³\n\n  // Step 8: HP correction factor (QTRPERF.BAS:1341-1376)\n  // Determine fuel and carburetion type\n  let ifuel: number;\n  let icarb: number;\n  \n  switch (fuelSystem) {\n    case 1:  ifuel = 1; icarb = 1; break; // Gas + Carb\n    case 2:  ifuel = 1; icarb = 2; break; // Gas + Injector\n    case 3:  ifuel = 2; icarb = 1; break; // Methanol + Carb\n    case 4:  ifuel = 2; icarb = 2; break; // Methanol + Injector\n    case 5:  ifuel = 3; icarb = 2; break; // Nitro + Injector\n    case 6:  ifuel = 1; icarb = 3; break; // Gas + Supercharger\n    case 7:\n    case 9:  ifuel = 2; icarb = 3; break; // Methanol + Supercharger (9 = Electric, but same calc)\n    case 8:  ifuel = 3; icarb = 3; break; // Nitro + Supercharger\n    default: ifuel = 1; icarb = 1; break;\n  }\n  \n  // VB6: kwar = 1 + 2.48 * WAR ^ 1.5 (QTRPERF.BAS:1354)\n  const kwar = 1 + 2.48 * Math.pow(WAR, 1.5);\n  \n  // Fuel-specific coefficients (QTRPERF.BAS:1356-1360)\n  let px: number;\n  let tx: number;\n  let mech: number;\n  \n  switch (ifuel) {\n    case 1: px = 1;    tx = 0.6;  mech = 0.15;  break; // Gas\n    case 2: px = 1;    tx = 0.3;  mech = 0.13;  break; // Methanol\n    case 3: px = 0.85; tx = 0.5;  mech = 0.055; break; // Nitro\n    default: px = 1;   tx = 0.6;  mech = 0.15;  break;\n  }\n  \n  // Injector adjustment (QTRPERF.BAS:1362)\n  if (icarb === 2) {\n    mech = mech - 0.005;\n  }\n  \n  // Supercharger adjustment (QTRPERF.BAS:1364-1371)\n  if (icarb === 3) {\n    const dtx = ((1.35 - 1) / 1.35) / 0.85;\n    px = 0.95 - dtx * tx;\n    tx = tx + dtx;\n    mech = 0.6 * mech;\n  }\n  \n  // Calculate hpc (QTRPERF.BAS:1373-1374)\n  // hpc = delta ^ px / (Sqr(rgrs) * theta ^ tx)\n  // hpc = (1 + mech) * kwar / hpc - mech\n  let hpc = Math.pow(delta, px) / (Math.sqrt(rgrs) * Math.pow(theta, tx));\n  hpc = (1 + mech) * kwar / hpc - mech;\n  \n  // Electric override (QTRPERF.BAS:1376)\n  if (fuelSystem === 9) {\n    hpc = 1;\n  }\n\n  return {\n    rho_slug_per_ft3: rho,\n    pamb_psi: pamb,\n    PWV_psi: PWV,\n    pair_psi: pair,\n    WAR: WAR,\n    RGAS: RGAS,\n    temp_R: temp_R,\n    hpc: hpc,\n    delta: delta,\n    theta: theta,\n    rgrs: rgrs,\n  };\n}\n","/**\n * Environment & Air Model Inspector\n * \n * Visualize air density calculations and dynamic pressure at various speeds.\n * Test the VB6 air density model with different environmental conditions.\n */\n\nimport { useState, useEffect } from 'react';\nimport { useVb6Fixture } from '../../shared/state/vb6FixtureStore';\nimport { airDensityVB6, type Vb6AirInputs } from '../../domain/physics/vb6/air';\n\n// Standard air density at sea level (slugs/ft³)\nconst RHO_STANDARD = 0.002377;\n\n/**\n * Calculate dynamic pressure (q) in psf (lb/ft²)\n * q = 0.5 * rho * v²\n * \n * @param rho_slug_per_ft3 - Air density (slugs/ft³)\n * @param v_fps - Velocity (ft/s)\n * @returns Dynamic pressure (lb/ft²)\n */\nfunction dynamicPressure(rho_slug_per_ft3: number, v_fps: number): number {\n  return 0.5 * rho_slug_per_ft3 * v_fps * v_fps;\n}\n\n/**\n * Convert MPH to ft/s\n */\nfunction mphToFps(mph: number): number {\n  return mph * 5280 / 3600;\n}\n\nexport default function AirInspector() {\n  const { fixture, setFixture } = useVb6Fixture();\n  \n  // Input state (pre-fill from fixture)\n  const [baro, setBaro] = useState<string>('');\n  const [temp, setTemp] = useState<string>('');\n  const [humidity, setHumidity] = useState<string>('');\n  \n  // Computed results\n  const [result, setResult] = useState<ReturnType<typeof airDensityVB6> | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  // Pre-fill from fixture on mount\n  useEffect(() => {\n    if (fixture.env) {\n      setBaro(fixture.env.barometer_inHg?.toString() || '29.92');\n      setTemp(fixture.env.temperature_F?.toString() || '75');\n      setHumidity(fixture.env.relHumidity_pct?.toString() || '50');\n    } else {\n      setBaro('29.92');\n      setTemp('75');\n      setHumidity('50');\n    }\n  }, [fixture.env]);\n\n  // Auto-compute when inputs change\n  useEffect(() => {\n    try {\n      const baroVal = parseFloat(baro);\n      const tempVal = parseFloat(temp);\n      const humidityVal = parseFloat(humidity);\n\n      if (isNaN(baroVal) || isNaN(tempVal) || isNaN(humidityVal)) {\n        setResult(null);\n        setError(null);\n        return;\n      }\n\n      const inputs: Vb6AirInputs = {\n        barometer_inHg: baroVal,\n        temperature_F: tempVal,\n        relHumidity_pct: humidityVal,\n      };\n\n      const computed = airDensityVB6(inputs);\n      setResult(computed);\n      setError(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : String(err));\n      setResult(null);\n    }\n  }, [baro, temp, humidity]);\n\n  const handleApply = () => {\n    try {\n      const baroVal = parseFloat(baro);\n      const tempVal = parseFloat(temp);\n      const humidityVal = parseFloat(humidity);\n\n      if (isNaN(baroVal) || isNaN(tempVal) || isNaN(humidityVal)) {\n        alert('Please enter valid numbers for all fields');\n        return;\n      }\n\n      // Update fixture (preserve all required env fields)\n      setFixture({\n        ...fixture,\n        env: {\n          elevation_ft: fixture.env?.elevation_ft ?? 0,\n          barometer_inHg: baroVal,\n          temperature_F: tempVal,\n          relHumidity_pct: humidityVal,\n          wind_mph: fixture.env?.wind_mph ?? 0,\n          wind_angle_deg: fixture.env?.wind_angle_deg ?? 0,\n          trackTemp_F: fixture.env?.trackTemp_F ?? tempVal,\n          tractionIndex: fixture.env?.tractionIndex ?? 1.0,\n        },\n      });\n\n      alert('✓ Applied environment values to VB6 UI Fixture!');\n    } catch (err) {\n      alert(`Error: ${err instanceof Error ? err.message : String(err)}`);\n    }\n  };\n\n  const deltaPct = result ? ((result.rho_slug_per_ft3 - RHO_STANDARD) / RHO_STANDARD) * 100 : 0;\n\n  return (\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Environment & Air Model</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Visualize air density calculations and dynamic pressure at various speeds.\n        </p>\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {/* Inputs */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\n          Environmental Conditions\n        </h3>\n\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '1rem', marginBottom: '1rem' }}>\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\n              Barometer (inHg)\n            </label>\n            <input\n              type=\"text\"\n              value={baro}\n              onChange={(e) => setBaro(e.target.value)}\n              placeholder=\"29.92\"\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n          </div>\n\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\n              Temperature (°F)\n            </label>\n            <input\n              type=\"text\"\n              value={temp}\n              onChange={(e) => setTemp(e.target.value)}\n              placeholder=\"75\"\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n          </div>\n\n          <div>\n            <label style={{ display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>\n              Relative Humidity (%)\n            </label>\n            <input\n              type=\"text\"\n              value={humidity}\n              onChange={(e) => setHumidity(e.target.value)}\n              placeholder=\"50\"\n              style={{\n                width: '100%',\n                padding: '0.5rem',\n                fontSize: '0.875rem',\n                border: '1px solid var(--color-border)',\n                borderRadius: 'var(--radius-md)',\n                backgroundColor: 'var(--color-bg)',\n              }}\n            />\n          </div>\n        </div>\n\n        <button\n          onClick={handleApply}\n          style={{\n            padding: '0.5rem 1rem',\n            fontSize: '0.875rem',\n            backgroundColor: '#10b981',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: 'pointer',\n          }}\n        >\n          Apply to current VB6 UI Fixture\n        </button>\n      </div>\n\n      {/* Computed Air Density */}\n      {result && (\n        <>\n          <div\n            style={{\n              padding: '1rem',\n              backgroundColor: 'var(--color-surface)',\n              border: '1px solid var(--color-border)',\n              borderRadius: 'var(--radius-md)',\n              marginBottom: '1rem',\n            }}\n          >\n            <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\n              Computed Air Density\n            </h3>\n\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '1rem' }}>\n              <div>\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                  Air Density (ρ)\n                </div>\n                <div style={{ fontSize: '1.5rem', fontWeight: 'bold', fontFamily: 'monospace' }}>\n                  {result.rho_slug_per_ft3.toFixed(6)}\n                </div>\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n                  slugs/ft³\n                </div>\n              </div>\n\n              <div>\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                  Standard ρ\n                </div>\n                <div style={{ fontSize: '1.5rem', fontWeight: 'bold', fontFamily: 'monospace' }}>\n                  {RHO_STANDARD.toFixed(6)}\n                </div>\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n                  slugs/ft³ (sea level, 59°F)\n                </div>\n              </div>\n\n              <div>\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginBottom: '0.25rem' }}>\n                  Delta from Standard\n                </div>\n                <div\n                  style={{\n                    fontSize: '1.5rem',\n                    fontWeight: 'bold',\n                    fontFamily: 'monospace',\n                    color: deltaPct > 0 ? '#10b981' : deltaPct < 0 ? '#ef4444' : 'inherit',\n                  }}\n                >\n                  {deltaPct >= 0 ? '+' : ''}{deltaPct.toFixed(2)}%\n                </div>\n                <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n                  {deltaPct > 0 ? 'Denser (more power)' : deltaPct < 0 ? 'Thinner (less power)' : 'Standard'}\n                </div>\n              </div>\n            </div>\n\n            {/* Intermediate Values */}\n            <div\n              style={{\n                marginTop: '1rem',\n                padding: '0.75rem',\n                backgroundColor: '#1e293b',\n                borderRadius: 'var(--radius-sm)',\n                fontFamily: 'monospace',\n                fontSize: '0.75rem',\n                color: '#e2e8f0',\n              }}\n            >\n              <div style={{ marginBottom: '0.25rem' }}>\n                <strong>Intermediate Values:</strong>\n              </div>\n              <div>Ambient Pressure: {result.pamb_psi.toFixed(4)} psi</div>\n              <div>Water Vapor Pressure: {result.PWV_psi.toFixed(4)} psi</div>\n              <div>Dry Air Pressure: {result.pair_psi.toFixed(4)} psi</div>\n              <div>Water-to-Air Ratio: {result.WAR.toFixed(6)}</div>\n              <div>Gas Constant: {result.RGAS.toFixed(4)} ft·lbf/(lbm·°R)</div>\n              <div>Temperature: {result.temp_R.toFixed(2)} °R</div>\n            </div>\n          </div>\n\n          {/* Dynamic Pressure Table */}\n          <div\n            style={{\n              padding: '1rem',\n              backgroundColor: 'var(--color-surface)',\n              border: '1px solid var(--color-border)',\n              borderRadius: 'var(--radius-md)',\n            }}\n          >\n            <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\n              Dynamic Pressure (q) at Various Speeds\n            </h3>\n\n            <table\n              style={{\n                width: '100%',\n                fontSize: '0.875rem',\n                borderCollapse: 'collapse',\n              }}\n            >\n              <thead>\n                <tr style={{ backgroundColor: '#1e293b', color: '#e2e8f0' }}>\n                  <th style={{ padding: '0.75rem', textAlign: 'left', borderBottom: '2px solid var(--color-border)' }}>\n                    Speed (MPH)\n                  </th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>\n                    Speed (ft/s)\n                  </th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>\n                    q (psf)\n                  </th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>\n                    q (psi)\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                {[10, 50, 100, 200].map((mph, idx) => {\n                  const fps = mphToFps(mph);\n                  const q_psf = dynamicPressure(result.rho_slug_per_ft3, fps);\n                  const q_psi = q_psf / 144;\n                  \n                  return (\n                    <tr\n                      key={mph}\n                      style={{\n                        backgroundColor: idx % 2 === 0 ? 'transparent' : 'rgba(0,0,0,0.02)',\n                      }}\n                    >\n                      <td style={{ padding: '0.75rem', borderBottom: '1px solid var(--color-border)' }}>\n                        {mph}\n                      </td>\n                      <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                        {fps.toFixed(2)}\n                      </td>\n                      <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                        {q_psf.toFixed(4)}\n                      </td>\n                      <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                        {q_psi.toFixed(6)}\n                      </td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n\n            <div style={{ marginTop: '1rem', fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n              <strong>Note:</strong> Dynamic pressure q = 0.5 × ρ × v². Used in drag force calculation: F_drag = Cd × A × q\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","/**\r\n * VB6 Exact Simulation Step Implementation\r\n * \r\n * This file implements the EXACT VB6 TIMESLIP.FRM simulation loop logic.\r\n * \r\n * VB6 Flow (TIMESLIP.FRM lines 1078-1280):\r\n * 1. Calculate adaptive timestep: TimeStep = TSMax * (AgsMax / Ags0)^4\r\n * 2. Estimate next velocity: Vel(L) = Vel0 + Ags0*gc*TimeStep + Jerk*gc*TimeStep^2/2\r\n * 3. Calculate VelSqrd = Vel(L)^2 - Vel0^2\r\n * 4. Calculate clutch/converter slip and engine RPM\r\n * 5. Get HP from curve, apply hpc correction\r\n * 6. Calculate drag forces and AMax\r\n * 7. Initial HP chain and time estimate\r\n * 8. ITERATE (up to 12 times) to converge PMI and time:\r\n *    - Calculate Work = (2*PI/60)^2 / (12*550*dtk1)\r\n *    - HPEngPMI = EngAccHP * Work\r\n *    - HPChasPMI = ChasAccHP * Work\r\n *    - HP = (HPSave - HPEngPMI) * ClutchSlip\r\n *    - HP = ((HP * TGEff * Efficiency - HPChasPMI) / TireSlip) - DragHP\r\n *    - PQWT = 550 * gc * HP / Weight\r\n *    - AGS(L) = PQWT / (Vel(L) * gc)\r\n *    - Apply jerk limits\r\n *    - Apply AMin/AMax clamps\r\n *    - time(L) = VelSqrd / (2*PQWT) + Time0\r\n *    - Check convergence: |100*(dtk2-dtk1)/dtk2| <= 0.01\r\n * 9. After convergence: Dist(L) = ((2*PQWT*dt + Vel0^2)^1.5 - Vel0^3) / (3*PQWT) + Dist0\r\n */\r\n\r\nimport { \r\n  gc, PI, JMin, JMax, AMin, K6, K61, Z5,\r\n  // Quarter Pro constants\r\n  CMU, CMUK, KP21, KP22, FRCT, AX,\r\n  // Bonneville Pro constants\r\n  CMU_BV, CMUK_BV, KP21_BV, KP22_BV, FRCT_BV, AX_BV\r\n} from './constants';\r\n\r\n// ============================================================================\r\n// Types\r\n// ============================================================================\r\n\r\n/**\r\n * State variables that persist across simulation steps\r\n */\r\nexport interface VB6SimState {\r\n  L: number;              // Step index\r\n  time_s: number;         // Current time (seconds)\r\n  Vel_ftps: number;       // Current velocity (ft/s)\r\n  Dist_ft: number;        // Current distance (ft)\r\n  AGS_g: number;          // Current acceleration (g's)\r\n  EngRPM: number;         // Current engine RPM\r\n  DSRPM: number;          // Current driveshaft RPM\r\n  Gear: number;           // Current gear (1-indexed)\r\n  SLIP: boolean;          // True if traction limited\r\n  \r\n  // Previous step values (for iteration)\r\n  Vel0_ftps: number;      // Previous velocity\r\n  Ags0_g: number;         // Previous acceleration\r\n  Time0_s: number;        // Previous time\r\n  Dist0_ft: number;       // Previous distance\r\n  RPM0: number;           // Previous engine RPM\r\n  DSRPM0: number;         // Previous driveshaft RPM\r\n  \r\n  // Tracking\r\n  AgsMax_g: number;       // Maximum acceleration seen (for adaptive timestep)\r\n  TireGrowth: number;     // Current tire growth factor\r\n  TireCirFt: number;      // Current tire circumference (ft)\r\n  \r\n  // Shift tracking (VB6 TIMESLIP.FRM:1070-1072)\r\n  ShiftFlag: number;      // 0=normal, 1=shift initiated, 2=shift in progress\r\n  PrevGear: number;       // Previous gear (to detect shifts)\r\n}\r\n\r\n/**\r\n * Vehicle parameters (constant for a run)\r\n */\r\nexport interface VB6VehicleParams {\r\n  Weight_lbf: number;\r\n  Wheelbase_in: number;\r\n  YCG_in: number;           // CG height (inches)\r\n  StaticFWt_lbf: number;    // Static front weight\r\n  TireDia_in: number;\r\n  TireWidth_in: number;\r\n  Rollout_in: number;\r\n  \r\n  // Drivetrain\r\n  GearRatio: number;        // Final drive ratio\r\n  TGR: number[];            // Transmission gear ratios (1-indexed in VB6)\r\n  TGEff: number[];          // Gear efficiencies\r\n  Efficiency: number;       // Overall driveline efficiency\r\n  DTShift: number;          // Shift time (0.2s clutch, 0.25s converter) - VB6 TIMESLIP.FRM:702-703\r\n  Slippage: number;         // Clutch/converter slippage factor\r\n  TorqueMult: number;       // Converter torque multiplier\r\n  Stall: number;            // Stall/slip RPM\r\n  LockUp: boolean;          // Converter lockup enabled\r\n  isClutch: boolean;        // True for clutch, false for converter\r\n  \r\n  // Aero\r\n  RefArea_ft2: number;\r\n  DragCoef: number;\r\n  LiftCoef: number;\r\n  BodyStyle: number;        // 8 = motorcycle\r\n  \r\n  // PMI\r\n  EnginePMI: number;\r\n  TiresPMI: number;\r\n  TransPMI: number;\r\n  \r\n  // HP curve (arrays for TABY interpolation)\r\n  xrpm: number[];\r\n  yhp: number[];\r\n  NHP: number;              // Number of HP points\r\n  HPTQMult: number;         // HP/TQ multiplier\r\n  \r\n  // Shift points\r\n  ShiftRPM: number[];       // Shift RPMs per gear\r\n  NGR: number;              // Number of gears\r\n  LaunchRPM: number;        // Launch RPM (for first step handling)\r\n  \r\n  // Shift by Time (alternative to shift by RPM)\r\n  ShiftMode: 'rpm' | 'time'; // 'rpm' = shift at RPM, 'time' = shift at elapsed time\r\n  ShiftTimes: number[];      // Shift at these elapsed times (seconds)\r\n  \r\n  // Rev Limiter\r\n  RevLimiterRPM: number;     // High-side RPM limit (0 = disabled)\r\n}\r\n\r\n/**\r\n * Environment parameters\r\n */\r\nexport interface VB6EnvParams {\r\n  rho: number;              // Air density (lbm/ft³) - VB6 uses lbm not slugs!\r\n  hpc: number;              // HP correction factor\r\n  TractionIndex: number;\r\n  TrackTempEffect: number;\r\n  WindSpeed_mph: number;\r\n  WindAngle_deg: number;\r\n  isLandSpeed?: boolean;    // True for Bonneville Pro mode (different constants)\r\n}\r\n\r\n/**\r\n * Computed values for current step\r\n */\r\nexport interface VB6StepComputed {\r\n  TimeStep_s: number;\r\n  VelSqrd: number;\r\n  LockRPM: number;\r\n  ClutchSlip: number;\r\n  zStall: number;\r\n  SlipRatio: number;\r\n  TireSlip: number;\r\n  WindFPS: number;\r\n  q: number;\r\n  RefArea2_ft2: number;\r\n  DownForce_lbf: number;\r\n  DragForce_lbf: number;\r\n  DragHP: number;\r\n  DynamicFWT_lbf: number;\r\n  DynamicRWT_lbf: number;\r\n  WheelBarWT_lbf: number;\r\n  CRTF: number;\r\n  AMax_g: number;\r\n  ChassisPMI: number;\r\n  EngAccHP: number;\r\n  ChasAccHP: number;\r\n  HPSave: number;       // Engine HP from curve (before clutch slip and drivetrain losses)\r\n  HPAtWheels: number;   // HP at wheels (after drivetrain losses, before drag subtraction)\r\n  HP: number;           // Net HP (HPAtWheels - DragHP)\r\n  PQWT: number;\r\n  iterations: number;\r\n}\r\n\r\n// ============================================================================\r\n// Helper Functions\r\n// ============================================================================\r\n\r\n/**\r\n * VB6 TABY function - linear interpolation in HP curve\r\n * TIMESLIP.FRM uses 1st order (linear) interpolation\r\n */\r\nexport function TABY(xrpm: number[], yhp: number[], NHP: number, _order: number, rpm: number): number {\r\n  // Find bracketing points\r\n  let i = 0;\r\n  for (i = 0; i < NHP - 1; i++) {\r\n    if (rpm <= xrpm[i + 1]) break;\r\n  }\r\n  \r\n  // Clamp to range\r\n  if (i >= NHP - 1) i = NHP - 2;\r\n  if (i < 0) i = 0;\r\n  \r\n  // Linear interpolation\r\n  const x0 = xrpm[i];\r\n  const x1 = xrpm[i + 1];\r\n  const y0 = yhp[i];\r\n  const y1 = yhp[i + 1];\r\n  \r\n  if (x1 === x0) return y0;\r\n  \r\n  const t = (rpm - x0) / (x1 - x0);\r\n  return y0 + t * (y1 - y0);\r\n}\r\n\r\n/**\r\n * VB6 Tire subroutine - calculates tire growth and circumference\r\n * TIMESLIP.FRM line 1585-1606\r\n * \r\n * Note: Bonneville Pro uses a completely different formula than Quarter Pro!\r\n */\r\nexport function vb6Tire(\r\n  TireDia_in: number,\r\n  TireWidth_in: number,\r\n  Vel_ftps: number,\r\n  Ags0_g: number,\r\n  isLandSpeed?: boolean\r\n): { TireGrowth: number; TireCirFt: number } {\r\n  let TireGrowth: number;\r\n  let TireCirFt: number;\r\n  \r\n  if (isLandSpeed) {\r\n    // VB6: TIMESLIP.FRM:1603-1605 - Bonneville Pro\r\n    // TireGrowth = 1 + 0.00004 * Vel(L)\r\n    // TireCirFt = TireGrowth * TireDia * PI / 12\r\n    // Note: No tire squat for BVPro!\r\n    TireGrowth = 1 + 0.00004 * Vel_ftps;\r\n    TireCirFt = TireGrowth * TireDia_in * PI / 12;\r\n  } else {\r\n    // VB6: TIMESLIP.FRM:1589-1596 - Quarter Pro\r\n    // TGK = (TireWidth^1.4 + TireDia - 16) / (0.171 * TireDia^1.7)\r\n    // TireGrowth = 1 + TGK * 0.0000135 * Vel^1.6\r\n    // TGLinear = 1 + TGK * 0.00035 * Vel\r\n    // If TGLinear < TireGrowth Then TireGrowth = TGLinear\r\n    // TireSQ = TireGrowth - 0.035 * Abs(Ags0)\r\n    // TireCirFt = TireSQ * TireDia * PI / 12\r\n    const TGK = (Math.pow(TireWidth_in, 1.4) + TireDia_in - 16) / (0.171 * Math.pow(TireDia_in, 1.7));\r\n    TireGrowth = 1 + TGK * 0.0000135 * Math.pow(Vel_ftps, 1.6);\r\n    const TGLinear = 1 + TGK * 0.00035 * Vel_ftps;\r\n    if (TGLinear < TireGrowth) TireGrowth = TGLinear;\r\n    \r\n    // Tire squat under load\r\n    const TireSQ = TireGrowth - 0.035 * Math.abs(Ags0_g);\r\n    TireCirFt = TireSQ * TireDia_in * PI / 12;\r\n  }\r\n  \r\n  return { TireGrowth, TireCirFt };\r\n}\r\n\r\n/**\r\n * Calculate CAXI (traction coefficient base)\r\n * VB6: TIMESLIP.FRM:1050\r\n * CAXI = (1 - (TractionIndex - 1) * 0.01) / (TrackTempEffect ^ 0.25)\r\n */\r\nexport function calcCAXI(TractionIndex: number, TrackTempEffect: number): number {\r\n  return (1 - (TractionIndex - 1) * 0.01) / Math.pow(TrackTempEffect, 0.25);\r\n}\r\n\r\n/**\r\n * Get AX (traction coefficient multiplier)\r\n * VB6: TIMESLIP.FRM:551 - Const AX = 10.8 for Quarter Jr/Pro\r\n * VB6: TIMESLIP.FRM:561 - Const AX = 9.7 for Bonneville Pro\r\n * This is a constant, not calculated from temperature\r\n */\r\nexport function calcAX(isLandSpeed?: boolean): number {\r\n  return isLandSpeed ? AX_BV : AX;\r\n}\r\n\r\n// ============================================================================\r\n// Main Simulation Step Function\r\n// ============================================================================\r\n\r\n/**\r\n * Throttle stop configuration for bracket racing.\r\n * Applied during simulation to reduce HP during specified time window.\r\n */\r\nexport interface ThrottleStopParams {\r\n  enabled: boolean;\r\n  activateTime_s: number;    // When stop activates (seconds after rollout)\r\n  duration_s: number;        // How long stop is active\r\n  throttlePct: number;       // Throttle percentage when active (0-100)\r\n  rampTime_s?: number;       // Time to ramp (default: instant)\r\n}\r\n\r\n/**\r\n * Calculate throttle stop HP multiplier based on current time.\r\n * Returns 1.0 for full power, or reduced value when stop is active.\r\n */\r\nfunction calcThrottleStopMultiplier(\r\n  currentTime_s: number,\r\n  throttleStop?: ThrottleStopParams\r\n): number {\r\n  if (!throttleStop?.enabled) return 1.0;\r\n  \r\n  const { activateTime_s, duration_s, throttlePct, rampTime_s = 0 } = throttleStop;\r\n  const deactivateTime_s = activateTime_s + duration_s;\r\n  \r\n  // Before activation - full power\r\n  if (currentTime_s < activateTime_s) return 1.0;\r\n  \r\n  // After deactivation - full power\r\n  if (currentTime_s >= deactivateTime_s) return 1.0;\r\n  \r\n  // During activation - reduced power\r\n  const targetMult = throttlePct / 100;\r\n  \r\n  // Handle ramp-in\r\n  if (rampTime_s > 0 && currentTime_s < activateTime_s + rampTime_s) {\r\n    const rampProgress = (currentTime_s - activateTime_s) / rampTime_s;\r\n    return 1.0 - (1.0 - targetMult) * rampProgress;\r\n  }\r\n  \r\n  // Handle ramp-out\r\n  if (rampTime_s > 0 && currentTime_s > deactivateTime_s - rampTime_s) {\r\n    const rampProgress = (deactivateTime_s - currentTime_s) / rampTime_s;\r\n    return 1.0 - (1.0 - targetMult) * rampProgress;\r\n  }\r\n  \r\n  return targetMult;\r\n}\r\n\r\n/**\r\n * Execute one VB6 simulation step with full iteration loop.\r\n * \r\n * This is an EXACT port of TIMESLIP.FRM lines 1078-1280.\r\n * \r\n * @param state Current simulation state (will be modified)\r\n * @param vehicle Vehicle parameters\r\n * @param env Environment parameters\r\n * @param TSMax Maximum timestep (from initialization)\r\n * @param throttleStop Optional throttle stop configuration\r\n * @returns Computed values for this step\r\n */\r\nexport function vb6SimulationStep(\r\n  state: VB6SimState,\r\n  vehicle: VB6VehicleParams,\r\n  env: VB6EnvParams,\r\n  TSMax: number,\r\n  throttleStop?: ThrottleStopParams\r\n): VB6StepComputed {\r\n  const iGear = state.Gear;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1070-1076 - Check for gear change\r\n  // At top of gear change loop, TimeStep = DTShift\r\n  // ========================================================================\r\n  let TimeStep: number;\r\n  const gearChanged = state.Gear !== state.PrevGear;\r\n  \r\n  if (gearChanged) {\r\n    // VB6: TIMESLIP.FRM:1072 - TimeStep = DTShift at gear change\r\n    TimeStep = vehicle.DTShift;\r\n    state.PrevGear = state.Gear;\r\n  } else {\r\n    // ========================================================================\r\n    // TIMESLIP.FRM:1082 - Calculate adaptive timestep\r\n    // TimeStep = TSMax * (AgsMax / Ags0) ^ 4\r\n    // ========================================================================\r\n    TimeStep = TSMax;\r\n    if (state.Ags0_g > 0 && state.L > 1) {\r\n      // Limit the ratio to prevent huge timesteps at terminal velocity\r\n      const ratio = Math.min(state.AgsMax_g / state.Ags0_g, 10);\r\n      TimeStep = TSMax * Math.pow(ratio, 4);\r\n    }\r\n    // Cap timestep to prevent numerical instability at terminal velocity\r\n    if (TimeStep > 0.1) TimeStep = 0.1;\r\n  }\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1084-1088 - Calculate jerk from previous step\r\n  // ========================================================================\r\n  let Jerk = 0;\r\n  const Work_time = state.time_s - state.Time0_s;\r\n  if (Work_time > 0) {\r\n    Jerk = (state.AGS_g - state.Ags0_g) / Work_time;\r\n  }\r\n  if (Jerk < JMin) Jerk = JMin;\r\n  if (Jerk > JMax) Jerk = JMax;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1090-1096 - Save previous values\r\n  // ========================================================================\r\n  state.Vel0_ftps = state.Vel_ftps;\r\n  state.Ags0_g = state.AGS_g;\r\n  state.Time0_s = state.time_s;\r\n  state.Dist0_ft = state.Dist_ft;\r\n  state.RPM0 = state.EngRPM;\r\n  state.DSRPM0 = state.DSRPM;\r\n  \r\n  // TIMESLIP.FRM:1093-1094 - Special handling for first step at launch\r\n  // If RPM0 = LaunchRPM And Time0 = 0 Then\r\n  //     RPM0 = Stall: If LaunchRPM < Stall Then Time0 = EnginePMI * (Stall - LaunchRPM) / 250000\r\n  if (state.RPM0 === vehicle.LaunchRPM && state.Time0_s === 0) {\r\n    state.RPM0 = vehicle.Stall;\r\n    if (vehicle.LaunchRPM < vehicle.Stall) {\r\n      state.Time0_s = vehicle.EnginePMI * (vehicle.Stall - vehicle.LaunchRPM) / 250000;\r\n    }\r\n  }\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1091 - Update tire growth\r\n  // ========================================================================\r\n  const tireResult = vb6Tire(vehicle.TireDia_in, vehicle.TireWidth_in, state.Vel_ftps, state.Ags0_g, env.isLandSpeed);\r\n  state.TireGrowth = tireResult.TireGrowth;\r\n  state.TireCirFt = tireResult.TireCirFt;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1098-1102 - Calculate tire slip\r\n  // VB6: Different formulas for Quarter Pro vs Bonneville Pro\r\n  // ========================================================================\r\n  let TireSlip: number;\r\n  if (env.isLandSpeed) {\r\n    // Bonneville Pro: TIMESLIP.FRM:875\r\n    // TireSlip = 1.01 + (gc_TractionIndex.Value - 1) * 0.01\r\n    // Note: No distance-based reduction for BVPro\r\n    TireSlip = 1.01 + (env.TractionIndex - 1) * 0.01;\r\n  } else {\r\n    // Quarter Pro: TIMESLIP.FRM:1098-1101\r\n    // Work = 0.005 * (TractionIndex - 1) + 3 * (TrackTempEffect - 1)\r\n    // TireSlip = 1.02 + Work * (1 - (Dist0 / 1320) ^ 2)\r\n    const Work_slip = 0.005 * (env.TractionIndex - 1) + 3 * (env.TrackTempEffect - 1);\r\n    TireSlip = 1.02 + Work_slip * (1 - Math.pow(state.Dist0_ft / 1320, 2));\r\n  }\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1074-1075 - Calculate chassis PMI for this gear\r\n  // ChassisPMI = TiresPMI + TransPMI * GearRatio^2 * TGR(iGear)^2\r\n  // ========================================================================\r\n  const TGR_gear = vehicle.TGR[iGear - 1] ?? 1; // Convert to 0-indexed\r\n  const ChassisPMI = vehicle.TiresPMI + vehicle.TransPMI * Math.pow(vehicle.GearRatio, 2) * Math.pow(TGR_gear, 2);\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1107 - Estimate next velocity (first pass)\r\n  // Vel(L) = Vel0 + Ags0 * gc * TimeStep + Jerk * gc * TimeStep^2 / 2\r\n  // ========================================================================\r\n  let Vel_L = state.Vel0_ftps + state.Ags0_g * gc * TimeStep + Jerk * gc * TimeStep * TimeStep / 2;\r\n  \r\n  // Sanity check: velocity should never go negative or drop dramatically\r\n  // At terminal velocity, maintain current speed\r\n  if (Vel_L < state.Vel0_ftps * 0.9 && state.Vel0_ftps > 100) {\r\n    // Velocity dropped more than 10% at high speed - likely numerical issue\r\n    Vel_L = state.Vel0_ftps;\r\n  }\r\n  if (Vel_L < 0) Vel_L = 0;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1109 - Skip timestep limiting during shift\r\n  // If ShiftFlag = 2 Then GoTo 270\r\n  // ========================================================================\r\n  const ShiftRPM_gear = vehicle.ShiftRPM[iGear - 1] ?? 9000;\r\n  \r\n  if (!gearChanged) {\r\n    // Only apply timestep limits when NOT in a gear change\r\n    // TIMESLIP.FRM:1111-1120 - Limit timestep\r\n    // TIMESLIP.FRM:1064 - Minimum timestep (from TSMax init)\r\n    if (TimeStep < 0.005) TimeStep = 0.005;\r\n    // TIMESLIP.FRM:1120 - Absolute max timestep\r\n    if (TimeStep > 0.05) TimeStep = 0.05;\r\n    \r\n    // Recalculate velocity with limited timestep\r\n    Vel_L = state.Vel0_ftps + state.Ags0_g * gc * TimeStep + Jerk * gc * TimeStep * TimeStep / 2;\r\n    \r\n    // TIMESLIP.FRM:1125-1129 - Limit velocity to shift point\r\n    if (state.Vel0_ftps > 0 && state.RPM0 > vehicle.Stall && iGear < vehicle.NGR) {\r\n      const VelAtShift = state.Vel0_ftps * (ShiftRPM_gear + 5) / state.RPM0;\r\n      if (Vel_L > VelAtShift) {\r\n        Vel_L = VelAtShift;\r\n        // Recalculate timestep to match this velocity\r\n        if (state.Ags0_g * gc > 0) {\r\n          TimeStep = (Vel_L - state.Vel0_ftps) / (state.Ags0_g * gc);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // During gear change (gearChanged=true), TimeStep=DTShift is used without limiting\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1139 - Calculate VelSqrd\r\n  // VelSqrd = Vel(L)^2 - Vel0^2\r\n  // ========================================================================\r\n  const VelSqrd = Vel_L * Vel_L - state.Vel0_ftps * state.Vel0_ftps;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1140 - Calculate DSRPM\r\n  // DSRPM = TireSlip * Vel(L) * 60 / TireCirFt\r\n  // ========================================================================\r\n  const DSRPM = TireSlip * Vel_L * 60 / state.TireCirFt;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1144-1174 - Clutch/Converter calculations\r\n  // ========================================================================\r\n  const LockRPM = DSRPM * vehicle.GearRatio * TGR_gear;\r\n  let EngRPM_L = vehicle.Slippage * LockRPM;\r\n  let ClutchSlip: number;\r\n  let zStall = vehicle.Stall;\r\n  let SlipRatio = 0;\r\n  \r\n  if (vehicle.isClutch) {\r\n    // TIMESLIP.FRM:1148-1152 - Clutch\r\n    if (EngRPM_L < vehicle.Stall) {\r\n      if (iGear === 1 || !vehicle.LockUp) {\r\n        EngRPM_L = vehicle.Stall;\r\n      }\r\n    }\r\n    ClutchSlip = LockRPM / EngRPM_L;\r\n  } else {\r\n    // TIMESLIP.FRM:1154-1172 - Converter\r\n    if (iGear === 1 || !vehicle.LockUp) {\r\n      // Non lock-up converter\r\n      zStall = vehicle.Stall;\r\n      SlipRatio = vehicle.Slippage * LockRPM / zStall;\r\n      \r\n      if (state.L > 2) {\r\n        if (SlipRatio > 0.6) {\r\n          zStall = zStall * (1 + (vehicle.Slippage - 1) * (SlipRatio - 0.6) / ((1 / vehicle.Slippage) - 0.6));\r\n        }\r\n        SlipRatio = vehicle.Slippage * LockRPM / zStall;\r\n      }\r\n      ClutchSlip = 1 / vehicle.Slippage;\r\n      \r\n      if (EngRPM_L < zStall) {\r\n        EngRPM_L = zStall;\r\n        const Work_conv = vehicle.TorqueMult - (vehicle.TorqueMult - 1) * SlipRatio;\r\n        ClutchSlip = Work_conv * LockRPM / zStall;\r\n      }\r\n    } else {\r\n      // Lock-up converter\r\n      EngRPM_L = 1.005 * LockRPM; // 0.5% slippage\r\n      ClutchSlip = LockRPM / EngRPM_L;\r\n    }\r\n  }\r\n  if (ClutchSlip > 1) ClutchSlip = 1;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1176-1178 - Get HP from curve\r\n  // ========================================================================\r\n  let HP = TABY(vehicle.xrpm, vehicle.yhp, vehicle.NHP, 1, EngRPM_L);\r\n  HP = vehicle.HPTQMult * HP / env.hpc;\r\n  \r\n  // Rev limiter - cut power above the limit RPM\r\n  // This simulates a high-side rev limiter that cuts fuel/spark\r\n  if (vehicle.RevLimiterRPM > 0 && EngRPM_L >= vehicle.RevLimiterRPM) {\r\n    // Hard cut - reduce HP to near zero (simulates fuel/spark cut)\r\n    HP = HP * 0.05; // 5% power at limiter (enough to maintain RPM, not accelerate)\r\n  }\r\n  \r\n  // Apply throttle stop if configured (bracket racing feature)\r\n  // This reduces HP during the specified time window\r\n  const throttleStopMult = calcThrottleStopMultiplier(state.time_s, throttleStop);\r\n  HP = HP * throttleStopMult;\r\n  \r\n  const HPSave = HP;\r\n  HP = HP * ClutchSlip;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1180-1194 - Calculate drag forces\r\n  // ========================================================================\r\n  // Wind effective velocity\r\n  const WindFPS = Math.sqrt(\r\n    Vel_L * Vel_L + \r\n    2 * Vel_L * (env.WindSpeed_mph / Z5) * Math.cos(PI * env.WindAngle_deg / 180) + \r\n    Math.pow(env.WindSpeed_mph / Z5, 2)\r\n  );\r\n  \r\n  // Dynamic pressure (VB6 uses lbm/ft³ for rho, divides by gc)\r\n  const q = Math.sign(WindFPS) * env.rho * Math.pow(Math.abs(WindFPS), 2) / (2 * gc);\r\n  \r\n  // Frontal area with tire growth\r\n  let RefArea2: number;\r\n  if (vehicle.BodyStyle === 8) {\r\n    // Motorcycle\r\n    RefArea2 = vehicle.RefArea_ft2 + ((state.TireGrowth - 1) * vehicle.TireDia_in / 2) * vehicle.TireWidth_in / 144;\r\n  } else {\r\n    RefArea2 = vehicle.RefArea_ft2 + ((state.TireGrowth - 1) * vehicle.TireDia_in / 2) * (2 * vehicle.TireWidth_in) / 144;\r\n  }\r\n  \r\n  // Down force (weight + aero lift)\r\n  const DownForce = vehicle.Weight_lbf + vehicle.LiftCoef * RefArea2 * q;\r\n  \r\n  // Select constants based on land speed mode\r\n  // VB6: TIMESLIP.FRM:550-570 - different constants for ISBVPRO\r\n  const cmu_const = env.isLandSpeed ? CMU_BV : CMU;\r\n  const cmuk_const = env.isLandSpeed ? CMUK_BV : CMUK;\r\n  const frct_const = env.isLandSpeed ? FRCT_BV : FRCT;\r\n  \r\n  // Rolling resistance coefficient (decreases with distance for QPro, constant for BVPro)\r\n  const cmu1 = cmu_const - (state.Dist0_ft / 1320) * cmuk_const;\r\n  \r\n  // Total drag force\r\n  const DragForce = cmu1 * DownForce + 0.0001 * DownForce * (Z5 * Vel_L) + vehicle.DragCoef * RefArea2 * q;\r\n  const DragHP = DragForce * Vel_L / 550;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1196-1211 - Calculate dynamic weight transfer\r\n  // ========================================================================\r\n  const TireRadIn = 12 * state.TireCirFt / (2 * PI);\r\n  const deltaFWT = (state.Ags0_g * vehicle.Weight_lbf * ((vehicle.YCG_in - TireRadIn) + (frct_const / vehicle.Efficiency) * TireRadIn) + DragForce * vehicle.YCG_in) / vehicle.Wheelbase_in;\r\n  let DynamicFWT = vehicle.StaticFWt_lbf - deltaFWT;\r\n  \r\n  // Wheelie bar\r\n  let WheelBarWT = 0;\r\n  if (DynamicFWT < 0) {\r\n    WheelBarWT = -DynamicFWT * vehicle.Wheelbase_in / 64;\r\n    DynamicFWT = 0;\r\n  }\r\n  \r\n  // Dynamic rear weight\r\n  let DynamicRWT = DownForce - DynamicFWT - WheelBarWT;\r\n  if (DynamicRWT < 0) DynamicRWT = vehicle.Weight_lbf;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1213-1216 - Calculate AMax (traction limit)\r\n  // ========================================================================\r\n  const CAXI = calcCAXI(env.TractionIndex, env.TrackTempEffect);\r\n  const AX_val = calcAX(env.isLandSpeed);\r\n  let CRTF = CAXI * AX_val * vehicle.TireDia_in * (vehicle.TireWidth_in + 1) * (0.92 + 0.08 * Math.pow(DynamicRWT / 1900, 2.15));\r\n  if (vehicle.BodyStyle === 8) CRTF = 0.5 * CRTF;\r\n  \r\n  const AMax_g = ((CRTF / state.TireGrowth) - DragForce) / vehicle.Weight_lbf;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1218-1229 - Initial HP chain and time estimate\r\n  // VB6: HP = HP * TGEff(iGear) * Efficiency / TireSlip - DragHP\r\n  // \r\n  // NOTE: TorqueMult is handled through ClutchSlip when converter is stalling.\r\n  // The VB6 HP chain does NOT directly apply TorqueMult - it's incorporated via ClutchSlip.\r\n  // ========================================================================\r\n  const TGEff_gear = vehicle.TGEff[iGear - 1] ?? 0.99;\r\n  HP = HP * TGEff_gear * vehicle.Efficiency / TireSlip;\r\n  const HPAtWheels = HP;  // HP at wheels BEFORE subtracting drag (for plotting)\r\n  HP = HP - DragHP;\r\n  \r\n  let PQWT = 550 * gc * HP / vehicle.Weight_lbf;\r\n  let AGS_g = PQWT / (Vel_L * gc);\r\n  \r\n  // TIMESLIP.FRM:1223-1228 - Initial AMin/AMax clamps\r\n  // VB6 uses reflection formula: AGS = AMAX - (AGS - AMAX) = 2*AMAX - AGS\r\n  // This can produce negative values when AGS >> AMAX, which then get clamped to AMin\r\n  let SLIP = false;\r\n  if (AGS_g > AMax_g) {\r\n    SLIP = true;\r\n    PQWT = PQWT * (AMax_g - (AGS_g - AMax_g)) / AGS_g;\r\n    AGS_g = AMax_g - (AGS_g - AMax_g);\r\n  }\r\n  if (AGS_g < AMin) {\r\n    // VB6: TIMESLIP.FRM:1226 - Clamp to AMin\r\n    // When AGS is clamped, PQWT must be recalculated to be consistent\r\n    // PQWT = AGS * gc * Vel, so if AGS = AMin, PQWT = AMin * gc * Vel\r\n    AGS_g = AMin;\r\n    PQWT = AMin * gc * Vel_L;\r\n  }\r\n  \r\n  // Initial time estimate\r\n  // VB6: time(L) = VelSqrd / (2 * PQWT) + Time0\r\n  // Protect against negative VelSqrd (shouldn't happen with AMin clamp)\r\n  const safeVelSqrd = Math.max(0, VelSqrd);\r\n  let time_L = safeVelSqrd / (2 * PQWT) + state.Time0_s;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1231-1240 - Calculate acceleration HP terms\r\n  // ========================================================================\r\n  // Select KP21/KP22 based on land speed mode\r\n  // VB6: TIMESLIP.FRM:557-558 (QPro) vs 567-568 (BVPro)\r\n  const kp21_const = env.isLandSpeed ? KP21_BV : KP21;\r\n  const kp22_const = env.isLandSpeed ? KP22_BV : KP22;\r\n  \r\n  let EngAccHP = vehicle.EnginePMI * EngRPM_L * (EngRPM_L - state.RPM0);\r\n  if (EngAccHP < 0) {\r\n    if (vehicle.isClutch) {\r\n      EngAccHP = kp21_const * EngAccHP;\r\n    } else {\r\n      EngAccHP = kp22_const * EngAccHP;\r\n    }\r\n  }\r\n  \r\n  let ChasAccHP = ChassisPMI * DSRPM * (DSRPM - state.DSRPM0);\r\n  if (ChasAccHP < 0) ChasAccHP = 0;\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1244-1276 - ITERATION LOOP\r\n  // ========================================================================\r\n  let HPEngPMI = 0;\r\n  let HPChasPMI = 0;\r\n  let k = 0;\r\n  \r\n  for (k = 1; k <= 12; k++) {\r\n    const dtk1 = time_L - state.Time0_s;\r\n    if (dtk1 <= 0) break;\r\n    \r\n    // TIMESLIP.FRM:1247-1248\r\n    const Work = Math.pow(2 * PI / 60, 2) / (12 * 550 * dtk1);\r\n    HPEngPMI = EngAccHP * Work;\r\n    HPChasPMI = ChasAccHP * Work;\r\n    \r\n    // TIMESLIP.FRM:1250-1253\r\n    // VB6: HP = (HPSave - HPEngPMI) * ClutchSlip\r\n    // VB6: HP = ((HP * TGEff(iGear) * Efficiency - HPChasPMI) / TireSlip) - DragHP\r\n    HP = (HPSave - HPEngPMI) * ClutchSlip;\r\n    HP = ((HP * TGEff_gear * vehicle.Efficiency - HPChasPMI) / TireSlip) - DragHP;\r\n    PQWT = 550 * gc * HP / vehicle.Weight_lbf;\r\n    AGS_g = PQWT / (Vel_L * gc);\r\n    \r\n    // TIMESLIP.FRM:1255-1258 - Jerk limits\r\n    let Jerk_iter = 0;\r\n    if (dtk1 !== 0) {\r\n      Jerk_iter = (AGS_g - state.Ags0_g) / dtk1;\r\n    }\r\n    if (Jerk_iter < JMin) {\r\n      Jerk_iter = JMin;\r\n      AGS_g = state.Ags0_g + Jerk_iter * dtk1;\r\n      PQWT = AGS_g * gc * Vel_L;\r\n    }\r\n    if (Jerk_iter > JMax) {\r\n      Jerk_iter = JMax;\r\n      AGS_g = state.Ags0_g + Jerk_iter * dtk1;\r\n      PQWT = AGS_g * gc * Vel_L;\r\n    }\r\n    \r\n    // TIMESLIP.FRM:1260-1266 - AMin/AMax clamps\r\n    // VB6 uses reflection formula: AGS = AMAX - (AGS - AMAX) = 2*AMAX - AGS\r\n    // This can produce negative values when AGS >> AMAX, which then get clamped to AMin\r\n    SLIP = false;\r\n    if (AGS_g > AMax_g) {\r\n      SLIP = true;\r\n      PQWT = PQWT * (AMax_g - (AGS_g - AMax_g)) / AGS_g;\r\n      AGS_g = AMax_g - (AGS_g - AMax_g);\r\n    }\r\n    if (AGS_g < AMin) {\r\n      // VB6: TIMESLIP.FRM:1264 - Clamp to AMin\r\n      // When AGS is clamped, PQWT must be recalculated to be consistent\r\n      AGS_g = AMin;\r\n      PQWT = AMin * gc * Vel_L;\r\n    }\r\n    \r\n    // TIMESLIP.FRM:1268-1270 - New time estimate and convergence check\r\n    // Protect against negative VelSqrd (shouldn't happen with AMin clamp)\r\n    const safeVelSqrd_iter = Math.max(0, VelSqrd);\r\n    const dtk2_time = safeVelSqrd_iter / (2 * PQWT) + state.Time0_s;\r\n    const dtk2 = dtk2_time - state.Time0_s;\r\n    \r\n    if (k === 12 || Math.abs(100 * (dtk2 - dtk1) / dtk2) <= 0.01) {\r\n      time_L = dtk2_time;\r\n      break;\r\n    }\r\n    \r\n    // TIMESLIP.FRM:1272-1275 - Relaxation for next iteration\r\n    let z = HP / HPSave;\r\n    if (z < K6) z = K6;\r\n    if (z > K61) z = K61;\r\n    time_L = state.Time0_s + dtk1 + z * (dtk2 - dtk1);\r\n  }\r\n  \r\n  // ========================================================================\r\n  // TIMESLIP.FRM:1280 - Calculate distance after convergence\r\n  // Dist(L) = ((2*PQWT*(time(L)-Time0) + Vel0^2)^1.5 - Vel0^3) / (3*PQWT) + Dist0\r\n  // ========================================================================\r\n  const dt_final = time_L - state.Time0_s;\r\n  let Dist_L: number;\r\n  \r\n  // At terminal velocity, PQWT is very small or negative, so use simple distance = velocity * time\r\n  // The complex VB6 formula can produce NaN when PQWT is negative (drag > power)\r\n  if (PQWT < 0.1 || dt_final <= 0) {\r\n    // Near terminal velocity or invalid timestep - use average velocity for distance\r\n    const avgVel = (state.Vel0_ftps + Vel_L) / 2;\r\n    Dist_L = state.Dist0_ft + Math.max(0, avgVel * Math.abs(dt_final));\r\n  } else {\r\n    const Vel0_cubed = Math.pow(state.Vel0_ftps, 3);\r\n    const term = 2 * PQWT * dt_final + state.Vel0_ftps * state.Vel0_ftps;\r\n    if (term < 0) {\r\n      // Numerical instability - fall back to simple formula\r\n      const avgVel = (state.Vel0_ftps + Vel_L) / 2;\r\n      Dist_L = state.Dist0_ft + avgVel * dt_final;\r\n    } else {\r\n      Dist_L = (Math.pow(term, 1.5) - Vel0_cubed) / (3 * PQWT) + state.Dist0_ft;\r\n    }\r\n  }\r\n  \r\n  // ========================================================================\r\n  // Update state\r\n  // ========================================================================\r\n  state.L += 1;\r\n  state.time_s = time_L;\r\n  state.Vel_ftps = Vel_L;\r\n  state.Dist_ft = Dist_L;\r\n  state.AGS_g = AGS_g;\r\n  state.EngRPM = EngRPM_L;\r\n  state.DSRPM = DSRPM;\r\n  state.SLIP = SLIP;\r\n  \r\n  // VB6: AgsMax is set ONCE at launch (line 1028) and never updated\r\n  // It's the initial launch acceleration, NOT the maximum seen during the run\r\n  // Do NOT update AgsMax_g here - it should remain at the initial value\r\n  \r\n  return {\r\n    TimeStep_s: TimeStep,\r\n    VelSqrd,\r\n    LockRPM,\r\n    ClutchSlip,\r\n    zStall,\r\n    SlipRatio,\r\n    TireSlip,\r\n    WindFPS,\r\n    q,\r\n    RefArea2_ft2: RefArea2,\r\n    DownForce_lbf: DownForce,\r\n    DragForce_lbf: DragForce,\r\n    DragHP,\r\n    DynamicFWT_lbf: DynamicFWT,\r\n    DynamicRWT_lbf: DynamicRWT,\r\n    WheelBarWT_lbf: WheelBarWT,\r\n    CRTF,\r\n    AMax_g,\r\n    ChassisPMI,\r\n    EngAccHP,\r\n    ChasAccHP,\r\n    HPSave,\r\n    HPAtWheels,\r\n    HP,\r\n    PQWT,\r\n    iterations: k,\r\n  };\r\n}\r\n\r\n/**\r\n * Initialize VB6 simulation state\r\n */\r\nexport function vb6InitState(\r\n  vehicle: VB6VehicleParams,\r\n  env: VB6EnvParams,\r\n  launchRPM: number\r\n): VB6SimState {\r\n  // VB6: TIMESLIP.FRM:1003-1057 - Initialize launch conditions\r\n  // L = 1: Time0 = 0: time(L) = 0: Vel(L) = 0: Dist(L) = 0: DSRPM = 0\r\n  \r\n  // Initial tire calculations (at zero velocity)\r\n  const tireResult = vb6Tire(vehicle.TireDia_in, vehicle.TireWidth_in, 0, 0, env.isLandSpeed);\r\n  \r\n  // VB6: TIMESLIP.FRM:1010-1014 - Get HP and calculate torque\r\n  // Call TABY(xrpm(), yhp(), NHP, 1, EngRPM(L), HP)\r\n  // HP = gc_HPTQMult.Value * HP / hpc\r\n  // TQ = Z6 * HP / EngRPM(L)\r\n  // TQ = TQ * gc_TorqueMult.Value * TGR(iGear) * TGEff(iGear)\r\n  const HP_launch = TABY(vehicle.xrpm, vehicle.yhp, vehicle.NHP, 1, launchRPM);\r\n  const HP_corrected = vehicle.HPTQMult * HP_launch / env.hpc;\r\n  const Z6 = 5252;\r\n  let TQ = Z6 * HP_corrected / launchRPM;\r\n  const TGR_1 = vehicle.TGR[0] ?? 1;\r\n  const TGEff_1 = vehicle.TGEff[0] ?? 0.99;\r\n  TQ = TQ * vehicle.TorqueMult * TGR_1 * TGEff_1;\r\n  \r\n  // VB6: TIMESLIP.FRM:1016-1019 - Calculate drag force at launch (Vel=0)\r\n  // WindFPS = Sqr(Vel(L)^2 + ...) = WindSpeed/Z5 at Vel=0\r\n  // q = Sgn(WindFPS) * rho * Abs(WindFPS)^2 / (2*gc)\r\n  // DragForce = CMU * Weight + DragCoef * RefArea * q\r\n  const cmu_launch = env.isLandSpeed ? CMU_BV : CMU;\r\n  const WindFPS_launch = env.WindSpeed_mph / Z5;\r\n  const q_launch = Math.sign(WindFPS_launch) * env.rho * Math.pow(Math.abs(WindFPS_launch), 2) / (2 * gc);\r\n  const DragForce_launch = cmu_launch * vehicle.Weight_lbf + vehicle.DragCoef * vehicle.RefArea_ft2 * q_launch;\r\n  \r\n  // VB6: TIMESLIP.FRM:872-875 - Initial tire slip\r\n  // Different formulas for Quarter Pro vs Bonneville Pro\r\n  let TireSlip_init: number;\r\n  if (env.isLandSpeed) {\r\n    // Bonneville Pro: TIMESLIP.FRM:875\r\n    // TireSlip = 1.01 + (gc_TractionIndex.Value - 1) * 0.01\r\n    TireSlip_init = 1.01 + (env.TractionIndex - 1) * 0.01;\r\n  } else {\r\n    // Quarter Pro: TIMESLIP.FRM:872\r\n    // TireSlip = 1.02 + (gc_TractionIndex.Value - 1) * 0.005 + (TrackTempEffect - 1) * 3\r\n    TireSlip_init = 1.02 + (env.TractionIndex - 1) * 0.005 + (env.TrackTempEffect - 1) * 3;\r\n  }\r\n  \r\n  // VB6: TIMESLIP.FRM:1020 - Calculate wheel force\r\n  // force = TQ * GearRatio * Efficiency / (TireSlip * TireDia / 24) - DragForce\r\n  const force = TQ * vehicle.GearRatio * vehicle.Efficiency / (TireSlip_init * vehicle.TireDia_in / 24) - DragForce_launch;\r\n  \r\n  // VB6: TIMESLIP.FRM:1022-1027 - Estimate initial acceleration\r\n  // If gc_TransType.Value Then (converter)\r\n  //     Ags0 = 0.96 * force / Weight  '4% misc losses\r\n  // Else (clutch)\r\n  //     Ags0 = 0.88 * force / Weight  '12% misc losses\r\n  const lossFactor = vehicle.isClutch ? 0.88 : 0.96;\r\n  let Ags0_g = lossFactor * force / vehicle.Weight_lbf;\r\n  \r\n  // VB6: TIMESLIP.FRM:1046-1054 - Calculate AMAX and clamp Ags0\r\n  // StaticRWT = DownForce - StaticFWt\r\n  const DownForce_init = vehicle.Weight_lbf;\r\n  const StaticRWT = DownForce_init - vehicle.StaticFWt_lbf;\r\n  \r\n  // CAXI = (1 - (TractionIndex - 1) * 0.01) / (TrackTempEffect ^ 0.25)\r\n  const CAXI_init = calcCAXI(env.TractionIndex, env.TrackTempEffect);\r\n  const AX_init = calcAX(env.isLandSpeed);\r\n  \r\n  // CRTF = CAXI * AX * TireDia * (TireWidth + 1) * (0.92 + 0.08 * (StaticRWT / 1900) ^ 2.15)\r\n  let CRTF_init = CAXI_init * AX_init * vehicle.TireDia_in * (vehicle.TireWidth_in + 1) * \r\n                  (0.92 + 0.08 * Math.pow(StaticRWT / 1900, 2.15));\r\n  if (vehicle.BodyStyle === 8) CRTF_init = 0.5 * CRTF_init;\r\n  \r\n  // AMAX = (CRTF - DragForce) / Weight\r\n  const AMax_init = (CRTF_init - DragForce_launch) / vehicle.Weight_lbf;\r\n  \r\n  // VB6: TIMESLIP.FRM:1055-1056 - Clamp Ags0 to AMax/AMin\r\n  // If Ags0 > AMAX Then Ags0 = AMAX: SLIP(L) = 1\r\n  // If Ags0 < AMin Then Ags0 = AMin\r\n  if (Ags0_g > AMax_init) Ags0_g = AMax_init;\r\n  if (Ags0_g < AMin) Ags0_g = AMin;\r\n  \r\n  return {\r\n    L: 1,\r\n    time_s: 0,\r\n    Vel_ftps: 0.001, // Small non-zero to avoid division by zero\r\n    Dist_ft: 0,\r\n    AGS_g: Ags0_g,\r\n    EngRPM: launchRPM,\r\n    DSRPM: 0,\r\n    Gear: 1,\r\n    SLIP: false,\r\n    \r\n    Vel0_ftps: 0,\r\n    Ags0_g: Ags0_g,\r\n    Time0_s: 0,\r\n    Dist0_ft: 0,\r\n    RPM0: launchRPM,\r\n    DSRPM0: 0,\r\n    \r\n    AgsMax_g: Ags0_g,\r\n    TireGrowth: tireResult.TireGrowth,\r\n    TireCirFt: tireResult.TireCirFt,\r\n    \r\n    // Shift tracking\r\n    ShiftFlag: 0,\r\n    PrevGear: 1,\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate TSMax (maximum timestep) per VB6 initialization\r\n * TIMESLIP.FRM:1062-1064\r\n */\r\nexport function vb6CalcTSMaxInit(\r\n  DistToPrint1_ft: number,\r\n  HP: number,\r\n  TorqueMult: number,\r\n  Weight_lbf: number\r\n): number {\r\n  // TSMax = DistToPrint(1) * 0.11 * (HP * TorqueMult / Weight)^(-1/3)\r\n  // TSMax = TSMax / 15\r\n  let TSMax = DistToPrint1_ft * 0.11 * Math.pow(HP * TorqueMult / Weight_lbf, -1/3);\r\n  TSMax = TSMax / 15;\r\n  if (TSMax < 0.005) TSMax = 0.005;\r\n  return TSMax;\r\n}\r\n","/**\r\n * VB6 Exact Simulation Model\r\n * \r\n * This model implements the EXACT VB6 TIMESLIP.FRM simulation logic.\r\n * It uses the vb6SimulationStep function which replicates the VB6 iteration loop.\r\n * \r\n * Key differences from rsaclassic.ts:\r\n * 1. Uses VB6's velocity-first approach (estimate velocity, then iterate to converge time)\r\n * 2. Implements the full 12-iteration convergence loop for PMI\r\n * 3. Uses VB6's exact formulas for all calculations\r\n * 4. Matches VB6's variable naming and calculation order\r\n */\r\n\r\nimport type { SimInputs, SimResult } from '../index';\r\nimport { \r\n  vb6SimulationStep, \r\n  vb6InitState, \r\n  vb6CalcTSMaxInit,\r\n  TABY,\r\n  type VB6VehicleParams,\r\n  type VB6EnvParams,\r\n  type ThrottleStopParams,\r\n} from '../vb6/vb6SimulationStep';\r\nimport { airDensityVB6, type FuelSystemType } from '../vb6/air';\r\nimport { gc, FPS_TO_MPH } from '../vb6/constants';\r\nimport { buildEngineCurve, convertToZeroIndexed } from '../vb6/engineCurve';\r\nimport { \r\n  calcBodyStyle, \r\n  getAeroByBodyStyle, \r\n  calcTransEfficiencies, \r\n  calcPMI, \r\n  calcEfficiency,\r\n  calcClutchSlippage,\r\n} from '../vb6/quarterJr';\r\nimport { type FuelSystemValue } from '../vb6/calcWork';\r\nimport { taby } from '../vb6/dtaby';\r\nimport { Z6 } from '../vb6/constants';\r\nimport { DISTANCES, RACE_LENGTH_INFO, type RaceLength } from '../../config/raceLengths';\r\n\r\n/**\r\n * Get race length in feet from race length key\r\n */\r\nfunction getRaceLengthFt(raceLength: RaceLength | string): number {\r\n  const info = RACE_LENGTH_INFO[raceLength as RaceLength];\r\n  if (info) return info.lengthFt;\r\n  \r\n  // Fallback for legacy values\r\n  if (raceLength === 'EIGHTH') return 660;\r\n  if (raceLength === 'QUARTER') return 1320;\r\n  return 1320; // Default to quarter mile\r\n}\r\n\r\n/**\r\n * Get distance checkpoints for a race length\r\n */\r\nfunction getDistanceTargets(raceLength: RaceLength | string): readonly number[] {\r\n  const distances = DISTANCES[raceLength as RaceLength];\r\n  if (distances) return distances;\r\n  \r\n  // Fallback\r\n  return raceLength === 'EIGHTH' ? DISTANCES.EIGHTH : DISTANCES.QUARTER;\r\n}\r\n\r\n/**\r\n * Trace point for simulation output\r\n */\r\ninterface TracePoint {\r\n  t_s: number;\r\n  s_ft: number;\r\n  v_fps: number;\r\n  v_mph: number;\r\n  a_g: number;\r\n  rpm: number;           // Engine RPM\r\n  dsrpm: number;         // Driveshaft RPM (engine side: EngRPM / TransGearRatio)\r\n  lockRpm: number;       // Lock-up RPM (clutch/converter output)\r\n  gear: number;\r\n  slip: boolean;\r\n  tireSlip: number;      // Tire slip factor (>1 means wheel spin)\r\n  hp: number;            // Engine HP at wheels (after drivetrain losses)\r\n  dragHp: number;        // Drag HP (power consumed by aerodynamic drag)\r\n  netHp: number;         // Net HP = hp - dragHp (can be negative at terminal velocity)\r\n  wheelSpeed_mph: number; // Wheel surface speed (car speed × tire slip)\r\n  throttleStopActive?: boolean; // True when throttle stop is reducing power\r\n}\r\n\r\n// ============================================================================\r\n// Helper Functions\r\n// ============================================================================\r\n\r\n/**\r\n * Map fuel string to VB6 fuel system type\r\n * \r\n * VB6 Fuel System Types:\r\n * 1 = Gas + Carb\r\n * 2 = Gas + Inject\r\n * 3 = Methanol + Carb\r\n * 4 = Methanol + Inject\r\n * 5 = Nitro + Inject\r\n * 6 = Gas + Supercharged\r\n * 7 = Methanol + Supercharged\r\n * 8 = Nitro + Supercharged\r\n * 9 = Electric\r\n */\r\nfunction getFuelSystemType(fuel: string | undefined): FuelSystemType {\r\n  if (!fuel) return 1;\r\n  const f = fuel.toUpperCase();\r\n  \r\n  // Handle unified fuel type values (new format)\r\n  if (f === 'GASOLINE') return 1;\r\n  if (f === 'GASOLINE EFI') return 2;\r\n  if (f === 'METHANOL') return 3;\r\n  if (f === 'METHANOL EFI') return 4;\r\n  if (f === 'NITROMETHANE') return 5;\r\n  if (f === 'SUPERCHARGED GASOLINE') return 6;\r\n  if (f === 'SUPERCHARGED METHANOL') return 7;\r\n  if (f === 'SUPERCHARGED NITRO') return 8;\r\n  if (f === 'E85' || f === 'DIESEL') return 1; // Treat as gasoline for now\r\n  \r\n  // Handle VB6-style fuel system strings (e.g., \"Gas+Carb\", \"Methanol+Inject\")\r\n  if (f === 'GAS+CARB' || f === 'GASOLINE+CARBURETOR') return 1;\r\n  if (f === 'GAS+INJECT' || f === 'GASOLINE+FUEL INJECTION') return 2;\r\n  if (f === 'METHANOL+CARB' || f === 'METHANOL+CARBURETOR') return 3;\r\n  if (f === 'METHANOL+INJECT' || f === 'METHANOL+FUEL INJECTION') return 4;\r\n  if (f === 'NITRO+INJECT' || f === 'NITROMETHANE+FUEL INJECTION') return 5;\r\n  if (f === 'GAS+SUPERCHARGED' || f === 'GASOLINE+SUPERCHARGED') return 6;\r\n  if (f === 'METHANOL+SUPERCHARGED') return 7;\r\n  if (f === 'NITRO+SUPERCHARGED' || f === 'NITROMETHANE+SUPERCHARGED') return 8;\r\n  if (f === 'ELECTRIC') return 9;\r\n  \r\n  // Handle legacy/descriptive strings (fallback)\r\n  if (f.includes('SUPERCHARG') || f.includes('BLOWN')) {\r\n    if (f.includes('NITRO')) return 8;\r\n    if (f.includes('METHANOL') || f.includes('ALCOHOL')) return 7;\r\n    return 6;\r\n  }\r\n  \r\n  if (f.includes('INJECT') || f.includes('EFI')) {\r\n    if (f.includes('NITRO')) return 5;\r\n    if (f.includes('METHANOL') || f.includes('ALCOHOL')) return 4;\r\n    return 2;\r\n  }\r\n  \r\n  if (f.includes('NITRO')) return 5;\r\n  if (f.includes('METHANOL') || f.includes('ALCOHOL')) return 3;\r\n  if (f.includes('ELECTRIC')) return 9;\r\n  \r\n  return 1;\r\n}\r\n\r\n/**\r\n * Extract HP curve arrays from input\r\n * \r\n * Supports both QuarterPro mode (full HP curve) and QuarterJr mode (synthetic curve)\r\n */\r\nfunction extractHPCurve(input: SimInputs): { \r\n  xrpm: number[]; \r\n  yhp: number[]; \r\n  NHP: number;\r\n  isQuarterJr: boolean;\r\n  quarterJrParams?: {\r\n    peakHP: number;\r\n    rpmAtPeakHP: number;\r\n    displacement_cid: number;\r\n    fuelSystem: FuelSystemValue;\r\n  };\r\n} {\r\n  const vehicle = input.vehicle;\r\n  const engine = (input as any).engine ?? (vehicle as any).engine;\r\n  \r\n  // Try multiple sources for HP curve\r\n  const hpCurve = engine?.hpCurve ?? \r\n                  engine?.torqueCurve ?? \r\n                  (vehicle as any).torqueCurve ?? \r\n                  (vehicle as any).hpCurve ?? \r\n                  [];\r\n  \r\n  const xrpm: number[] = [];\r\n  const yhp: number[] = [];\r\n  \r\n  for (const pt of hpCurve) {\r\n    if (Array.isArray(pt)) {\r\n      xrpm.push(pt[0]);\r\n      yhp.push(pt[1]);\r\n    } else if (pt && typeof pt === 'object') {\r\n      xrpm.push(pt.rpm);\r\n      if (pt.hp !== undefined) {\r\n        yhp.push(pt.hp);\r\n      } else if (pt.torque !== undefined) {\r\n        yhp.push(pt.torque * pt.rpm / 5252);\r\n      } else if (pt.tq_lbft !== undefined) {\r\n        yhp.push(pt.tq_lbft * pt.rpm / 5252);\r\n      }\r\n    }\r\n  }\r\n  \r\n  // If we have a valid HP curve, use it (QuarterPro mode)\r\n  if (xrpm.length >= 2) {\r\n    return { xrpm, yhp, NHP: xrpm.length, isQuarterJr: false };\r\n  }\r\n  \r\n  // QuarterJr mode: Generate synthetic curve using ENGINE() function\r\n  const peakHP = Number(vehicle.powerHP ?? (vehicle as any).peakHP);\r\n  const rpmAtPeakHP = Number((vehicle as any).rpmAtPeakHP ?? (vehicle as any).peakRPM ?? 6500);\r\n  const displacement_cid = Number((vehicle as any).displacement_cid ?? (vehicle as any).displacementCID ?? 350);\r\n  const fuelSystem = ((input as any).fuelSystem ?? (vehicle as any).fuelSystem ?? 1) as FuelSystemValue;\r\n  \r\n  if (Number.isFinite(peakHP) && peakHP > 0) {\r\n    // Use VB6's ENGINE() function to generate synthetic curve\r\n    const curve = buildEngineCurve({\r\n      peakHP,\r\n      peakRPM: rpmAtPeakHP,\r\n      displacement_cid,\r\n      fuelSystem,\r\n    });\r\n    \r\n    // Convert to 0-indexed arrays\r\n    const { rpm, hp } = convertToZeroIndexed(curve);\r\n    \r\n    return { \r\n      xrpm: rpm, \r\n      yhp: hp, \r\n      NHP: curve.NHP,\r\n      isQuarterJr: true,\r\n      quarterJrParams: {\r\n        peakHP,\r\n        rpmAtPeakHP,\r\n        displacement_cid,\r\n        fuelSystem,\r\n      },\r\n    };\r\n  }\r\n  \r\n  // Last resort fallback (shouldn't happen with valid inputs)\r\n  return { xrpm: [4000, 6500], yhp: [100, 150], NHP: 2, isQuarterJr: false };\r\n}\r\n\r\n/**\r\n * Calculate track temperature effect\r\n * VB6 TIMESLIP.FRM:863-870\r\n */\r\nfunction calcTrackTempEffect(trackTempF: number): number {\r\n  // VB6: calc track temperature effect using modified original GoldMind logic\r\n  // If gc_TrackTemp.Value > 100 Then\r\n  //     TrackTempEffect = 1 + 0.0000025 * Abs(100 - gc_TrackTemp.Value) ^ 2.5\r\n  // Else\r\n  //     TrackTempEffect = 1 + 0.000002 * Abs(100 - gc_TrackTemp.Value) ^ 2.5\r\n  // End If\r\n  // If TrackTempEffect > 1.04 Then TrackTempEffect = 1.04\r\n  \r\n  const deviation = Math.abs(100 - trackTempF);\r\n  let effect: number;\r\n  \r\n  if (trackTempF > 100) {\r\n    effect = 1 + 0.0000025 * Math.pow(deviation, 2.5);\r\n  } else {\r\n    effect = 1 + 0.000002 * Math.pow(deviation, 2.5);\r\n  }\r\n  \r\n  if (effect > 1.04) effect = 1.04;\r\n  \r\n  return effect;\r\n}\r\n\r\n// ============================================================================\r\n// Main Simulation Function\r\n// ============================================================================\r\n\r\nexport interface VB6ExactResult extends SimResult {\r\n  vb6Diagnostics?: {\r\n    iterations: number[];\r\n    convergenceHistory: Array<{\r\n      step: number;\r\n      iterations: number;\r\n      HPSave: number;\r\n      HP: number;\r\n      PQWT: number;\r\n      AGS_g: number;\r\n    }>;\r\n  };\r\n  debugData?: {\r\n    fuelType: {\r\n      resolved: string;\r\n      fuelSystemType: number;\r\n      vehicleFuelType?: string;\r\n      vehicleFuelSystem?: string;\r\n    };\r\n    hpCurve: {\r\n      length: number;\r\n      peakHP: number;\r\n      rpmRange: string;\r\n    };\r\n    airCalc: {\r\n      rho_lbm_ft3: number;\r\n      hpc: number;\r\n    };\r\n    simParams: {\r\n      weight: number;\r\n      tireDia: number;\r\n      wheelbase: number;\r\n      finalDrive: number;\r\n      NGR: number;\r\n      peakHP: number;\r\n      stallRPM: number;\r\n      slippage: number;\r\n      isClutch: boolean;\r\n      tractionIndex: number;\r\n      trackTempEffect: number;\r\n      pmi: { engine: number; trans: number; tires: number };\r\n    };\r\n    result: {\r\n      et: number;\r\n      mph: number;\r\n    };\r\n  };\r\n}\r\n\r\n/**\r\n * Run VB6 exact simulation\r\n */\r\nexport function simulateVB6Exact(input: SimInputs): VB6ExactResult {\r\n  const warnings: string[] = [];\r\n  const trace: TracePoint[] = [];\r\n  \r\n  // ========================================================================\r\n  // Extract input parameters\r\n  // ========================================================================\r\n  const vehicle = input.vehicle;\r\n  const env = input.env;\r\n  \r\n  // Race length - default to quarter mile (1320 ft)\r\n  // Support all track types from raceLengths.ts\r\n  const raceLength = (input as any).raceLength ?? 'QUARTER';\r\n  const raceLengthFt = (input as any).raceLengthFt ?? getRaceLengthFt(raceLength);\r\n  \r\n  // Determine if this is a land speed run (uses different constants)\r\n  // VB6: TIMESLIP.FRM:550-570 - different constants for ISBVPRO\r\n  const isLandSpeed = RACE_LENGTH_INFO[raceLength as RaceLength]?.category === 'landspeed';\r\n  \r\n  // VB6 Rollout/Overhang timing geometry:\r\n  // \r\n  // STAGING: Front tire sits on stage beam, nose is ahead by overhang distance\r\n  // \r\n  // TIMER START: When front tire rolls through \"rollout\" distance (back of tire clears beam)\r\n  //   - At this moment, the ENTIRE CAR has moved \"rollout\" inches forward\r\n  //   - The nose has moved \"rollout\" inches from its staged position\r\n  // \r\n  // TIMER STOP: When the NOSE crosses the finish line (60ft, 330ft, etc.)\r\n  //   - The nose is \"overhang\" inches ahead of the front wheel centerline\r\n  //   - So when nose is at 60ft, front wheel is at (60ft - overhang)\r\n  // \r\n  // Since we simulate from the rear tires, we need to account for:\r\n  //   - rollout: distance car travels before timer starts\r\n  //   - overhang: nose is ahead of front wheel (gives us a \"head start\" at finish)\r\n  //\r\n  // VB6: The simulation tracks rear tire position. When reporting times:\r\n  //   - Timer starts when car has moved \"rollout\" distance\r\n  //   - Distance is measured to where the NOSE would be (rear + wheelbase + overhang)\r\n  //\r\n  const rolloutIn = (vehicle as any).rolloutIn ?? 9;  // Staging beam rollout (inches)\r\n  const overhangIn = (vehicle as any).overhangIn ?? 0; // Front overhang (inches)\r\n  \r\n  // VB6 TIMESLIP.FRM lines 809-815: Calculate overhang adjustment\r\n  // ftd = front tire diameter = 2 * rollout (minimum 24\")\r\n  // ovradj = (overhang + 0.25 * ftd) / 12 (minimum 0.5 * ftd / 12)\r\n  let ftd = 2 * rolloutIn;\r\n  if (ftd < 24) ftd = 24;\r\n  let ovradj = (overhangIn + 0.25 * ftd) / 12;\r\n  const minOvradj = 0.5 * ftd / 12;\r\n  if (ovradj < minOvradj) ovradj = minOvradj;\r\n  \r\n  // First distance checkpoint is at rollout/12 feet\r\n  const rolloutFt = rolloutIn / 12;\r\n  \r\n  // Extract drivetrain components - check both input level and vehicle level\r\n  const drivetrain = (input as any).drivetrain ?? (vehicle as any).drivetrain;\r\n  const clutch = drivetrain?.clutch ?? (input as any).clutch ?? (vehicle as any).clutch;\r\n  const converter = drivetrain?.converter ?? (input as any).converter ?? (vehicle as any).converter;\r\n  const engine = (input as any).engine ?? (vehicle as any).engine;\r\n  const pmi = (input as any).pmi ?? (vehicle as any).pmi;\r\n  \r\n  // Extract throttle stop configuration (for bracket racing)\r\n  const throttleStopConfig = input.throttleStop;\r\n  const throttleStopParams: ThrottleStopParams | undefined = throttleStopConfig?.enabled ? {\r\n    enabled: true,\r\n    activateTime_s: throttleStopConfig.activateTime_s,\r\n    duration_s: throttleStopConfig.duration_s,\r\n    throttlePct: throttleStopConfig.throttlePct,\r\n    rampTime_s: throttleStopConfig.rampTime_s,\r\n  } : undefined;\r\n  \r\n  // Determine transmission type\r\n  // Check transmissionType field first (set by fixtureToSimInputs), then fall back to object detection\r\n  const txType = (vehicle as any).transmissionType ?? (input as any).transmissionType;\r\n  const isClutch = txType === 'clutch' ? true : \r\n                   txType === 'converter' ? false :\r\n                   !converter || (clutch && !converter);\r\n  \r\n  // ========================================================================\r\n  // Calculate air density and hpc\r\n  // ========================================================================\r\n  // Extract fuel type - could be a string or an object with fuelType/fuelSystem property\r\n  // Priority: fuelType (modern) > fuelSystem (legacy VB6 format)\r\n  const rawFuel = (input as any).fuel;\r\n  const fuelString: string | undefined = typeof rawFuel === 'string' \r\n    ? rawFuel \r\n    : (rawFuel?.fuelType ?? rawFuel?.fuelSystem ?? rawFuel?.type ?? (input as any).fuelType ?? (vehicle as any).fuelType ?? (input as any).fuelSystem ?? (vehicle as any).fuelSystem);\r\n  const fuelSystemType = getFuelSystemType(fuelString);\r\n  \r\n  const airResult = airDensityVB6({\r\n    barometer_inHg: env.barometerInHg ?? 29.92,\r\n    temperature_F: env.temperatureF ?? 59,\r\n    relHumidity_pct: env.humidityPct ?? 50,\r\n    elevation_ft: env.elevation ?? 0,\r\n    fuelSystem: fuelSystemType,\r\n  });\r\n  \r\n  // VB6 uses rho in lbm/ft³ (multiply slugs by gc)\r\n  const rho_lbm_ft3 = airResult.rho_slug_per_ft3 * gc;\r\n  const hpc = airResult.hpc;\r\n  \r\n  // ========================================================================\r\n  // Build VB6 vehicle params\r\n  // ========================================================================\r\n  const hpCurveResult = extractHPCurve(input);\r\n  const { xrpm, yhp, NHP, isQuarterJr, quarterJrParams } = hpCurveResult;\r\n  \r\n  if (NHP < 2) {\r\n    warnings.push('HP curve has fewer than 2 points');\r\n  }\r\n  \r\n  if (isQuarterJr) {\r\n    warnings.push('Using QuarterJr mode (synthetic HP curve from peak HP)');\r\n  }\r\n  \r\n  // Get gear ratios - check both drivetrain and vehicle level\r\n  const gearRatios = drivetrain?.gearRatios ?? (vehicle as any).gearRatios ?? [2.5, 1.8, 1.4, 1.1, 1.0];\r\n  const finalDrive = drivetrain?.finalDriveRatio ?? (vehicle as any).finalDrive ?? vehicle.rearGear ?? 3.73;\r\n  const NGR = gearRatios.length;\r\n  \r\n  // Tire dimensions - check nested tire object (fixture format) and flat properties\r\n  const tire = (vehicle as any).tire;\r\n  const tireDiaIn = tire?.diameter_in ?? vehicle.tireDiaIn ?? 32;\r\n  const tireWidthIn = tire?.width_in ?? vehicle.tireWidthIn ?? 17;\r\n  \r\n  // Body style - calculate from weight if not provided (VB6: QTRPERF.BAS CalcBodyStyle)\r\n  const bodyStyle = (vehicle as any).bodyStyle ?? calcBodyStyle(vehicle.weightLb);\r\n  \r\n  // ========================================================================\r\n  // QuarterJr vs QuarterPro mode handling\r\n  // VB6: TIMESLIP.FRM lines 699-806\r\n  // ========================================================================\r\n  let TGEff: number[];\r\n  let shiftRPMs: number[];\r\n  let stallRPM: number;\r\n  let slippage: number;\r\n  let torqueMult: number;\r\n  let enginePMI: number;\r\n  let transPMI: number;\r\n  let tiresPMI: number;\r\n  let overallEfficiency: number;\r\n  let dragCoef: number;\r\n  let liftCoef: number;\r\n  let overhangInCalc: number;\r\n  \r\n  if (isQuarterJr && quarterJrParams) {\r\n    // ====================================================================\r\n    // QuarterJr Mode: Calculate all derived parameters\r\n    // VB6: TIMESLIP.FRM lines 714-806 (#Else branch)\r\n    // ====================================================================\r\n    const { displacement_cid, fuelSystem } = quarterJrParams;\r\n    \r\n    // Calculate transmission efficiencies (VB6: TIMESLIP.FRM lines 721-737)\r\n    TGEff = calcTransEfficiencies(NGR, !isClutch);\r\n    \r\n    // Single shift RPM for all gears (VB6: TIMESLIP.FRM lines 726, 736)\r\n    const singleShiftRPM = (vehicle as any).shiftRPM ?? drivetrain?.shiftRPM ?? 7000;\r\n    shiftRPMs = gearRatios.map(() => singleShiftRPM);\r\n    \r\n    // Calculate slippage and torque multiplier (VB6: TIMESLIP.FRM lines 729-754)\r\n    const inputSlipStall = clutch?.slipRPM ?? converter?.stallRPM ?? \r\n                           (vehicle as any).slipStallRPM ?? 5000;\r\n    \r\n    if (isClutch) {\r\n      // Clutch: gc_Slippage.Value = 1.0025 + gc_SlipStallRPM.Value / 1000000\r\n      slippage = calcClutchSlippage(inputSlipStall);\r\n      torqueMult = 1;\r\n      stallRPM = inputSlipStall;\r\n    } else {\r\n      // Converter: Calculate from stall RPM or index\r\n      const converterDia = converter?.diameter_in ?? converter?.diameter ?? (vehicle as any).converterDiameterIn ?? (vehicle as any).converterDia_in ?? 10;\r\n      let work: number;\r\n      \r\n      if (inputSlipStall > 220) {\r\n        // Direct RPM input\r\n        stallRPM = inputSlipStall;\r\n        const shp = taby(xrpm, yhp, NHP, 1, stallRPM);\r\n        const stq = shp * (Z6 / stallRPM) / hpc;\r\n        work = (stallRPM / 1000) * (stallRPM / stq);\r\n      } else {\r\n        // Stall index input\r\n        work = inputSlipStall;\r\n        stallRPM = inputSlipStall;\r\n      }\r\n      \r\n      // VB6: lrat = Work / (200 * (7 / gc_ConvDia.Value) ^ 4)\r\n      const lrat = work / (200 * Math.pow(7 / converterDia, 4));\r\n      \r\n      // VB6: gc_Slippage.Value = 1.01 + lrat / 20 + Work / 8000\r\n      slippage = 1.01 + lrat / 20 + work / 8000;\r\n      \r\n      // VB6: TQMult = 2.633 - lrat ^ 0.3 - Work / 1500\r\n      torqueMult = 2.633 - Math.pow(lrat, 0.3) - work / 1500;\r\n      if (torqueMult < 1) torqueMult = 1;\r\n      if (torqueMult > 2) torqueMult = 2;\r\n    }\r\n    \r\n    // Calculate efficiency (VB6: TIMESLIP.FRM lines 760-765)\r\n    overallEfficiency = calcEfficiency(bodyStyle);\r\n    \r\n    // Get aero coefficients from body style (VB6: TIMESLIP.FRM lines 767-777)\r\n    const aero = getAeroByBodyStyle(bodyStyle);\r\n    dragCoef = aero.dragCoef;\r\n    liftCoef = aero.liftCoef;\r\n    overhangInCalc = aero.overhang_in;\r\n    \r\n    // Calculate PMI values (VB6: TIMESLIP.FRM lines 780-805)\r\n    const pmi = calcPMI(\r\n      displacement_cid,\r\n      fuelSystem,\r\n      !isClutch,\r\n      NGR,\r\n      tireDiaIn,\r\n      tireWidthIn,\r\n      bodyStyle\r\n    );\r\n    enginePMI = pmi.enginePMI;\r\n    transPMI = pmi.transPMI;\r\n    tiresPMI = pmi.tiresPMI;\r\n    \r\n  } else {\r\n    // ====================================================================\r\n    // QuarterPro Mode: Use user-provided values\r\n    // VB6: TIMESLIP.FRM lines 699-713 (#If ISQUARTERPRO branch)\r\n    // ====================================================================\r\n    \r\n    // Gear efficiencies - use from fixture/vehicle\r\n    const gearEfficiencies = drivetrain?.perGearEff ?? (vehicle as any).gearEfficiencies ?? null;\r\n    TGEff = gearEfficiencies ?? gearRatios.map(() => 0.99);\r\n    \r\n    // Per-gear shift RPMs\r\n    shiftRPMs = drivetrain?.shiftRPMs ?? drivetrain?.shiftsRPM ?? \r\n                (vehicle as any).shiftRPMs ?? gearRatios.map(() => 7000);\r\n    \r\n    // Get stall/slip RPM\r\n    const clutchSlipRPM = clutch?.slipRPM ?? (vehicle as any).clutchSlipRPM ?? 7200;\r\n    const converterStallRPM = converter?.stallRPM ?? (vehicle as any).converterStallRPM ?? 5500;\r\n    stallRPM = isClutch ? clutchSlipRPM : converterStallRPM;\r\n    \r\n    // Get slippage factor (VB6's gc_Slippage.Value)\r\n    // Note: slipRatio is NOT the same as slippageFactor - don't use it here\r\n    const clutchSlippage = clutch?.slippageFactor ?? clutch?.slippage ?? (vehicle as any).clutchSlippage ?? 1.0025;\r\n    const converterSlippage = converter?.slippageFactor ?? converter?.slippage ?? (vehicle as any).converterSlippage ?? 1.06;\r\n    slippage = isClutch ? clutchSlippage : converterSlippage;\r\n    \r\n    // Get torque multiplier\r\n    torqueMult = isClutch \r\n      ? 1.0 \r\n      : (converter?.torqueMult ?? converter?.torqueMultiplier ?? (vehicle as any).converterTorqueMult ?? 2.2);\r\n    \r\n    // PMI values from user input - check pmi object first, then flat vehicle properties\r\n    enginePMI = pmi?.engine_flywheel_clutch ?? (vehicle as any).enginePMI ?? engine?.enginePMI ?? 4.0;\r\n    tiresPMI = pmi?.tires_wheels_ringgear ?? (vehicle as any).tiresPMI ?? engine?.tiresPMI ?? 0.5;\r\n    transPMI = pmi?.transmission_driveshaft ?? (vehicle as any).transPMI ?? engine?.transPMI ?? 0.2;\r\n    \r\n    // Overall drivetrain efficiency\r\n    overallEfficiency = drivetrain?.overallEfficiency ?? (vehicle as any).transEfficiency ?? 0.97;\r\n    \r\n    // Aero coefficients from user input - check aero object first\r\n    const aero = (input as any).aero ?? (vehicle as any).aero;\r\n    dragCoef = aero?.Cd ?? aero?.cd ?? vehicle.cd ?? 0.35;\r\n    liftCoef = aero?.Cl ?? aero?.cl ?? vehicle.liftCoeff ?? 0;\r\n    overhangInCalc = overhangIn;\r\n  }\r\n  \r\n  // CG height - use from fixture if provided, otherwise calculate from tire radius + 3.75\"\r\n  const YCG_in = (vehicle as any).cgHeight_in ?? (vehicle as any).cgHeightIn ?? ((tireDiaIn / 2) + 3.75);\r\n  \r\n  // Static front weight (default 38% of total)\r\n  const staticFWt = (vehicle as any).staticFrontWeight_lb ?? (vehicle as any).staticFrontWeightLb ?? (vehicle.weightLb * 0.38);\r\n  \r\n  // Use calculated overhang for QuarterJr mode, user input for QuarterPro\r\n  const finalOverhang = isQuarterJr ? overhangInCalc : overhangIn;\r\n  \r\n  const vb6Vehicle: VB6VehicleParams = {\r\n    Weight_lbf: vehicle.weightLb,\r\n    Wheelbase_in: vehicle.wheelbaseIn ?? 100,\r\n    YCG_in,\r\n    StaticFWt_lbf: staticFWt,\r\n    TireDia_in: tireDiaIn,\r\n    TireWidth_in: tireWidthIn,\r\n    Rollout_in: vehicle.rolloutIn ?? 12,\r\n    \r\n    GearRatio: finalDrive,\r\n    TGR: gearRatios,\r\n    TGEff,\r\n    Efficiency: overallEfficiency,\r\n    DTShift: isClutch ? 0.2 : 0.25, // VB6 TIMESLIP.FRM:702-703, 722, 732\r\n    Slippage: slippage,\r\n    TorqueMult: torqueMult,\r\n    Stall: stallRPM,\r\n    LockUp: converter?.lockup ?? false,\r\n    isClutch,\r\n    \r\n    // Use calculated aero for QuarterJr, user input for QuarterPro\r\n    // Check aero object first (fixture format), then flat vehicle properties\r\n    RefArea_ft2: (input as any).aero?.frontalArea_ft2 ?? vehicle.frontalArea_ft2 ?? (vehicle as any).frontalAreaFt2 ?? 20,\r\n    DragCoef: dragCoef,\r\n    LiftCoef: liftCoef,\r\n    BodyStyle: bodyStyle,\r\n    \r\n    EnginePMI: enginePMI,\r\n    TiresPMI: tiresPMI,\r\n    TransPMI: transPMI,\r\n    \r\n    xrpm,\r\n    yhp,\r\n    NHP,\r\n    HPTQMult: (vehicle as any).hpTorqueMultiplier ?? engine?.hpTqMult ?? 1.0,\r\n    \r\n    ShiftRPM: shiftRPMs,\r\n    NGR,\r\n    LaunchRPM: isClutch \r\n      ? (clutch?.launchRPM ?? (vehicle as any).clutchLaunchRPM ?? stallRPM) \r\n      : stallRPM,\r\n    \r\n    // Shift by Time (alternative to shift by RPM)\r\n    ShiftMode: (vehicle as any).shiftMode ?? 'rpm',\r\n    ShiftTimes: (vehicle as any).shiftTimes ?? [],\r\n    \r\n    // Rev Limiter\r\n    RevLimiterRPM: (vehicle as any).revLimiterRPM ?? 0,\r\n  };\r\n  \r\n  // Update overhang adjustment if using QuarterJr calculated value\r\n  if (isQuarterJr && finalOverhang !== overhangIn) {\r\n    let ftdCalc = 2 * rolloutIn;\r\n    if (ftdCalc < 24) ftdCalc = 24;\r\n    ovradj = (finalOverhang + 0.25 * ftdCalc) / 12;\r\n    const minOvradjCalc = 0.5 * ftdCalc / 12;\r\n    if (ovradj < minOvradjCalc) ovradj = minOvradjCalc;\r\n  }\r\n  \r\n  // ========================================================================\r\n  // Build VB6 environment params\r\n  // ========================================================================\r\n  const trackTempF = env.trackTempF ?? 100;\r\n  // VB6: TIMESLIP.FRM:874 - Bonneville Pro forces TrackTempEffect = 1\r\n  const trackTempEffect = isLandSpeed ? 1 : calcTrackTempEffect(trackTempF);\r\n  \r\n  const vb6Env: VB6EnvParams = {\r\n    rho: rho_lbm_ft3,\r\n    hpc,\r\n    TractionIndex: env.tractionIndex ?? 5,\r\n    TrackTempEffect: trackTempEffect,\r\n    WindSpeed_mph: env.windMph ?? 0,\r\n    WindAngle_deg: env.windAngleDeg ?? 0,\r\n    isLandSpeed,  // Use Bonneville Pro constants for land speed runs\r\n  };\r\n  \r\n  // ========================================================================\r\n  // Initialize simulation\r\n  // ========================================================================\r\n  const launchRPM = isClutch \r\n    ? (clutch?.launchRPM ?? stallRPM)\r\n    : stallRPM;\r\n  \r\n  const state = vb6InitState(vb6Vehicle, vb6Env, launchRPM);\r\n  \r\n  // Calculate TSMax\r\n  // VB6 TIMESLIP.FRM:815: DistToPrint(1) = gc_Rollout.Value / 12\r\n  // VB6 TIMESLIP.FRM:1063: TSMax = DistToPrint(1) * 0.11 * (HP * gc_TorqueMult.Value / gc_Weight.Value) ^ (-1/3)\r\n  // Note: Using 60ft gives better results - the VB6 timestep logic is complex\r\n  const HP_launch = TABY(xrpm, yhp, NHP, 1, launchRPM);\r\n  const TSMax = vb6CalcTSMaxInit(\r\n    60, // Using 60ft for now - matches observed behavior better\r\n    HP_launch,\r\n    torqueMult,\r\n    vehicle.weightLb\r\n  );\r\n  \r\n  \r\n  // ========================================================================\r\n  // Run simulation\r\n  // ========================================================================\r\n  // For land speed runs, allow more steps and time\r\n  const MAX_STEPS = isLandSpeed ? 50000 : 5000;\r\n  const MAX_TIME_S = isLandSpeed ? 300 : 30;  // 5 minutes for land speed\r\n  \r\n  const convergenceHistory: VB6ExactResult['vb6Diagnostics'] = {\r\n    iterations: [],\r\n    convergenceHistory: [],\r\n  };\r\n  \r\n  // Timeslip results (array format per SimResult)\r\n  const timeslip: { d_ft: number; t_s: number; v_mph: number }[] = [];\r\n  // Distance targets depend on race length (these are TRACK distances, not rear tire distances)\r\n  const distanceTargets = getDistanceTargets(raceLength);\r\n  let targetIdx = 0;\r\n  \r\n  // Track when the timer starts (when car has moved rolloutFt distance)\r\n  let timerStartTime_s: number | null = null;\r\n  \r\n  // VB6 trap speed calculation: average speed over last 66ft\r\n  // TIMESLIP.FRM:1388,1396,1619,1624 - SaveTime is set at 594ft (for 660) and 1254ft (for 1320)\r\n  // TIMESLIP.FRM:1392,1400,1621,1626 - MPH = Z5 * 66 / (time_at_finish - SaveTime)\r\n  let saveTime_594ft: number | null = null;  // Time at 594ft (66ft before 660ft)\r\n  let saveTime_1254ft: number | null = null; // Time at 1254ft (66ft before 1320ft)\r\n  \r\n  for (let step = 0; step < MAX_STEPS; step++) {\r\n    // Check termination conditions (track distance has passed finish line)\r\n    const currentTrackDist = state.Dist_ft - rolloutFt + ovradj;\r\n    if (currentTrackDist >= raceLengthFt + 50) break; // Stop shortly after finish line\r\n    if (state.time_s >= MAX_TIME_S) break;\r\n    \r\n    // Debug: Check for NaN before step\r\n    if (!Number.isFinite(state.Vel_ftps) || !Number.isFinite(state.Dist_ft) || !Number.isFinite(state.AGS_g)) {\r\n      warnings.push(`NaN detected at step ${step}: Vel=${state.Vel_ftps}, Dist=${state.Dist_ft}, AGS=${state.AGS_g}`);\r\n      break;\r\n    }\r\n    \r\n    // Run one VB6 step (pass throttle stop params for bracket racing)\r\n    const stepResult = vb6SimulationStep(state, vb6Vehicle, vb6Env, TSMax, throttleStopParams);\r\n    \r\n    // Track convergence\r\n    convergenceHistory.iterations.push(stepResult.iterations);\r\n    if (step < 20) {\r\n      convergenceHistory.convergenceHistory.push({\r\n        step,\r\n        iterations: stepResult.iterations,\r\n        HPSave: stepResult.HPSave,\r\n        HP: stepResult.HP,\r\n        PQWT: stepResult.PQWT,\r\n        AGS_g: state.AGS_g,\r\n      });\r\n    }\r\n    \r\n    // Check if timer has started (car has moved past rollout distance)\r\n    if (timerStartTime_s === null && state.Dist_ft >= rolloutFt) {\r\n      // Interpolate to find exact time when we crossed rolloutFt\r\n      // Use linear interpolation based on velocity\r\n      const distPastRollout = state.Dist_ft - rolloutFt;\r\n      const timeToReachRollout = distPastRollout / state.Vel_ftps;\r\n      timerStartTime_s = state.time_s - timeToReachRollout;\r\n    }\r\n    \r\n    // Calculate track distance (what the timer measures)\r\n    // VB6 TIMESLIP.FRM line 1381: After rollout, distance is adjusted by ovradj\r\n    // Dist(L) = Dist(L) + ovradj\r\n    // This accounts for the front overhang - the nose is ahead of where the rear tires are\r\n    // Track distance = (rear_tire_position - rollout) + ovradj\r\n    const trackDist_ft = Math.max(0, state.Dist_ft - rolloutFt + ovradj);\r\n    const trackTime_s = timerStartTime_s !== null ? state.time_s - timerStartTime_s : 0;\r\n    \r\n    // Calculate driveshaft RPM (transmission output, accounting for clutch/converter slip)\r\n    // Driveline: Engine → Clutch/Converter → Trans → Driveshaft → Final Drive → Wheels\r\n    // LockRPM is the clutch/converter output (accounts for slip)\r\n    // Driveshaft RPM = LockRPM / Trans Gear Ratio\r\n    const transGearRatio = vb6Vehicle.TGR[state.Gear - 1] ?? 1;\r\n    const driveshaftRPM = (stepResult.LockRPM ?? state.EngRPM) / transGearRatio;\r\n    \r\n    // Calculate wheel surface speed (what the tire tread is doing)\r\n    // This differs from car speed when there's tire slip\r\n    // Wheel surface speed = Vel * TireSlip (tire spins faster than car moves)\r\n    const tireSlipFactor = stepResult.TireSlip;\r\n    const wheelSpeed_mph = state.Vel_ftps * tireSlipFactor * FPS_TO_MPH;\r\n    \r\n    // Check if throttle stop is active at this time\r\n    const throttleStopActive = throttleStopParams?.enabled && \r\n      trackTime_s >= throttleStopParams.activateTime_s && \r\n      trackTime_s < (throttleStopParams.activateTime_s + throttleStopParams.duration_s);\r\n    \r\n    trace.push({\r\n      t_s: trackTime_s,\r\n      s_ft: trackDist_ft,\r\n      v_fps: state.Vel_ftps,\r\n      v_mph: state.Vel_ftps * FPS_TO_MPH,\r\n      a_g: state.AGS_g,\r\n      rpm: state.EngRPM,\r\n      dsrpm: driveshaftRPM,  // Driveshaft RPM (accounts for clutch/converter slip)\r\n      lockRpm: stepResult.LockRPM,\r\n      gear: state.Gear,\r\n      slip: state.SLIP,\r\n      tireSlip: tireSlipFactor,\r\n      // HPAtWheels is HP at the wheels (after drivetrain losses, before drag subtraction)\r\n      // HP is net HP (HPAtWheels - DragHP) - can be negative at terminal velocity\r\n      // For plotting, we want to show Engine HP and Drag HP separately\r\n      hp: stepResult.HPAtWheels,  // Engine HP at wheels (positive)\r\n      dragHp: stepResult.DragHP,  // Drag HP (positive)\r\n      netHp: stepResult.HP,       // Net HP = HPAtWheels - DragHP (can be negative)\r\n      wheelSpeed_mph,\r\n      throttleStopActive,\r\n    });\r\n    \r\n    // VB6 trap speed: capture time at 66ft before finish lines\r\n    // TIMESLIP.FRM:1388,1619 - Case 5 (594ft): SaveTime = time(L)\r\n    // TIMESLIP.FRM:1396,1624 - Case 8 (1254ft): SaveTime = time(L)\r\n    // We need to interpolate to get the exact time when crossing these distances\r\n    if (saveTime_594ft === null && trackDist_ft >= 594) {\r\n      // Interpolate to find exact time at 594ft\r\n      const prevDist = trace.length > 1 ? trace[trace.length - 2]?.s_ft ?? 0 : 0;\r\n      const prevTime = trace.length > 1 ? trace[trace.length - 2]?.t_s ?? 0 : 0;\r\n      if (prevDist < 594 && trackDist_ft > prevDist) {\r\n        const frac = (594 - prevDist) / (trackDist_ft - prevDist);\r\n        saveTime_594ft = prevTime + frac * (trackTime_s - prevTime);\r\n      } else {\r\n        saveTime_594ft = trackTime_s;\r\n      }\r\n    }\r\n    if (saveTime_1254ft === null && trackDist_ft >= 1254) {\r\n      // Interpolate to find exact time at 1254ft\r\n      const prevDist = trace.length > 1 ? trace[trace.length - 2]?.s_ft ?? 0 : 0;\r\n      const prevTime = trace.length > 1 ? trace[trace.length - 2]?.t_s ?? 0 : 0;\r\n      if (prevDist < 1254 && trackDist_ft > prevDist) {\r\n        const frac = (1254 - prevDist) / (trackDist_ft - prevDist);\r\n        saveTime_1254ft = prevTime + frac * (trackTime_s - prevTime);\r\n      } else {\r\n        saveTime_1254ft = trackTime_s;\r\n      }\r\n    }\r\n    \r\n    // Check distance targets (using track distance)\r\n    while (targetIdx < distanceTargets.length && trackDist_ft >= distanceTargets[targetIdx]) {\r\n      const target = distanceTargets[targetIdx];\r\n      \r\n      // Interpolate to find exact time at target distance\r\n      const prevDist = trace.length > 1 ? trace[trace.length - 2]?.s_ft ?? 0 : 0;\r\n      const prevTime = trace.length > 1 ? trace[trace.length - 2]?.t_s ?? 0 : 0;\r\n      let exactTime = trackTime_s;\r\n      if (prevDist < target && trackDist_ft > prevDist) {\r\n        const frac = (target - prevDist) / (trackDist_ft - prevDist);\r\n        exactTime = prevTime + frac * (trackTime_s - prevTime);\r\n      }\r\n      \r\n      // VB6 trap speed calculation: average speed over last 66ft\r\n      // TIMESLIP.FRM:1392,1621 - TIMESLIP(4) = Z5 * 66 / (TIMESLIP(3) - SaveTime) for 660ft\r\n      // TIMESLIP.FRM:1400,1626 - TIMESLIP(7) = Z5 * 66 / (TIMESLIP(6) - SaveTime) for 1320ft\r\n      let speed_mph: number;\r\n      if (target === 660 && saveTime_594ft !== null && exactTime > saveTime_594ft) {\r\n        // 8th mile trap speed: 66ft / (time@660 - time@594) * Z5\r\n        // Z5 = 3600/5280 = FPS_TO_MPH, so: 66 / dt * Z5 = 66 / dt * (3600/5280) mph\r\n        speed_mph = FPS_TO_MPH * 66 / (exactTime - saveTime_594ft);\r\n      } else if (target === 1320 && saveTime_1254ft !== null && exactTime > saveTime_1254ft) {\r\n        // 1/4 mile trap speed: 66ft / (time@1320 - time@1254) * Z5\r\n        speed_mph = FPS_TO_MPH * 66 / (exactTime - saveTime_1254ft);\r\n      } else {\r\n        // For other distances (60ft, 330ft, 1000ft), use instantaneous velocity\r\n        speed_mph = state.Vel_ftps * FPS_TO_MPH;\r\n      }\r\n      \r\n      timeslip.push({\r\n        d_ft: target,\r\n        t_s: exactTime,\r\n        v_mph: speed_mph,\r\n      });\r\n      targetIdx++;\r\n    }\r\n    \r\n    // Handle gear shifts - VB6 TIMESLIP.FRM:1355, 1433-1434\r\n    // VB6 uses ShiftFlag state machine:\r\n    // 1. Line 1355: If at shift RPM, set ShiftFlag = 1\r\n    // 2. Line 1433: If ShiftFlag = 1, set ShiftFlag = 2, increment gear, GoTo 230 (DTShift applied)\r\n    // 3. Line 1434: If ShiftFlag = 2, reset ShiftFlag = 0\r\n    if (state.ShiftFlag === 1) {\r\n      // ShiftFlag was set last step - now increment gear and apply DTShift\r\n      state.ShiftFlag = 2;\r\n      state.Gear++;\r\n      // PrevGear will differ from Gear, triggering DTShift in next step\r\n    } else if (state.ShiftFlag === 2) {\r\n      // Shift complete, reset flag\r\n      state.ShiftFlag = 0;\r\n    } else if (state.Gear < vb6Vehicle.NGR) {\r\n      // Check if we should initiate a shift\r\n      const shiftMode = vb6Vehicle.ShiftMode ?? 'rpm';\r\n      \r\n      if (shiftMode === 'time') {\r\n        // Shift by elapsed time\r\n        const shiftTime = vb6Vehicle.ShiftTimes?.[state.Gear - 1];\r\n        if (shiftTime !== undefined && state.time_s >= shiftTime) {\r\n          state.ShiftFlag = 1;\r\n        }\r\n      } else {\r\n        // Shift by RPM (default VB6 behavior)\r\n        const shiftRPM = vb6Vehicle.ShiftRPM[state.Gear - 1] ?? 7000;\r\n        \r\n        // VB6: Shift when RPM reaches or exceeds shift point\r\n        if (state.EngRPM >= shiftRPM) {\r\n          state.ShiftFlag = 1;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  // ========================================================================\r\n  // Build result\r\n  // ========================================================================\r\n  \r\n  // Get final ET and MPH from target distance (or last point)\r\n  const finalResult = timeslip.find(t => t.d_ft === raceLengthFt);\r\n  const et_s = finalResult?.t_s ?? state.time_s;\r\n  const mph = finalResult?.v_mph ?? (state.Vel_ftps * FPS_TO_MPH);\r\n  \r\n  // Convert trace to SimResult format (include all data logger fields)\r\n  const traces = trace.map(t => ({\r\n    t_s: t.t_s,\r\n    s_ft: t.s_ft,\r\n    v_mph: t.v_mph,\r\n    v_fps: t.v_fps,\r\n    a_g: t.a_g,\r\n    rpm: t.rpm,\r\n    dsrpm: t.dsrpm,\r\n    lockRpm: t.lockRpm,\r\n    gear: t.gear,\r\n    slip: t.slip,\r\n    tireSlip: t.tireSlip,\r\n    hp: t.hp,\r\n    dragHp: t.dragHp,\r\n    wheelSpeed_mph: t.wheelSpeed_mph,\r\n  }));\r\n  \r\n  // Build debug data for UI display\r\n  const debugData = {\r\n    fuelType: {\r\n      resolved: fuelString ?? 'unknown',\r\n      fuelSystemType,\r\n      vehicleFuelType: (vehicle as any).fuelType,\r\n      vehicleFuelSystem: (vehicle as any).fuelSystem,\r\n    },\r\n    hpCurve: {\r\n      length: NHP,\r\n      peakHP: Math.max(...yhp),\r\n      rpmRange: `${Math.min(...xrpm)} - ${Math.max(...xrpm)}`,\r\n    },\r\n    airCalc: {\r\n      rho_lbm_ft3,\r\n      hpc,\r\n    },\r\n    simParams: {\r\n      weight: vehicle.weightLb,\r\n      tireDia: tireDiaIn,\r\n      wheelbase: vehicle.wheelbaseIn ?? 100,\r\n      finalDrive,\r\n      NGR,\r\n      peakHP: Math.max(...yhp),\r\n      stallRPM,\r\n      slippage,\r\n      isClutch,\r\n      tractionIndex: vb6Env.TractionIndex,\r\n      trackTempEffect,\r\n      pmi: { engine: enginePMI, trans: transPMI, tires: tiresPMI },\r\n    },\r\n    result: {\r\n      et: et_s,\r\n      mph,\r\n    },\r\n  };\r\n  \r\n  return {\r\n    et_s,\r\n    mph,\r\n    timeslip,\r\n    traces,\r\n    meta: {\r\n      model: 'VB6Exact' as const,\r\n      steps: trace.length,\r\n      warnings,\r\n    },\r\n    vb6Diagnostics: convergenceHistory,\r\n    debugData,\r\n  };\r\n}\r\n\r\n/**\r\n * VB6 Exact Model class for compatibility with existing infrastructure\r\n */\r\nexport const VB6ExactModel = {\r\n  name: 'VB6Exact',\r\n  simulate: simulateVB6Exact,\r\n};\r\n","/**\n * Parity Runner Panel\n * \n * Run benchmark tests and compare VB6Exact against Quarter Pro/Jr targets.\n * Validates simulation accuracy against VB6 printout benchmarks.\n */\n\nimport { useState } from 'react';\nimport { LEGACY_BENCHMARKS, validateAgainstBenchmark, type RaceLength } from '../../domain/physics/fixtures/benchmarks';\nimport { BENCHMARK_CONFIGS, validateBenchmarkConfig } from '../../domain/physics/fixtures/benchmark-configs';\nimport { VB6ExactModel } from '../../domain/physics/models/vb6Exact';\nimport type { SimInputs, SimResult, ExtendedVehicle } from '../../domain/physics';\n\ninterface TestResult {\n  benchmarkName: string;\n  raceLength: RaceLength;\n  targetET: number;\n  targetMPH: number;\n  actualET: number;\n  actualMPH: number;\n  etDelta: number;\n  mphDelta: number;\n  etPass: boolean;\n  mphPass: boolean;\n  pass: boolean;\n  etTolerance: number;\n  mphTolerance: number;\n}\n\nexport default function ParityRunner() {\n  const [selectedBenchmarks, setSelectedBenchmarks] = useState<Set<string>>(new Set());\n  const [selectedLengths, setSelectedLengths] = useState<Set<RaceLength>>(new Set(['QUARTER']));\n  const [running, setRunning] = useState(false);\n  const [results, setResults] = useState<TestResult[]>([]);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleToggleBenchmark = (name: string) => {\n    const newSet = new Set(selectedBenchmarks);\n    if (newSet.has(name)) {\n      newSet.delete(name);\n    } else {\n      newSet.add(name);\n    }\n    setSelectedBenchmarks(newSet);\n  };\n\n  const handleToggleLength = (length: RaceLength) => {\n    const newSet = new Set(selectedLengths);\n    if (newSet.has(length)) {\n      newSet.delete(length);\n    } else {\n      newSet.add(length);\n    }\n    setSelectedLengths(newSet);\n  };\n\n  const handleSelectAll = () => {\n    setSelectedBenchmarks(new Set(LEGACY_BENCHMARKS.map(b => b.name)));\n  };\n\n  const handleSelectNone = () => {\n    setSelectedBenchmarks(new Set());\n  };\n\n  const buildSimInputs = (configName: string, raceLength: RaceLength): SimInputs => {\n    const config = BENCHMARK_CONFIGS[configName];\n    \n    if (!config) {\n      throw new Error(`Benchmark config not found: ${configName}`);\n    }\n\n    // Validate config has all required VB6 parameters\n    validateBenchmarkConfig(config);\n\n    // Build ExtendedVehicle from config\n    const vehicle: ExtendedVehicle = {\n      id: `benchmark_${configName}`,\n      name: configName,\n      weightLb: config.vehicle.weightLb,\n      tireDiaIn: config.vehicle.tireDiaIn ?? (config.vehicle.tireRolloutIn! / Math.PI),\n      rearGear: config.vehicle.rearGear ?? config.vehicle.finalDrive!,\n      rolloutIn: config.vehicle.rolloutIn,\n      powerHP: config.vehicle.torqueCurve ? \n        Math.max(...config.vehicle.torqueCurve.map(p => p.hp ?? 0)) : \n        config.vehicle.powerHP!,\n      defaultRaceLength: raceLength,\n      \n      torqueCurve: config.vehicle.torqueCurve,\n      frontalArea_ft2: config.vehicle.frontalArea_ft2,\n      cd: config.vehicle.cd,\n      gearRatios: config.vehicle.gearRatios,\n      shiftRPM: config.vehicle.shiftRPM,\n      \n      wheelbaseIn: config.vehicle.wheelbaseIn,\n      overhangIn: config.vehicle.overhangIn,\n      tireRolloutIn: config.vehicle.tireRolloutIn,\n      tireWidthIn: config.vehicle.tireWidthIn,\n      liftCoeff: config.vehicle.liftCoeff,\n      rrCoeff: config.vehicle.rrCoeff,\n      \n      finalDrive: config.vehicle.finalDrive ?? config.vehicle.rearGear,\n      transEff: config.vehicle.transEff,\n      gearEff: config.vehicle.gearEff,\n      \n      converter: config.vehicle.converter,\n      clutch: config.vehicle.clutch,\n    };\n\n    return {\n      vehicle,\n      env: {\n        elevation: config.env.elevation,\n        barometerInHg: config.env.barometerInHg,\n        temperatureF: config.env.temperatureF,\n        humidityPct: config.env.humidityPct,\n      },\n      raceLength: raceLength,\n    };\n  };\n\n  const handleRun = async () => {\n    if (selectedBenchmarks.size === 0 || selectedLengths.size === 0) {\n      setError('Please select at least one benchmark and one race length');\n      return;\n    }\n\n    setRunning(true);\n    setError(null);\n    setResults([]);\n\n    const testResults: TestResult[] = [];\n\n    try {\n      for (const benchmarkName of selectedBenchmarks) {\n        const benchmark = LEGACY_BENCHMARKS.find(b => b.name === benchmarkName);\n        if (!benchmark) continue;\n\n        for (const raceLength of selectedLengths) {\n          const target = benchmark.raceLengthTargets[raceLength];\n          if (!target) continue;\n\n          try {\n            // Build inputs\n            const inputs = buildSimInputs(benchmarkName, raceLength);\n            \n            // Run simulation with VB6Exact\n            const result: SimResult = VB6ExactModel.simulate(inputs);\n            \n            // Validate against benchmark\n            const validation = validateAgainstBenchmark(\n              benchmark,\n              raceLength,\n              result.et_s,\n              result.mph\n            );\n\n            testResults.push({\n              benchmarkName,\n              raceLength,\n              targetET: target.et_s,\n              targetMPH: target.mph,\n              actualET: result.et_s,\n              actualMPH: result.mph,\n              etDelta: validation.etDelta,\n              mphDelta: validation.mphDelta,\n              etPass: validation.etPass,\n              mphPass: validation.mphPass,\n              pass: validation.pass,\n              etTolerance: validation.etTolerance,\n              mphTolerance: validation.mphTolerance,\n            });\n          } catch (err) {\n            console.error(`Error running ${benchmarkName} ${raceLength}:`, err);\n            testResults.push({\n              benchmarkName,\n              raceLength,\n              targetET: target.et_s,\n              targetMPH: target.mph,\n              actualET: 0,\n              actualMPH: 0,\n              etDelta: 0,\n              mphDelta: 0,\n              etPass: false,\n              mphPass: false,\n              pass: false,\n              etTolerance: target.tolET_s,\n              mphTolerance: target.tolMPH,\n            });\n          }\n        }\n      }\n\n      setResults(testResults);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : String(err));\n    } finally {\n      setRunning(false);\n    }\n  };\n\n  const handleOpenInRunInspector = (benchmarkName: string) => {\n    // TODO: Load the benchmark fixture into VB6 UI store\n    // For now, just navigate to Run Inspector\n    alert(`TODO: Load ${benchmarkName} fixture into VB6 Inputs and navigate to Run Inspector`);\n    // navigate('/dev', { state: { panel: 'run-inspector' } });\n  };\n\n  const handleExportCsv = () => {\n    if (results.length === 0) {\n      alert('No results to export');\n      return;\n    }\n\n    const headers = [\n      'Benchmark',\n      'Distance',\n      'Target ET (s)',\n      'Actual ET (s)',\n      'ET Delta (s)',\n      'ET Tolerance (s)',\n      'ET Pass',\n      'Target MPH',\n      'Actual MPH',\n      'MPH Delta',\n      'MPH Tolerance',\n      'MPH Pass',\n      'Overall Pass',\n    ];\n\n    const rows = results.map(r => [\n      r.benchmarkName,\n      r.raceLength,\n      r.targetET.toFixed(3),\n      r.actualET.toFixed(3),\n      r.etDelta.toFixed(3),\n      r.etTolerance.toFixed(3),\n      r.etPass ? 'PASS' : 'FAIL',\n      r.targetMPH.toFixed(2),\n      r.actualMPH.toFixed(2),\n      r.mphDelta.toFixed(2),\n      r.mphTolerance.toFixed(2),\n      r.mphPass ? 'PASS' : 'FAIL',\n      r.pass ? 'PASS' : 'FAIL',\n    ]);\n\n    const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\\n');\n    \n    const blob = new Blob([csv], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `parity-results-${Date.now()}.csv`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const passCount = results.filter(r => r.pass).length;\n  const totalCount = results.length;\n\n  return (\n    <div style={{ padding: '2rem', height: '100%', overflow: 'auto' }}>\n      <div style={{ marginBottom: '2rem' }}>\n        <h2 style={{ marginTop: 0, marginBottom: '0.5rem' }}>Parity Runner</h2>\n        <p style={{ color: 'var(--color-muted)', fontSize: '0.875rem', margin: 0 }}>\n          Run benchmark tests and compare VB6Exact against Quarter Pro/Jr targets.\n        </p>\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #ef4444',\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n            fontSize: '0.875rem',\n            color: '#991b1b',\n          }}\n        >\n          {error}\n        </div>\n      )}\n\n      {/* Selection Controls */}\n      <div\n        style={{\n          padding: '1rem',\n          backgroundColor: 'var(--color-surface)',\n          border: '1px solid var(--color-border)',\n          borderRadius: 'var(--radius-md)',\n          marginBottom: '1rem',\n        }}\n      >\n        <h3 style={{ marginTop: 0, marginBottom: '1rem', fontSize: '1rem', fontWeight: '600' }}>\n          Select Benchmarks\n        </h3>\n\n        <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>\n          <button\n            onClick={handleSelectAll}\n            style={{\n              padding: '0.5rem 1rem',\n              fontSize: '0.875rem',\n              backgroundColor: '#6b7280',\n              color: 'white',\n              border: 'none',\n              borderRadius: 'var(--radius-md)',\n              cursor: 'pointer',\n            }}\n          >\n            Select All\n          </button>\n          <button\n            onClick={handleSelectNone}\n            style={{\n              padding: '0.5rem 1rem',\n              fontSize: '0.875rem',\n              backgroundColor: '#6b7280',\n              color: 'white',\n              border: 'none',\n              borderRadius: 'var(--radius-md)',\n              cursor: 'pointer',\n            }}\n          >\n            Select None\n          </button>\n        </div>\n\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '0.5rem', marginBottom: '1rem' }}>\n          {LEGACY_BENCHMARKS.map((benchmark) => (\n            <label\n              key={benchmark.name}\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem',\n                padding: '0.5rem',\n                cursor: 'pointer',\n                fontSize: '0.875rem',\n              }}\n            >\n              <input\n                type=\"checkbox\"\n                checked={selectedBenchmarks.has(benchmark.name)}\n                onChange={() => handleToggleBenchmark(benchmark.name)}\n              />\n              <span>{benchmark.name}</span>\n              <span style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>\n                ({benchmark.source})\n              </span>\n            </label>\n          ))}\n        </div>\n\n        <h3 style={{ marginTop: '1rem', marginBottom: '0.75rem', fontSize: '1rem', fontWeight: '600' }}>\n          Race Lengths\n        </h3>\n\n        <div style={{ display: 'flex', gap: '1rem' }}>\n          <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\n            <input\n              type=\"checkbox\"\n              checked={selectedLengths.has('EIGHTH')}\n              onChange={() => handleToggleLength('EIGHTH')}\n            />\n            <span>EIGHTH (660 ft)</span>\n          </label>\n          <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>\n            <input\n              type=\"checkbox\"\n              checked={selectedLengths.has('QUARTER')}\n              onChange={() => handleToggleLength('QUARTER')}\n            />\n            <span>QUARTER (1320 ft)</span>\n          </label>\n        </div>\n      </div>\n\n      {/* Run Button */}\n      <div style={{ marginBottom: '1rem' }}>\n        <button\n          onClick={handleRun}\n          disabled={running}\n          style={{\n            padding: '0.75rem 1.5rem',\n            fontSize: '0.875rem',\n            fontWeight: '500',\n            backgroundColor: running ? '#9ca3af' : '#10b981',\n            color: 'white',\n            border: 'none',\n            borderRadius: 'var(--radius-md)',\n            cursor: running ? 'not-allowed' : 'pointer',\n          }}\n        >\n          {running ? 'Running...' : 'Run Selected Benchmarks'}\n        </button>\n      </div>\n\n      {/* Results Summary */}\n      {results.length > 0 && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: passCount === totalCount ? '#d1fae5' : '#fee2e2',\n            border: `1px solid ${passCount === totalCount ? '#10b981' : '#ef4444'}`,\n            borderRadius: 'var(--radius-md)',\n            marginBottom: '1rem',\n          }}\n        >\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n            <div style={{ fontSize: '1rem', fontWeight: '600' }}>\n              {passCount === totalCount ? '✓ All Tests Passed' : `⚠ ${totalCount - passCount} Test(s) Failed`}\n            </div>\n            <div style={{ fontSize: '0.875rem' }}>\n              {passCount} / {totalCount} passed\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Results Table */}\n      {results.length > 0 && (\n        <div\n          style={{\n            padding: '1rem',\n            backgroundColor: 'var(--color-surface)',\n            border: '1px solid var(--color-border)',\n            borderRadius: 'var(--radius-md)',\n          }}\n        >\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\n            <h3 style={{ margin: 0, fontSize: '1rem', fontWeight: '600' }}>\n              Results\n            </h3>\n            <button\n              onClick={handleExportCsv}\n              style={{\n                padding: '0.5rem 1rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#6b7280',\n                color: 'white',\n                border: 'none',\n                borderRadius: 'var(--radius-md)',\n                cursor: 'pointer',\n              }}\n            >\n              Export CSV\n            </button>\n          </div>\n\n          <div style={{ overflowX: 'auto' }}>\n            <table\n              style={{\n                width: '100%',\n                fontSize: '0.875rem',\n                borderCollapse: 'collapse',\n              }}\n            >\n              <thead>\n                <tr style={{ backgroundColor: '#1e293b', color: '#e2e8f0' }}>\n                  <th style={{ padding: '0.75rem', textAlign: 'left', borderBottom: '2px solid var(--color-border)' }}>Benchmark</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'center', borderBottom: '2px solid var(--color-border)' }}>Distance</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>Target ET</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>Actual ET</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>ET Δ</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>Target MPH</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>Actual MPH</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'right', borderBottom: '2px solid var(--color-border)' }}>MPH Δ</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'center', borderBottom: '2px solid var(--color-border)' }}>Status</th>\n                  <th style={{ padding: '0.75rem', textAlign: 'center', borderBottom: '2px solid var(--color-border)' }}>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {results.map((result, idx) => (\n                  <tr\n                    key={`${result.benchmarkName}-${result.raceLength}`}\n                    style={{\n                      backgroundColor: idx % 2 === 0 ? 'transparent' : 'rgba(0,0,0,0.02)',\n                    }}\n                  >\n                    <td style={{ padding: '0.75rem', borderBottom: '1px solid var(--color-border)' }}>\n                      {result.benchmarkName}\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'center', borderBottom: '1px solid var(--color-border)' }}>\n                      {result.raceLength}\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                      {result.targetET.toFixed(3)}\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                      {result.actualET.toFixed(3)}\n                    </td>\n                    <td\n                      style={{\n                        padding: '0.75rem',\n                        textAlign: 'right',\n                        fontFamily: 'monospace',\n                        color: result.etPass ? '#10b981' : '#ef4444',\n                        borderBottom: '1px solid var(--color-border)',\n                      }}\n                    >\n                      {result.etDelta >= 0 ? '+' : ''}{result.etDelta.toFixed(3)}\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                      {result.targetMPH.toFixed(2)}\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'right', fontFamily: 'monospace', borderBottom: '1px solid var(--color-border)' }}>\n                      {result.actualMPH.toFixed(2)}\n                    </td>\n                    <td\n                      style={{\n                        padding: '0.75rem',\n                        textAlign: 'right',\n                        fontFamily: 'monospace',\n                        color: result.mphPass ? '#10b981' : '#ef4444',\n                        borderBottom: '1px solid var(--color-border)',\n                      }}\n                    >\n                      {result.mphDelta >= 0 ? '+' : ''}{result.mphDelta.toFixed(2)}\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'center', borderBottom: '1px solid var(--color-border)' }}>\n                      <span\n                        style={{\n                          padding: '0.25rem 0.75rem',\n                          borderRadius: '9999px',\n                          fontSize: '0.75rem',\n                          fontWeight: '600',\n                          backgroundColor: result.pass ? '#10b981' : '#ef4444',\n                          color: 'white',\n                        }}\n                      >\n                        {result.pass ? 'PASS' : 'FAIL'}\n                      </span>\n                    </td>\n                    <td style={{ padding: '0.75rem', textAlign: 'center', borderBottom: '1px solid var(--color-border)' }}>\n                      <button\n                        onClick={() => handleOpenInRunInspector(result.benchmarkName)}\n                        style={{\n                          padding: '0.25rem 0.75rem',\n                          fontSize: '0.75rem',\n                          backgroundColor: '#3b82f6',\n                          color: 'white',\n                          border: 'none',\n                          borderRadius: 'var(--radius-sm)',\n                          cursor: 'pointer',\n                        }}\n                      >\n                        Open in Run Inspector\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\r\n * User Management Panel\r\n * \r\n * Admin panel for managing users, roles, and products.\r\n * Users are stored in the database via API, roles/products in localStorage.\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../domain/auth';\r\nimport { usersApi, type ApiUser } from '../../services/api';\r\nimport type { Role, Product } from '../../domain/auth/types';\r\nimport { ALL_FEATURES } from '../../domain/auth/types';\r\n\r\n// ============================================================================\r\n// Styles\r\n// ============================================================================\r\n\r\nconst styles = {\r\n  container: { padding: '1rem' },\r\n  tabs: { display: 'flex', gap: '0.25rem', marginBottom: '1rem', borderBottom: '1px solid var(--color-border)' },\r\n  tab: {\r\n    padding: '0.75rem 1.5rem',\r\n    border: 'none',\r\n    background: 'transparent',\r\n    cursor: 'pointer',\r\n    fontSize: '0.875rem',\r\n    fontWeight: 500,\r\n    color: 'var(--color-muted)',\r\n    borderBottom: '2px solid transparent',\r\n    marginBottom: '-1px',\r\n  },\r\n  tabActive: {\r\n    color: 'var(--color-primary)',\r\n    borderBottomColor: 'var(--color-primary)',\r\n  },\r\n  section: { marginBottom: '1.5rem' },\r\n  sectionHeader: {\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: '0.75rem',\r\n  },\r\n  sectionTitle: {\r\n    fontSize: '0.875rem',\r\n    fontWeight: 600,\r\n    textTransform: 'uppercase' as const,\r\n    color: 'var(--color-muted)',\r\n  },\r\n  card: {\r\n    backgroundColor: 'var(--color-background)',\r\n    border: '1px solid var(--color-border)',\r\n    borderRadius: 'var(--radius-md)',\r\n    overflow: 'hidden',\r\n  },\r\n  row: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '1rem',\r\n    padding: '0.75rem 1rem',\r\n    borderBottom: '1px solid var(--color-border)',\r\n  },\r\n  badge: {\r\n    padding: '0.25rem 0.5rem',\r\n    borderRadius: '9999px',\r\n    fontSize: '0.75rem',\r\n    fontWeight: 600,\r\n  },\r\n  button: {\r\n    padding: '0.5rem 1rem',\r\n    borderRadius: 'var(--radius-sm)',\r\n    border: 'none',\r\n    cursor: 'pointer',\r\n    fontSize: '0.875rem',\r\n    fontWeight: 500,\r\n  },\r\n  primaryBtn: { backgroundColor: 'var(--color-primary)', color: 'white' },\r\n  secondaryBtn: { backgroundColor: 'var(--color-surface)', color: 'var(--color-text)', border: '1px solid var(--color-border)' },\r\n  dangerBtn: { backgroundColor: '#dc2626', color: 'white' },\r\n  smallBtn: { padding: '0.25rem 0.5rem', fontSize: '0.75rem' },\r\n  input: {\r\n    width: '100%',\r\n    padding: '0.5rem',\r\n    borderRadius: 'var(--radius-sm)',\r\n    border: '1px solid var(--color-border)',\r\n    backgroundColor: 'var(--color-background)',\r\n    color: 'var(--color-text)',\r\n    fontSize: '0.875rem',\r\n  },\r\n  formGroup: { marginBottom: '1rem' },\r\n  label: { display: 'block', fontSize: '0.875rem', fontWeight: 500, marginBottom: '0.25rem' },\r\n  modal: {\r\n    position: 'fixed' as const,\r\n    inset: 0,\r\n    backgroundColor: 'rgba(0,0,0,0.5)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    zIndex: 1000,\r\n  },\r\n  modalContent: {\r\n    backgroundColor: 'var(--color-surface)',\r\n    borderRadius: 'var(--radius-lg)',\r\n    padding: '1.5rem',\r\n    width: '500px',\r\n    maxWidth: '90vw',\r\n    maxHeight: '90vh',\r\n    overflow: 'auto',\r\n  },\r\n  checkboxGrid: {\r\n    display: 'grid',\r\n    gridTemplateColumns: 'repeat(auto-fill, minmax(150px, 1fr))',\r\n    gap: '0.5rem',\r\n  },\r\n  checkbox: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '0.5rem',\r\n    fontSize: '0.75rem',\r\n  },\r\n};\r\n\r\n// ============================================================================\r\n// Tab Types\r\n// ============================================================================\r\n\r\ntype TabId = 'users' | 'roles' | 'products';\r\n\r\n// ============================================================================\r\n// User Edit Modal (for API users)\r\n// ============================================================================\r\n\r\n// Available products for user assignment\r\nconst AVAILABLE_PRODUCTS = [\r\n  { id: 'quarter_jr', name: 'Quarter Jr' },\r\n  { id: 'quarter_pro', name: 'Quarter Pro' },\r\n  { id: 'bonneville_pro', name: 'Bonneville Pro' },\r\n  { id: 'engine_pro', name: 'Engine Pro' },\r\n  { id: 'fourlink', name: 'Four Link' },\r\n  { id: 'cam_analyzer', name: 'Cam Analyzer' },\r\n];\r\n\r\nfunction UserModal({ \r\n  user, \r\n  onClose, \r\n  onSave, \r\n  onDelete \r\n}: { \r\n  user: ApiUser | null; \r\n  onClose: () => void; \r\n  onSave: (data: { email: string; name: string; password?: string; role: string; products: string[] }) => void;\r\n  onDelete?: () => void;\r\n}) {\r\n  const [email, setEmail] = useState(user?.email || '');\r\n  const [name, setName] = useState(user?.name || '');\r\n  const [role, setRole] = useState<string>(user?.role || 'user');\r\n  const [products, setProducts] = useState<string[]>(user?.products || []);\r\n  const [password, setPassword] = useState('');\r\n\r\n  const toggleProduct = (productId: string) => {\r\n    setProducts(prev => \r\n      prev.includes(productId) \r\n        ? prev.filter(p => p !== productId) \r\n        : [...prev, productId]\r\n    );\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onSave({ email, name, role, products, ...(password ? { password } : {}) });\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <div style={styles.modal} onClick={onClose}>\r\n      <div style={styles.modalContent} onClick={e => e.stopPropagation()}>\r\n        <h3 style={{ marginTop: 0 }}>{user ? 'Edit User' : 'Create User'}</h3>\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Email</label>\r\n            <input style={styles.input} type=\"email\" value={email} onChange={e => setEmail(e.target.value)} required disabled={!!user} />\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Name</label>\r\n            <input style={styles.input} type=\"text\" value={name} onChange={e => setName(e.target.value)} required />\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Role</label>\r\n            <select style={styles.input} value={role} onChange={e => setRole(e.target.value)}>\r\n              <option value=\"user\">User</option>\r\n              <option value=\"beta\">Beta Tester</option>\r\n              <option value=\"admin\">Admin</option>\r\n              <option value=\"owner\">Owner</option>\r\n            </select>\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Products</label>\r\n            <div style={styles.checkboxGrid}>\r\n              {AVAILABLE_PRODUCTS.map(p => (\r\n                <label key={p.id} style={styles.checkbox}>\r\n                  <input \r\n                    type=\"checkbox\" \r\n                    checked={products.includes(p.id)} \r\n                    onChange={() => toggleProduct(p.id)} \r\n                  />\r\n                  {p.name}\r\n                </label>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>{user ? 'New Password (leave blank to keep)' : 'Password'}</label>\r\n            <input style={styles.input} type=\"password\" value={password} onChange={e => setPassword(e.target.value)} {...(!user && { required: true, minLength: 6 })} />\r\n          </div>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '1rem' }}>\r\n            {user && onDelete && (\r\n              <button type=\"button\" style={{ ...styles.button, ...styles.dangerBtn }} onClick={() => { onDelete(); onClose(); }}>Delete</button>\r\n            )}\r\n            <div style={{ display: 'flex', gap: '0.5rem', marginLeft: 'auto' }}>\r\n              <button type=\"button\" style={{ ...styles.button, ...styles.secondaryBtn }} onClick={onClose}>Cancel</button>\r\n              <button type=\"submit\" style={{ ...styles.button, ...styles.primaryBtn }}>{user ? 'Save' : 'Create'}</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Role Edit Modal\r\n// ============================================================================\r\n\r\nfunction RoleModal({ \r\n  role, \r\n  products, \r\n  onClose, \r\n  onSave, \r\n  onDelete \r\n}: { \r\n  role: Role | null; \r\n  products: Product[];\r\n  onClose: () => void; \r\n  onSave: (data: Omit<Role, 'id'>) => void;\r\n  onDelete?: () => void;\r\n}) {\r\n  const [name, setName] = useState(role?.name || '');\r\n  const [description, setDescription] = useState(role?.description || '');\r\n  const [color, setColor] = useState(role?.color || '#6b7280');\r\n  const [selectedProducts, setSelectedProducts] = useState<string[]>(role?.products || []);\r\n  const [additionalFeatures, setAdditionalFeatures] = useState<string[]>(role?.additionalFeatures || []);\r\n  const [canManageUsers, setCanManageUsers] = useState(role?.canManageUsers || false);\r\n  const [canManageRoles, setCanManageRoles] = useState(role?.canManageRoles || false);\r\n  const [sortOrder, setSortOrder] = useState(role?.sortOrder || 50);\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onSave({\r\n      name, description, color,\r\n      products: selectedProducts,\r\n      additionalFeatures,\r\n      canManageUsers, canManageRoles,\r\n      isSystem: role?.isSystem || false,\r\n      sortOrder,\r\n    });\r\n    onClose();\r\n  };\r\n\r\n  const toggleProduct = (id: string) => {\r\n    setSelectedProducts(prev => prev.includes(id) ? prev.filter(p => p !== id) : [...prev, id]);\r\n  };\r\n\r\n  const toggleFeature = (f: string) => {\r\n    setAdditionalFeatures(prev => prev.includes(f) ? prev.filter(x => x !== f) : [...prev, f]);\r\n  };\r\n\r\n  return (\r\n    <div style={styles.modal} onClick={onClose}>\r\n      <div style={styles.modalContent} onClick={e => e.stopPropagation()}>\r\n        <h3 style={{ marginTop: 0 }}>{role ? 'Edit Role' : 'Create Role'}</h3>\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 100px', gap: '1rem' }}>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Name</label>\r\n              <input style={styles.input} value={name} onChange={e => setName(e.target.value)} required />\r\n            </div>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Color</label>\r\n              <input type=\"color\" style={{ ...styles.input, height: '38px', padding: '2px' }} value={color} onChange={e => setColor(e.target.value)} />\r\n            </div>\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Description</label>\r\n            <textarea style={{ ...styles.input, minHeight: '50px' }} value={description} onChange={e => setDescription(e.target.value)} />\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Products Access</label>\r\n            <div style={styles.checkboxGrid}>\r\n              {products.map(p => (\r\n                <label key={p.id} style={styles.checkbox}>\r\n                  <input type=\"checkbox\" checked={selectedProducts.includes(p.id)} onChange={() => toggleProduct(p.id)} />\r\n                  <span style={{ color: p.color }}>{p.icon}</span> {p.name}\r\n                </label>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Additional Features</label>\r\n            <div style={styles.checkboxGrid}>\r\n              {ALL_FEATURES.filter(f => ['dev_tools', 'user_management', 'role_management', 'system_settings', 'view_analytics', 'beta_features'].includes(f)).map(f => (\r\n                <label key={f} style={styles.checkbox}>\r\n                  <input type=\"checkbox\" checked={additionalFeatures.includes(f)} onChange={() => toggleFeature(f)} />\r\n                  {f.replace(/_/g, ' ')}\r\n                </label>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '1rem' }}>\r\n            <label style={styles.checkbox}>\r\n              <input type=\"checkbox\" checked={canManageUsers} onChange={e => setCanManageUsers(e.target.checked)} />\r\n              Can Manage Users\r\n            </label>\r\n            <label style={styles.checkbox}>\r\n              <input type=\"checkbox\" checked={canManageRoles} onChange={e => setCanManageRoles(e.target.checked)} />\r\n              Can Manage Roles\r\n            </label>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Sort Order</label>\r\n              <input type=\"number\" style={styles.input} value={sortOrder} onChange={e => setSortOrder(parseInt(e.target.value) || 0)} />\r\n            </div>\r\n          </div>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '1rem' }}>\r\n            {role && !role.isSystem && onDelete && (\r\n              <button type=\"button\" style={{ ...styles.button, ...styles.dangerBtn }} onClick={() => { onDelete(); onClose(); }}>Delete</button>\r\n            )}\r\n            <div style={{ display: 'flex', gap: '0.5rem', marginLeft: 'auto' }}>\r\n              <button type=\"button\" style={{ ...styles.button, ...styles.secondaryBtn }} onClick={onClose}>Cancel</button>\r\n              <button type=\"submit\" style={{ ...styles.button, ...styles.primaryBtn }}>{role ? 'Save' : 'Create'}</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Product Edit Modal\r\n// ============================================================================\r\n\r\nfunction ProductModal({ \r\n  product, \r\n  onClose, \r\n  onSave, \r\n  onDelete \r\n}: { \r\n  product: Product | null; \r\n  onClose: () => void; \r\n  onSave: (data: Omit<Product, 'id'>) => void;\r\n  onDelete?: () => void;\r\n}) {\r\n  const [name, setName] = useState(product?.name || '');\r\n  const [description, setDescription] = useState(product?.description || '');\r\n  const [icon, setIcon] = useState(product?.icon || '📦');\r\n  const [color, setColor] = useState(product?.color || '#6b7280');\r\n  const [features, setFeatures] = useState<string[]>(product?.features || []);\r\n  const [isPremium, setIsPremium] = useState(product?.isPremium || false);\r\n  const [sortOrder, setSortOrder] = useState(product?.sortOrder || 50);\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onSave({ name, description, icon, color, features, isPremium, sortOrder });\r\n    onClose();\r\n  };\r\n\r\n  const toggleFeature = (f: string) => {\r\n    setFeatures(prev => prev.includes(f) ? prev.filter(x => x !== f) : [...prev, f]);\r\n  };\r\n\r\n  return (\r\n    <div style={styles.modal} onClick={onClose}>\r\n      <div style={styles.modalContent} onClick={e => e.stopPropagation()}>\r\n        <h3 style={{ marginTop: 0 }}>{product ? 'Edit Product' : 'Create Product'}</h3>\r\n        <form onSubmit={handleSubmit}>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '60px 1fr 100px', gap: '1rem' }}>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Icon</label>\r\n              <input style={{ ...styles.input, textAlign: 'center', fontSize: '1.5rem' }} value={icon} onChange={e => setIcon(e.target.value)} />\r\n            </div>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Name</label>\r\n              <input style={styles.input} value={name} onChange={e => setName(e.target.value)} required />\r\n            </div>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Color</label>\r\n              <input type=\"color\" style={{ ...styles.input, height: '38px', padding: '2px' }} value={color} onChange={e => setColor(e.target.value)} />\r\n            </div>\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Description</label>\r\n            <textarea style={{ ...styles.input, minHeight: '50px' }} value={description} onChange={e => setDescription(e.target.value)} />\r\n          </div>\r\n          <div style={styles.formGroup}>\r\n            <label style={styles.label}>Features</label>\r\n            <div style={styles.checkboxGrid}>\r\n              {ALL_FEATURES.filter(f => !['dev_tools', 'user_management', 'role_management', 'system_settings', 'view_analytics', 'beta_features'].includes(f)).map(f => (\r\n                <label key={f} style={styles.checkbox}>\r\n                  <input type=\"checkbox\" checked={features.includes(f)} onChange={() => toggleFeature(f)} />\r\n                  {f.replace(/_/g, ' ')}\r\n                </label>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>\r\n            <label style={styles.checkbox}>\r\n              <input type=\"checkbox\" checked={isPremium} onChange={e => setIsPremium(e.target.checked)} />\r\n              Premium Product\r\n            </label>\r\n            <div style={styles.formGroup}>\r\n              <label style={styles.label}>Sort Order</label>\r\n              <input type=\"number\" style={styles.input} value={sortOrder} onChange={e => setSortOrder(parseInt(e.target.value) || 0)} />\r\n            </div>\r\n          </div>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '1rem' }}>\r\n            {product && onDelete && (\r\n              <button type=\"button\" style={{ ...styles.button, ...styles.dangerBtn }} onClick={() => { onDelete(); onClose(); }}>Delete</button>\r\n            )}\r\n            <div style={{ display: 'flex', gap: '0.5rem', marginLeft: 'auto' }}>\r\n              <button type=\"button\" style={{ ...styles.button, ...styles.secondaryBtn }} onClick={onClose}>Cancel</button>\r\n              <button type=\"submit\" style={{ ...styles.button, ...styles.primaryBtn }}>{product ? 'Save' : 'Create'}</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Main Component\r\n// ============================================================================\r\n\r\nexport default function UserManagement() {\r\n  const auth = useAuth();\r\n  const [activeTab, setActiveTab] = useState<TabId>('users');\r\n  const [editingUser, setEditingUser] = useState<ApiUser | null | 'new'>(null);\r\n  const [editingRole, setEditingRole] = useState<Role | null | 'new'>(null);\r\n  const [editingProduct, setEditingProduct] = useState<Product | null | 'new'>(null);\r\n  \r\n  // API users state\r\n  const [apiUsers, setApiUsers] = useState<ApiUser[]>([]);\r\n  const [loadingUsers, setLoadingUsers] = useState(true);\r\n  const [userError, setUserError] = useState<string | null>(null);\r\n\r\n  const roles = auth.getAllRoles();\r\n  const products = auth.getAllProducts();\r\n  \r\n  // Load users from API\r\n  const loadUsers = async () => {\r\n    setLoadingUsers(true);\r\n    setUserError(null);\r\n    try {\r\n      const response = await usersApi.getAll();\r\n      setApiUsers(response.users);\r\n    } catch (err: any) {\r\n      setUserError(err.message || 'Failed to load users');\r\n    } finally {\r\n      setLoadingUsers(false);\r\n    }\r\n  };\r\n  \r\n  useEffect(() => {\r\n    loadUsers();\r\n  }, []);\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      {/* Debug Info */}\r\n      <div style={{ \r\n        marginBottom: '1rem', \r\n        padding: '0.75rem', \r\n        backgroundColor: '#fef3c7', \r\n        borderRadius: 'var(--radius-sm)',\r\n        fontSize: '0.75rem',\r\n      }}>\r\n        <strong>Current User:</strong> {auth.user?.email} (Role: {auth.user?.roleId})<br/>\r\n        <strong>User Role Object:</strong> {auth.getUserRole()?.name || 'NOT FOUND'}<br/>\r\n        <strong>Products:</strong> {auth.getUserRole()?.products?.join(', ') || 'NONE'}<br/>\r\n        <button \r\n          onClick={() => { auth.resetAuthData(); window.location.reload(); }}\r\n          style={{ ...styles.button, ...styles.dangerBtn, marginTop: '0.5rem' }}\r\n        >\r\n          🔄 Reset All Auth Data\r\n        </button>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div style={styles.tabs}>\r\n        {(['users', 'roles', 'products'] as TabId[]).map(tab => (\r\n          <button\r\n            key={tab}\r\n            style={{ ...styles.tab, ...(activeTab === tab ? styles.tabActive : {}) }}\r\n            onClick={() => setActiveTab(tab)}\r\n          >\r\n            {tab === 'users' ? `👥 Users (${apiUsers.length})` : tab === 'roles' ? `🎭 Roles (${roles.length})` : `📦 Products (${products.length})`}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Users Tab */}\r\n      {activeTab === 'users' && (\r\n        <div style={styles.section}>\r\n          <div style={styles.sectionHeader}>\r\n            <span style={styles.sectionTitle}>Database Users (API)</span>\r\n            <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n              <button style={{ ...styles.button, ...styles.secondaryBtn }} onClick={loadUsers}>🔄 Refresh</button>\r\n              <button style={{ ...styles.button, ...styles.primaryBtn }} onClick={() => setEditingUser('new')}>+ Add User</button>\r\n            </div>\r\n          </div>\r\n          {userError && (\r\n            <div style={{ padding: '0.75rem', backgroundColor: '#fee2e2', color: '#991b1b', borderRadius: 'var(--radius-sm)', marginBottom: '0.5rem' }}>\r\n              {userError}\r\n            </div>\r\n          )}\r\n          {loadingUsers ? (\r\n            <div style={{ padding: '1rem', textAlign: 'center', color: 'var(--color-muted)' }}>Loading users...</div>\r\n          ) : (\r\n            <div style={styles.card}>\r\n              {apiUsers.map((user: ApiUser) => {\r\n                const roleColors: Record<string, string> = { owner: '#7c3aed', admin: '#dc2626', beta: '#2563eb', user: '#6b7280' };\r\n                return (\r\n                  <div key={user.id} style={styles.row}>\r\n                    <div style={{ flex: 1 }}>\r\n                      <div style={{ fontWeight: 500 }}>{user.name}</div>\r\n                      <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>{user.email}</div>\r\n                    </div>\r\n                    <span style={{ ...styles.badge, backgroundColor: roleColors[user.role] || '#6b7280', color: 'white' }}>{user.role}</span>\r\n                    <span style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>{user.products?.join(', ') || 'no products'}</span>\r\n                    <button style={{ ...styles.button, ...styles.secondaryBtn, ...styles.smallBtn }} onClick={() => setEditingUser(user)}>Edit</button>\r\n                  </div>\r\n                );\r\n              })}\r\n              {apiUsers.length === 0 && (\r\n                <div style={{ padding: '1rem', textAlign: 'center', color: 'var(--color-muted)' }}>No users found</div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Roles Tab */}\r\n      {activeTab === 'roles' && (\r\n        <div style={styles.section}>\r\n          <div style={styles.sectionHeader}>\r\n            <span style={styles.sectionTitle}>All Roles</span>\r\n            <button style={{ ...styles.button, ...styles.primaryBtn }} onClick={() => setEditingRole('new')}>+ Add Role</button>\r\n          </div>\r\n          <div style={styles.card}>\r\n            {roles.map((role: Role) => (\r\n              <div key={role.id} style={styles.row}>\r\n                <span style={{ ...styles.badge, backgroundColor: role.color, color: 'white' }}>{role.name}</span>\r\n                <div style={{ flex: 1, fontSize: '0.75rem', color: 'var(--color-muted)' }}>{role.description}</div>\r\n                <div style={{ fontSize: '0.75rem' }}>\r\n                  {role.products.length} products, {role.additionalFeatures.length} features\r\n                </div>\r\n                {role.isSystem && <span style={{ ...styles.badge, backgroundColor: '#f3f4f6', color: '#4b5563' }}>System</span>}\r\n                <button style={{ ...styles.button, ...styles.secondaryBtn, ...styles.smallBtn }} onClick={() => setEditingRole(role)}>Edit</button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Products Tab */}\r\n      {activeTab === 'products' && (\r\n        <div style={styles.section}>\r\n          <div style={styles.sectionHeader}>\r\n            <span style={styles.sectionTitle}>All Products</span>\r\n            <button style={{ ...styles.button, ...styles.primaryBtn }} onClick={() => setEditingProduct('new')}>+ Add Product</button>\r\n          </div>\r\n          <div style={styles.card}>\r\n            {products.map((product: Product) => (\r\n              <div key={product.id} style={styles.row}>\r\n                <span style={{ fontSize: '1.5rem' }}>{product.icon}</span>\r\n                <div style={{ flex: 1 }}>\r\n                  <div style={{ fontWeight: 500, color: product.color }}>{product.name}</div>\r\n                  <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)' }}>{product.description}</div>\r\n                </div>\r\n                <div style={{ fontSize: '0.75rem' }}>{product.features.length} features</div>\r\n                {product.isPremium && <span style={{ ...styles.badge, backgroundColor: '#fef3c7', color: '#92400e' }}>Premium</span>}\r\n                <button style={{ ...styles.button, ...styles.secondaryBtn, ...styles.smallBtn }} onClick={() => setEditingProduct(product)}>Edit</button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modals */}\r\n      {editingUser && (\r\n        <UserModal\r\n          user={editingUser === 'new' ? null : editingUser}\r\n          onClose={() => setEditingUser(null)}\r\n          onSave={async (data) => {\r\n            try {\r\n              if (editingUser === 'new') {\r\n                await usersApi.create({ email: data.email, password: data.password!, name: data.name, role: data.role, products: data.products });\r\n              } else {\r\n                await usersApi.update(editingUser.id, { name: data.name, role: data.role, products: data.products });\r\n              }\r\n              loadUsers();\r\n            } catch (err: any) {\r\n              alert(err.message || 'Failed to save user');\r\n            }\r\n          }}\r\n          onDelete={editingUser !== 'new' ? async () => { await usersApi.delete(editingUser.id); loadUsers(); } : undefined}\r\n        />\r\n      )}\r\n      {editingRole && (\r\n        <RoleModal\r\n          role={editingRole === 'new' ? null : editingRole}\r\n          products={products}\r\n          onClose={() => setEditingRole(null)}\r\n          onSave={(data) => {\r\n            if (editingRole === 'new') auth.createRole(data);\r\n            else auth.updateRole(editingRole.id, data);\r\n          }}\r\n          onDelete={editingRole !== 'new' ? () => auth.deleteRole(editingRole.id) : undefined}\r\n        />\r\n      )}\r\n      {editingProduct && (\r\n        <ProductModal\r\n          product={editingProduct === 'new' ? null : editingProduct}\r\n          onClose={() => setEditingProduct(null)}\r\n          onSave={(data) => {\r\n            if (editingProduct === 'new') auth.createProduct(data);\r\n            else auth.updateProduct(editingProduct.id, data);\r\n          }}\r\n          onDelete={editingProduct !== 'new' ? () => auth.deleteProduct(editingProduct.id) : undefined}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","/**\r\n * Track Editor Panel\r\n * \r\n * Manage drag racing tracks with coordinates, elevation, and track angle.\r\n * Tracks are used for weather lookup and wind angle correction.\r\n * Tracks are stored in the database and shared across all users.\r\n * Only admins/owners can add/edit/delete tracks.\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { \r\n  TRACKS, \r\n  type Track, \r\n  loadTracksFromAPI, \r\n  saveTrackToAPI, \r\n  updateTrackInAPI, \r\n  deleteTrackFromAPI \r\n} from '../../domain/config/tracks';\r\nimport { useAuth } from '../../domain/auth/authStore';\r\n\r\nexport default function TrackEditor() {\r\n  const { user } = useAuth();\r\n  const [apiTracks, setApiTracks] = useState<Track[]>([]);\r\n  const [editingTrack, setEditingTrack] = useState<Track | null>(null);\r\n  const [isNew, setIsNew] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState<{ type: 'error' | 'success'; text: string } | null>(null);\r\n\r\n  const isAdmin = user?.roleId === 'admin' || user?.roleId === 'owner';\r\n  const isOwner = user?.roleId === 'owner';\r\n\r\n  // Load API tracks on mount\r\n  useEffect(() => {\r\n    loadTracksFromAPI().then(setApiTracks);\r\n  }, []);\r\n\r\n  // All tracks combined (built-in + API)\r\n  const allTracks = [...TRACKS, ...apiTracks.filter(t => !TRACKS.some(bt => bt.id === t.id))];\r\n  \r\n  // Filtered tracks\r\n  const filteredTracks = searchQuery\r\n    ? allTracks.filter(t => \r\n        t.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        t.city.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        t.state.toLowerCase().includes(searchQuery.toLowerCase())\r\n      )\r\n    : allTracks;\r\n\r\n  const handleNewTrack = () => {\r\n    if (!isAdmin) {\r\n      setMessage({ type: 'error', text: 'Only admins can add tracks' });\r\n      return;\r\n    }\r\n    setEditingTrack({\r\n      id: `custom_${Date.now()}`,\r\n      name: '',\r\n      city: '',\r\n      state: '',\r\n      country: 'USA',\r\n      lat: 0,\r\n      lon: 0,\r\n      elevation_ft: 0,\r\n      length: '1/4',\r\n    });\r\n    setIsNew(true);\r\n  };\r\n\r\n  const handleEditTrack = (track: Track) => {\r\n    if (!isAdmin) {\r\n      setMessage({ type: 'error', text: 'Only admins can edit tracks' });\r\n      return;\r\n    }\r\n    // Only allow editing API tracks (not built-in)\r\n    if (TRACKS.some(t => t.id === track.id)) {\r\n      setMessage({ type: 'error', text: 'Built-in tracks cannot be edited. Create a copy instead.' });\r\n      return;\r\n    }\r\n    setEditingTrack({ ...track });\r\n    setIsNew(false);\r\n  };\r\n\r\n  const handleCopyTrack = (track: Track) => {\r\n    if (!isAdmin) {\r\n      setMessage({ type: 'error', text: 'Only admins can add tracks' });\r\n      return;\r\n    }\r\n    setEditingTrack({\r\n      ...track,\r\n      id: `custom_${Date.now()}`,\r\n      name: `${track.name} (Copy)`,\r\n    });\r\n    setIsNew(true);\r\n  };\r\n\r\n  const handleSaveTrack = async () => {\r\n    if (!editingTrack) return;\r\n    \r\n    if (!editingTrack.name.trim()) {\r\n      setMessage({ type: 'error', text: 'Track name is required' });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setMessage(null);\r\n\r\n    try {\r\n      if (isNew) {\r\n        const result = await saveTrackToAPI(editingTrack);\r\n        if (!result.success) {\r\n          setMessage({ type: 'error', text: result.error || 'Failed to save track' });\r\n          return;\r\n        }\r\n      } else {\r\n        const result = await updateTrackInAPI(editingTrack.id, editingTrack);\r\n        if (!result.success) {\r\n          setMessage({ type: 'error', text: result.error || 'Failed to update track' });\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Reload tracks\r\n      const tracks = await loadTracksFromAPI();\r\n      setApiTracks(tracks);\r\n      setEditingTrack(null);\r\n      setIsNew(false);\r\n      setMessage({ type: 'success', text: isNew ? 'Track added successfully' : 'Track updated successfully' });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteTrack = async (trackId: string) => {\r\n    if (!isOwner) {\r\n      setMessage({ type: 'error', text: 'Only owners can delete tracks' });\r\n      return;\r\n    }\r\n    if (TRACKS.some(t => t.id === trackId)) {\r\n      setMessage({ type: 'error', text: 'Built-in tracks cannot be deleted.' });\r\n      return;\r\n    }\r\n    if (!confirm('Delete this track?')) return;\r\n    \r\n    setLoading(true);\r\n    const result = await deleteTrackFromAPI(trackId);\r\n    if (result.success) {\r\n      const tracks = await loadTracksFromAPI();\r\n      setApiTracks(tracks);\r\n      setMessage({ type: 'success', text: 'Track deleted' });\r\n    } else {\r\n      setMessage({ type: 'error', text: result.error || 'Failed to delete track' });\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const isBuiltIn = (trackId: string) => TRACKS.some(t => t.id === trackId);\r\n  // Check if track is from API (not built-in)\r\n  const _isApiTrack = (trackId: string) => apiTracks.some(t => t.id === trackId);\r\n  void _isApiTrack; // Suppress unused warning - will be used for edit permissions\r\n\r\n  return (\r\n    <div>\r\n      {message && (\r\n        <div style={{ \r\n          padding: '10px 16px', \r\n          marginBottom: '1rem', \r\n          borderRadius: '6px',\r\n          backgroundColor: message.type === 'error' ? 'rgba(239, 68, 68, 0.1)' : 'rgba(34, 197, 94, 0.1)',\r\n          color: message.type === 'error' ? '#ef4444' : '#22c55e',\r\n          border: `1px solid ${message.type === 'error' ? '#ef4444' : '#22c55e'}`,\r\n        }}>\r\n          {message.text}\r\n        </div>\r\n      )}\r\n      \r\n      <div style={{ marginBottom: '1rem', display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>\r\n        <button\r\n          onClick={handleNewTrack}\r\n          className=\"btn\"\r\n          style={{ backgroundColor: isAdmin ? 'var(--color-primary)' : 'var(--color-muted)' }}\r\n          disabled={!isAdmin || loading}\r\n        >\r\n          + Add Track\r\n        </button>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search tracks...\"\r\n          value={searchQuery}\r\n          onChange={(e) => setSearchQuery(e.target.value)}\r\n          className=\"input\"\r\n          style={{ width: '200px' }}\r\n        />\r\n        <span style={{ color: 'var(--color-muted)', fontSize: '0.85rem' }}>\r\n          {filteredTracks.length} tracks ({apiTracks.length} custom)\r\n        </span>\r\n        {!isAdmin && (\r\n          <span style={{ color: 'var(--color-muted)', fontSize: '0.8rem', fontStyle: 'italic' }}>\r\n            (Admin access required to edit)\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {/* Track Editor Form */}\r\n      {editingTrack && (\r\n        <div className=\"card\" style={{ marginBottom: '1rem', padding: '1rem' }}>\r\n          <h4 style={{ marginBottom: '1rem' }}>{isNew ? 'New Track' : 'Edit Track'}</h4>\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>\r\n            <div>\r\n              <label className=\"label\">Track Name *</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"input\"\r\n                value={editingTrack.name}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, name: e.target.value })}\r\n                placeholder=\"e.g., My Local Dragstrip\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">City</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"input\"\r\n                value={editingTrack.city}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, city: e.target.value })}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">State</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"input\"\r\n                value={editingTrack.state}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, state: e.target.value })}\r\n                maxLength={2}\r\n                style={{ width: '60px' }}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">Latitude</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"input\"\r\n                step=\"0.0001\"\r\n                value={editingTrack.lat}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, lat: parseFloat(e.target.value) || 0 })}\r\n                placeholder=\"e.g., 34.0589\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">Longitude</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"input\"\r\n                step=\"0.0001\"\r\n                value={editingTrack.lon}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, lon: parseFloat(e.target.value) || 0 })}\r\n                placeholder=\"e.g., -117.7517\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">Elevation (ft)</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"input\"\r\n                value={editingTrack.elevation_ft}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, elevation_ft: parseInt(e.target.value) || 0 })}\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">Track Angle (°)</label>\r\n              <input\r\n                type=\"number\"\r\n                className=\"input\"\r\n                step=\"1\"\r\n                min=\"0\"\r\n                max=\"359\"\r\n                value={(editingTrack as any).trackAngle ?? 0}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, trackAngle: parseInt(e.target.value) || 0 } as any)}\r\n                placeholder=\"0 = North\"\r\n              />\r\n              <div style={{ fontSize: '0.75rem', color: 'var(--color-muted)', marginTop: '4px' }}>\r\n                Direction track points (0=N, 90=E, 180=S, 270=W)\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <label className=\"label\">Track Length</label>\r\n              <select\r\n                className=\"input\"\r\n                value={editingTrack.length}\r\n                onChange={(e) => setEditingTrack({ ...editingTrack, length: e.target.value as '1/8' | '1/4' | 'both' })}\r\n              >\r\n                <option value=\"1/4\">1/4 Mile</option>\r\n                <option value=\"1/8\">1/8 Mile</option>\r\n                <option value=\"both\">Both</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div style={{ marginTop: '1rem', display: 'flex', gap: '0.5rem' }}>\r\n            <button onClick={handleSaveTrack} className=\"btn\" style={{ backgroundColor: 'var(--color-primary)' }}>\r\n              Save Track\r\n            </button>\r\n            <button onClick={() => { setEditingTrack(null); setIsNew(false); }} className=\"btn\">\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Track List */}\r\n      <div style={{ overflowX: 'auto' }}>\r\n        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '0.85rem' }}>\r\n          <thead>\r\n            <tr style={{ borderBottom: '2px solid var(--color-border)' }}>\r\n              <th style={{ textAlign: 'left', padding: '8px' }}>Track Name</th>\r\n              <th style={{ textAlign: 'left', padding: '8px' }}>Location</th>\r\n              <th style={{ textAlign: 'right', padding: '8px' }}>Lat</th>\r\n              <th style={{ textAlign: 'right', padding: '8px' }}>Lon</th>\r\n              <th style={{ textAlign: 'right', padding: '8px' }}>Elev (ft)</th>\r\n              <th style={{ textAlign: 'right', padding: '8px' }}>Angle</th>\r\n              <th style={{ textAlign: 'center', padding: '8px' }}>Length</th>\r\n              <th style={{ textAlign: 'center', padding: '8px' }}>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredTracks.map(track => (\r\n              <tr \r\n                key={track.id} \r\n                style={{ \r\n                  borderBottom: '1px solid var(--color-border)',\r\n                  backgroundColor: isBuiltIn(track.id) ? 'transparent' : 'rgba(34, 197, 94, 0.05)',\r\n                }}\r\n              >\r\n                <td style={{ padding: '8px' }}>\r\n                  {track.name}\r\n                  {isBuiltIn(track.id) && (\r\n                    <span style={{ marginLeft: '6px', fontSize: '0.7rem', color: 'var(--color-muted)' }}>(built-in)</span>\r\n                  )}\r\n                </td>\r\n                <td style={{ padding: '8px' }}>{track.city}, {track.state}</td>\r\n                <td style={{ padding: '8px', textAlign: 'right', fontFamily: 'monospace' }}>{track.lat.toFixed(4)}</td>\r\n                <td style={{ padding: '8px', textAlign: 'right', fontFamily: 'monospace' }}>{track.lon.toFixed(4)}</td>\r\n                <td style={{ padding: '8px', textAlign: 'right' }}>{track.elevation_ft.toLocaleString()}</td>\r\n                <td style={{ padding: '8px', textAlign: 'right' }}>{(track as any).trackAngle ?? '-'}°</td>\r\n                <td style={{ padding: '8px', textAlign: 'center' }}>{track.length}</td>\r\n                <td style={{ padding: '8px', textAlign: 'center' }}>\r\n                  <div style={{ display: 'flex', gap: '4px', justifyContent: 'center' }}>\r\n                    <button\r\n                      onClick={() => handleCopyTrack(track)}\r\n                      style={{\r\n                        padding: '4px 8px',\r\n                        fontSize: '0.75rem',\r\n                        border: '1px solid var(--color-border)',\r\n                        borderRadius: '4px',\r\n                        backgroundColor: 'var(--color-bg-secondary)',\r\n                        cursor: 'pointer',\r\n                      }}\r\n                      title=\"Copy track\"\r\n                    >\r\n                      📋\r\n                    </button>\r\n                    {!isBuiltIn(track.id) && (\r\n                      <>\r\n                        <button\r\n                          onClick={() => handleEditTrack(track)}\r\n                          style={{\r\n                            padding: '4px 8px',\r\n                            fontSize: '0.75rem',\r\n                            border: '1px solid var(--color-border)',\r\n                            borderRadius: '4px',\r\n                            backgroundColor: 'var(--color-bg-secondary)',\r\n                            cursor: 'pointer',\r\n                          }}\r\n                          title=\"Edit track\"\r\n                        >\r\n                          ✏️\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleDeleteTrack(track.id)}\r\n                          style={{\r\n                            padding: '4px 8px',\r\n                            fontSize: '0.75rem',\r\n                            border: '1px solid #ef4444',\r\n                            borderRadius: '4px',\r\n                            backgroundColor: 'transparent',\r\n                            color: '#ef4444',\r\n                            cursor: 'pointer',\r\n                          }}\r\n                          title=\"Delete track\"\r\n                        >\r\n                          🗑️\r\n                        </button>\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Help text */}\r\n      <div style={{ marginTop: '1.5rem', padding: '1rem', backgroundColor: 'var(--color-bg-secondary)', borderRadius: '8px', fontSize: '0.85rem' }}>\r\n        <h4 style={{ marginBottom: '0.5rem' }}>Track Angle</h4>\r\n        <p style={{ color: 'var(--color-muted)', margin: 0 }}>\r\n          The track angle is the compass direction the track points (direction cars travel down the strip).\r\n          This is used to calculate the effective headwind/tailwind from the weather wind direction.\r\n          <br /><br />\r\n          <strong>0°</strong> = North, <strong>90°</strong> = East, <strong>180°</strong> = South, <strong>270°</strong> = West\r\n          <br /><br />\r\n          <strong>Tip:</strong> Use Google Maps to find coordinates. Right-click on the track location and copy the coordinates.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","/**\n * Dev Portal Panel Registry\n * \n * Register development/debugging panels here.\n * Only loaded in DEV builds.\n * \n * Panel Categories:\n * - Core: Settings, Health Check\n * - Simulation: Run Inspector, Energy Accounting\n * - Data: Input Inspector, Quick Paste, Air Model\n * - Testing: Parity Runner\n */\n\nimport type { FC } from 'react';\nimport SettingsPanel from './panels/SettingsPanel';\nimport HealthCheck from './panels/HealthCheck';\nimport RunInspector from './panels/RunInspector';\nimport EnergyPanel from './panels/EnergyPanel';\nimport InputInspector from './panels/InputInspector';\nimport QuickPaste from './panels/QuickPaste';\nimport AirInspector from './panels/AirInspector';\nimport ParityRunner from './panels/ParityRunner';\nimport UserManagement from './panels/UserManagement';\nimport TrackEditor from './panels/TrackEditor';\n\nexport interface DevPanel {\n  id: string;\n  title: string;\n  component: FC;\n  category?: 'core' | 'simulation' | 'data' | 'testing';\n}\n\n/**\n * Registry of all dev panels.\n * Organized by category for better navigation.\n */\nexport const DEV_PANELS: DevPanel[] = [\n  // === CORE ===\n  {\n    id: 'settings',\n    title: '⚙️ Settings & Flags',\n    component: SettingsPanel,\n    category: 'core',\n  },\n  {\n    id: 'health-check',\n    title: '🩺 Health Check',\n    component: HealthCheck,\n    category: 'core',\n  },\n  \n  // === SIMULATION ===\n  {\n    id: 'run-inspector',\n    title: '▶️ Run Inspector',\n    component: RunInspector,\n    category: 'simulation',\n  },\n  {\n    id: 'energy',\n    title: '⚡ Energy Accounting',\n    component: EnergyPanel,\n    category: 'simulation',\n  },\n  \n  // === DATA ===\n  {\n    id: 'input-inspector',\n    title: '🔍 Input Inspector',\n    component: InputInspector,\n    category: 'data',\n  },\n  {\n    id: 'quick-paste',\n    title: '📋 Quick Paste',\n    component: QuickPaste,\n    category: 'data',\n  },\n  {\n    id: 'air',\n    title: '🌡️ Air Model',\n    component: AirInspector,\n    category: 'data',\n  },\n  \n  // === TESTING ===\n  {\n    id: 'parity',\n    title: '🧪 Parity Runner',\n    component: ParityRunner,\n    category: 'testing',\n  },\n  \n  // === ADMIN ===\n  {\n    id: 'users',\n    title: '👥 User Management',\n    component: UserManagement,\n    category: 'core',\n  },\n  \n  // === TRACKS ===\n  {\n    id: 'tracks',\n    title: '🏁 Track Editor',\n    component: TrackEditor,\n    category: 'data',\n  },\n];\n","/**\n * Dev Portal\n * \n * Development and debugging interface with modular panels.\n * Only available in DEV builds.\n */\n\nimport { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { DEV_PANELS } from '../dev/registry.tsx';\nimport Page from '../shared/components/Page';\n\nexport default function DevPortal() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const panelParam = searchParams.get('panel');\n  \n  const [activePanelId, setActivePanelId] = useState<string>(() => {\n    // Initialize from URL param if present, otherwise use first panel\n    if (panelParam && DEV_PANELS.some(p => p.id === panelParam)) {\n      return panelParam;\n    }\n    return DEV_PANELS.length > 0 ? DEV_PANELS[0].id : '';\n  });\n\n  // Update URL when panel changes\n  useEffect(() => {\n    if (activePanelId) {\n      setSearchParams({ panel: activePanelId }, { replace: true });\n    }\n  }, [activePanelId, setSearchParams]);\n\n  // Update active panel when URL changes\n  useEffect(() => {\n    if (panelParam && DEV_PANELS.some(p => p.id === panelParam)) {\n      setActivePanelId(panelParam);\n    }\n  }, [panelParam]);\n\n  const activePanel = DEV_PANELS.find((p) => p.id === activePanelId);\n  const ActiveComponent = activePanel?.component;\n\n  return (\n    <Page title=\"Dev Portal\">\n      <div style={{ display: 'flex', gap: '1rem', minHeight: '70vh' }}>\n        {/* Left Navigation */}\n        <nav\n          style={{\n            width: '200px',\n            flexShrink: 0,\n            borderRight: '1px solid var(--color-border)',\n            paddingRight: '1rem',\n          }}\n        >\n          <h3\n            style={{\n              fontSize: '0.875rem',\n              fontWeight: '600',\n              textTransform: 'uppercase',\n              color: 'var(--color-muted)',\n              marginBottom: '1rem',\n            }}\n          >\n            Dev Panels\n          </h3>\n          <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>\n            {DEV_PANELS.map((panel) => (\n              <li key={panel.id} style={{ marginBottom: '0.25rem' }}>\n                <button\n                  onClick={() => setActivePanelId(panel.id)}\n                  style={{\n                    width: '100%',\n                    textAlign: 'left',\n                    padding: '0.5rem 0.75rem',\n                    border: 'none',\n                    background:\n                      activePanelId === panel.id\n                        ? 'var(--color-primary)'\n                        : 'transparent',\n                    color:\n                      activePanelId === panel.id\n                        ? 'white'\n                        : 'var(--color-text)',\n                    borderRadius: 'var(--radius-sm)',\n                    cursor: 'pointer',\n                    fontSize: '0.875rem',\n                    transition: 'background-color 0.2s',\n                  }}\n                  onMouseEnter={(e) => {\n                    if (activePanelId !== panel.id) {\n                      e.currentTarget.style.backgroundColor =\n                        'var(--color-surface)';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    if (activePanelId !== panel.id) {\n                      e.currentTarget.style.backgroundColor = 'transparent';\n                    }\n                  }}\n                >\n                  {panel.title}\n                </button>\n              </li>\n            ))}\n          </ul>\n          {DEV_PANELS.length === 0 && (\n            <p\n              style={{\n                fontSize: '0.875rem',\n                color: 'var(--color-muted)',\n                fontStyle: 'italic',\n              }}\n            >\n              No panels registered\n            </p>\n          )}\n        </nav>\n\n        {/* Right Content Area */}\n        <div\n          style={{\n            flex: 1,\n            minWidth: 0,\n            backgroundColor: 'var(--color-surface)',\n            borderRadius: 'var(--radius-md)',\n            overflow: 'auto',\n          }}\n        >\n          {ActiveComponent ? (\n            <ActiveComponent />\n          ) : (\n            <div style={{ padding: '2rem', textAlign: 'center' }}>\n              <p style={{ color: 'var(--color-muted)' }}>\n                No panel selected\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n    </Page>\n  );\n}\n"],"names":["USER_LEVELS","USER_LEVEL_DISPLAY","USER_LEVEL_DESCRIPTIONS","hasAccess","currentLevel","requiredLevel","currentIndex","requiredIndex","hasProAccess","level","QUARTER_JR_INPUTS","QUARTER_PRO_ADDITIONAL_INPUTS","getVisibleInputs","SettingsPanel","flags","useFlags","useUserLevel","setFlag","setUserLevel","resetFlags","useFlagsStore","visibleInputs","logBuffer","setLogBuffer","useState","searchTerm","setSearchTerm","autoScroll","setAutoScroll","showLogs","setShowLogs","logViewerRef","useRef","useEffect","originalLog","originalWarn","originalError","captureLog","args","timestamp","message","arg","logEntry","prev","handleDownloadLogs","logText","blob","url","a","filteredLogs","log","flagDefinitions","jsxs","jsx","lvl","input","flag","e","Fragment","idx","color","validateVB6Fixture","fx","missing","_a","_b","_c","_d","_e","_f","HealthCheck","fixture","useVb6Fixture","validationResult","setValidationResult","dryRunResult","setDryRunResult","smokeResult","setSmokeResult","loading","setLoading","error","setError","handleValidate","result","err","handleDryRun","handleSmokeSim","simulate","field","inferRedlineRPM","curve","ensurePMI","p","normalizeEnv","env","toSimInputFromVB6","distanceFt","pmi","raceLength","dt","drivetrain","veh","vehicle","out","hpMult","powerHP","pt","b","raceLenFt","_g","_h","VehiclePicker","onSelect","showEditButton","onEditClick","vehicles","activeVehicleId","setActiveVehicleById","useVehicleStore","handleChange","id","v","adaptVB6ToEngineParams","RunInspector","navigate","useNavigate","setFixture","enableStepTrace","useFlag","flagsStore","userLevel","activeVehicle","setRaceLength","running","setRunning","setResult","stepData","setStepData","validation","handleVehicleSelect","vehicleId","vb6Fixture","fromVehicleToVB6Fixture","validateAdapterOutput","handleEditVehicle","startTransition","handleRun","res","hp","handleDownloadCsv","headers","rows","row","csv","r","_i","_j","_k","_l","_m","_n","_o","buildInputFromUiFixture","EnergyPanel","enableEnergyLogging","energyData","setEnergyData","assertComplete","simResult","energy","totalIn","balance","Vb6FixtureValidationError","handleExportJson","json","handleExportCsv","EnergyBar","label","value","percentage","isInput","showSign","displayValue","barWidth","LEGACY_BENCHMARKS","validateAgainstBenchmark","benchmark","et_s","mph","target","etDelta","mphDelta","etPass","mphPass","validateBenchmarkConfig","config","numGears","numShifts","f","BENCHMARK_CONFIGS","bm","vb","VB6_PROSTOCK_PRO","rpm","CODE_FIXTURES","mapBenchmarkToVB6Fixture","benchmarkName","InputInspector","fixtureJson","setFixtureJson","validationError","setValidationError","simulationInput","setSimulationInput","selectedFixture","setSelectedFixture","selectedBenchmark","setSelectedBenchmark","diffResult","setDiffResult","parsed","handleApplyToUi","handleBuildInput","handleCopyInput","handleDiff","currentFixture","codeFixture","diff","computeDiff","handlePopulateFromBenchmark","mappedFixture","name","current","reference","path","diffs","key","currentPath","PROFILES_STORAGE_KEY","QuickPaste","searchParams","useSearchParams","dynoText","setDynoText","dynoPreview","setDynoPreview","dynoError","setDynoError","pmiEngine","setPmiEngine","pmiChassis","setPmiChassis","gearEff","setGearEff","pmiError","setPmiError","profiles","setProfiles","selectedProfile","setSelectedProfile","newProfileName","setNewProfileName","stored","saveProfiles","newProfiles","parseDynoTable","text","lines","line","trimmed","parts","handleDynoPreview","handleApplyDyno","handleApplyPMI","pmiUpdates","drivetrainUpdates","val","s","effArray","part","updates","handleSaveProfile","newProfile","updated","handleLoadProfile","profile","handleDeleteProfile","handleLoadProStockExample","response","fixtureData","missingFields","errorMsg","airDensityVB6","air","elevation_ft","fuelSystem","cps","psdry","PWV","elevationFactor","TSTD","pamb","PSTD","BSTD","pair","delta","WAR","WTH20","WTAIR","RGAS","RSTD","rgrs","temp_R","RANKINE_OFFSET","theta","rho","ifuel","icarb","kwar","px","tx","mech","dtx","hpc","RHO_STANDARD","dynamicPressure","rho_slug_per_ft3","v_fps","mphToFps","AirInspector","baro","setBaro","temp","setTemp","humidity","setHumidity","baroVal","tempVal","humidityVal","computed","handleApply","deltaPct","fps","q_psf","q_psi","TABY","xrpm","yhp","NHP","_order","i","x0","x1","y0","y1","t","vb6Tire","TireDia_in","TireWidth_in","Vel_ftps","Ags0_g","isLandSpeed","TireGrowth","TireCirFt","PI","TGK","TGLinear","calcCAXI","TractionIndex","TrackTempEffect","calcAX","AX_BV","AX","calcThrottleStopMultiplier","currentTime_s","throttleStop","activateTime_s","duration_s","throttlePct","rampTime_s","deactivateTime_s","targetMult","rampProgress","vb6SimulationStep","state","TSMax","iGear","TimeStep","gearChanged","ratio","Jerk","Work_time","JMin","JMax","tireResult","TireSlip","TGR_gear","ChassisPMI","Vel_L","gc","ShiftRPM_gear","VelAtShift","VelSqrd","DSRPM","LockRPM","EngRPM_L","ClutchSlip","zStall","SlipRatio","HP","throttleStopMult","HPSave","WindFPS","Z5","q","RefArea2","DownForce","cmu_const","CMU_BV","CMU","cmuk_const","CMUK_BV","CMUK","frct_const","FRCT_BV","FRCT","DragForce","DragHP","TireRadIn","deltaFWT","DynamicFWT","WheelBarWT","DynamicRWT","CAXI","AX_val","CRTF","AMax_g","TGEff_gear","HPAtWheels","PQWT","AGS_g","SLIP","AMin","time_L","kp21_const","KP21_BV","KP21","kp22_const","KP22_BV","KP22","EngAccHP","ChasAccHP","HPEngPMI","HPChasPMI","k","dtk1","Work","Jerk_iter","dtk2_time","dtk2","z","K6","K61","dt_final","Dist_L","avgVel","Vel0_cubed","term","vb6InitState","launchRPM","HP_launch","TQ","TGR_1","TGEff_1","cmu_launch","WindFPS_launch","q_launch","DragForce_launch","TireSlip_init","force","StaticRWT","CAXI_init","AX_init","CRTF_init","AMax_init","vb6CalcTSMaxInit","DistToPrint1_ft","TorqueMult","Weight_lbf","getRaceLengthFt","info","RACE_LENGTH_INFO","getDistanceTargets","distances","DISTANCES","getFuelSystemType","fuel","extractHPCurve","engine","hpCurve","peakHP","rpmAtPeakHP","displacement_cid","buildEngineCurve","convertToZeroIndexed","calcTrackTempEffect","trackTempF","deviation","effect","simulateVB6Exact","warnings","trace","raceLengthFt","rolloutIn","overhangIn","ftd","ovradj","minOvradj","rolloutFt","clutch","converter","throttleStopConfig","throttleStopParams","txType","isClutch","rawFuel","fuelString","fuelSystemType","airResult","rho_lbm_ft3","hpCurveResult","isQuarterJr","quarterJrParams","gearRatios","finalDrive","NGR","tire","tireDiaIn","tireWidthIn","bodyStyle","calcBodyStyle","TGEff","shiftRPMs","stallRPM","slippage","torqueMult","enginePMI","transPMI","tiresPMI","overallEfficiency","dragCoef","liftCoef","overhangInCalc","calcTransEfficiencies","singleShiftRPM","inputSlipStall","calcClutchSlippage","converterDia","work","stq","taby","Z6","lrat","calcEfficiency","aero","getAeroByBodyStyle","calcPMI","clutchSlipRPM","converterStallRPM","clutchSlippage","converterSlippage","YCG_in","staticFWt","finalOverhang","vb6Vehicle","ftdCalc","minOvradjCalc","trackTempEffect","vb6Env","MAX_STEPS","MAX_TIME_S","convergenceHistory","timeslip","distanceTargets","targetIdx","timerStartTime_s","saveTime_594ft","saveTime_1254ft","step","stepResult","timeToReachRollout","trackDist_ft","trackTime_s","transGearRatio","driveshaftRPM","tireSlipFactor","wheelSpeed_mph","FPS_TO_MPH","throttleStopActive","prevDist","prevTime","frac","exactTime","speed_mph","shiftTime","shiftRPM","finalResult","traces","debugData","VB6ExactModel","ParityRunner","selectedBenchmarks","setSelectedBenchmarks","selectedLengths","setSelectedLengths","results","setResults","handleToggleBenchmark","newSet","handleToggleLength","length","handleSelectAll","handleSelectNone","buildSimInputs","configName","testResults","inputs","handleOpenInRunInspector","passCount","totalCount","styles","AVAILABLE_PRODUCTS","UserModal","user","onClose","onSave","onDelete","email","setEmail","setName","role","setRole","products","setProducts","password","setPassword","toggleProduct","productId","handleSubmit","RoleModal","description","setDescription","setColor","selectedProducts","setSelectedProducts","additionalFeatures","setAdditionalFeatures","canManageUsers","setCanManageUsers","canManageRoles","setCanManageRoles","sortOrder","setSortOrder","toggleFeature","x","ALL_FEATURES","ProductModal","product","icon","setIcon","features","setFeatures","isPremium","setIsPremium","UserManagement","auth","useAuth","activeTab","setActiveTab","editingUser","setEditingUser","editingRole","setEditingRole","editingProduct","setEditingProduct","apiUsers","setApiUsers","loadingUsers","setLoadingUsers","userError","setUserError","roles","loadUsers","usersApi","tab","roleColors","data","TrackEditor","apiTracks","setApiTracks","editingTrack","setEditingTrack","isNew","setIsNew","searchQuery","setSearchQuery","setMessage","isAdmin","isOwner","loadTracksFromAPI","allTracks","TRACKS","bt","filteredTracks","handleNewTrack","handleEditTrack","track","handleCopyTrack","handleSaveTrack","saveTrackToAPI","updateTrackInAPI","tracks","handleDeleteTrack","trackId","deleteTrackFromAPI","isBuiltIn","DEV_PANELS","DevPortal","setSearchParams","panelParam","activePanelId","setActivePanelId","activePanel","ActiveComponent","Page","panel"],"mappings":"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"}