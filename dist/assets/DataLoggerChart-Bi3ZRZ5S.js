import{r as f,j as t,ab as H,ac as K,ad as F,ae as V,af as b,ag as W,ah as $,ai as d}from"./index-m2saeOeT.js";const r={rpm:{name:"Engine RPM",color:"#ef4444",unit:"RPM",yAxisId:"rpm"},dsrpm:{name:"Driveshaft RPM",color:"#f97316",unit:"RPM",yAxisId:"rpm"},lockRpm:{name:"Clutch/Conv RPM",color:"#eab308",unit:"RPM",yAxisId:"rpm"},v_mph:{name:"Car Speed",color:"#22c55e",unit:"mph",yAxisId:"speed"},a_g:{name:"Acceleration",color:"#3b82f6",unit:"g",yAxisId:"accel"},engineHp:{name:"Engine HP",color:"#a855f7",unit:"HP",yAxisId:"hp"},hp:{name:"Wheel HP",color:"#8b5cf6",unit:"HP",yAxisId:"hp"},dragHp:{name:"Drag HP",color:"#ec4899",unit:"HP",yAxisId:"hp"},gear:{name:"Gear",color:"#9ca3af",unit:"",yAxisId:"gear"}};function G({data:y,comparisonData:x,comparisonLabel:E="Comparison",distanceMarkers:A=[60,330,660,1e3,1320],raceLengthFt:v=1320}){const[n,I]=f.useState("time"),[a,R]=f.useState(new Set(["rpm","v_mph","a_g"])),w=e=>{R(o=>{const s=new Set(o);return s.has(e)?s.delete(e):s.add(e),s})},g=f.useMemo(()=>{const e=new Set;return a.forEach(o=>{e.add(r[o].yAxisId)}),e},[a]),[k,M]=f.useState(!0),{chartData:h,markerIndices:_}=f.useMemo(()=>{const e=y,o=A.filter(l=>l<=v),s=[];for(const l of o){let p=-1,c=1/0;for(let u=0;u<e.length;u++){const m=Math.abs(e[u].s_ft-l);m<c&&(c=m,p=u)}p>=0&&s.push({distance:l,index:p})}return{chartData:e.map(l=>{const p=n==="time"?l.t_s:l.s_ft,c={...l,xValue:p};if(x&&k){const u=n==="time"?"t_s":"s_ft";let m=null,j=1/0;for(const C of x){const S=Math.abs(C[u]-p);S<j&&(j=S,m=C)}m&&j<(n==="time"?.05:10)&&(c.comp_rpm=m.rpm,c.comp_v_mph=m.v_mph,c.comp_a_g=m.a_g,c.comp_hp=m.hp)}return c}),markerIndices:s}},[y,x,k,n,A,v]),D=f.useMemo(()=>_.map(e=>{var o;return{distance:e.distance,xValue:(o=h[e.index])==null?void 0:o.xValue}}).filter(e=>e.xValue!==void 0&&!isNaN(e.xValue)),[h,_]),P=f.useMemo(()=>{const e=[];for(let o=1;o<h.length;o++){const s=h[o-1],i=h[o];s.gear!==i.gear&&i.gear>s.gear&&e.push({xValue:i.xValue,fromGear:s.gear,toGear:i.gear})}return e},[h]);if(!y||y.length===0)return t.jsx("div",{className:"text-center text-muted",style:{padding:"var(--space-6)"},children:"No trace data available"});const z=["speed","accel","hp"].filter(e=>g.has(e)).length;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-2)",marginBottom:"var(--space-2)",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-3)",flexWrap:"wrap"},children:[t.jsx("span",{style:{fontSize:"0.8rem",fontWeight:600,color:"var(--color-text-muted)"},children:"X-Axis"}),t.jsxs("div",{style:{display:"inline-flex",borderRadius:"var(--radius-md)",overflow:"hidden",border:"2px solid var(--color-border)",backgroundColor:"var(--color-bg-secondary)"},children:[t.jsx("button",{onClick:()=>I("time"),style:{padding:"8px 20px",border:"none",backgroundColor:n==="time"?"var(--color-primary)":"transparent",color:n==="time"?"white":"var(--color-text)",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.15s ease"},children:"Time (s)"}),t.jsx("button",{onClick:()=>I("distance"),style:{padding:"8px 20px",border:"none",borderLeft:"2px solid var(--color-border)",backgroundColor:n==="distance"?"var(--color-primary)":"transparent",color:n==="distance"?"white":"var(--color-text)",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.15s ease"},children:"Distance (ft)"})]}),x&&x.length>0&&t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"0.8rem",color:"var(--color-text-muted)",cursor:"pointer",marginLeft:"auto"},children:[t.jsx("input",{type:"checkbox",checked:k,onChange:e=>M(e.target.checked)}),t.jsx("span",{style:{color:k?"#f59e0b":"var(--color-text-muted)"},children:"Show Comparison"})]})]}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:Object.entries(r).map(([e,o])=>{if(!y.some(l=>l[e]!==void 0))return null;const i=a.has(e);return t.jsxs("button",{onClick:()=>w(e),title:o.name,style:{display:"flex",alignItems:"center",gap:"4px",padding:"4px 10px",borderRadius:"12px",border:"none",backgroundColor:i?o.color:"var(--color-bg-secondary)",color:i?"white":"var(--color-text-muted)",cursor:"pointer",fontSize:"0.7rem",fontWeight:600,transition:"all 0.15s ease",opacity:i?1:.7},children:[t.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:i?"white":o.color}}),o.name]},e)})})]}),t.jsx("div",{style:{flex:1,minHeight:0},children:t.jsx(H,{width:"100%",height:"100%",children:t.jsxs(K,{data:h,margin:{top:20,right:5+z*40,left:5,bottom:20},children:[t.jsx(F,{strokeDasharray:"3 3",stroke:"var(--color-border)",opacity:.3}),t.jsx(V,{dataKey:"xValue",type:"number",domain:n==="time"?[0,e=>Math.ceil(e*10)/10]:[0,v+50],stroke:"var(--color-text-muted)",tick:{fontSize:10,fill:"var(--color-text-muted)"},tickFormatter:e=>n==="time"?e.toFixed(1):e.toFixed(0),tickCount:n==="time"?8:6,label:{value:n==="time"?"Time (s)":"Distance (ft)",position:"insideBottom",offset:-10,fontSize:11,fill:"var(--color-text-muted)"}}),g.has("rpm")&&t.jsx(b,{yAxisId:"rpm",orientation:"left",stroke:"#ef4444",tick:{fontSize:10,fill:"#ef4444"},tickFormatter:e=>`${(e/1e3).toFixed(0)}k`,width:40}),g.has("speed")&&t.jsx(b,{yAxisId:"speed",orientation:"right",stroke:"#22c55e",tick:{fontSize:10,fill:"#22c55e"},width:35}),g.has("accel")&&t.jsx(b,{yAxisId:"accel",orientation:"right",stroke:"#3b82f6",domain:[0,"auto"],tick:{fontSize:10,fill:"#3b82f6"},tickFormatter:e=>e.toFixed(1),width:30}),g.has("hp")&&t.jsx(b,{yAxisId:"hp",orientation:"right",stroke:"#8b5cf6",tick:{fontSize:10,fill:"#8b5cf6"},width:40}),t.jsx(b,{yAxisId:"gear",orientation:"right",domain:[0,6],hide:!0}),D.map(e=>t.jsx(W,{x:e.xValue,yAxisId:"rpm",stroke:"var(--color-chart-marker)",strokeWidth:2,strokeDasharray:"6 4",label:{value:`${e.distance}'`,position:"insideTopRight",fill:"var(--color-chart-marker)",fontSize:10,fontWeight:700,offset:5}},`dist-${e.distance}`)),P.map((e,o)=>t.jsx(W,{x:e.xValue,yAxisId:"rpm",stroke:"#f59e0b",strokeWidth:1.5,strokeDasharray:"3 3",label:{value:`${e.fromGear}â†’${e.toGear}`,position:"insideBottomRight",fill:"#f59e0b",fontSize:9,fontWeight:600}},`shift-${o}`)),t.jsx($,{contentStyle:{backgroundColor:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:"var(--radius-sm)",color:"var(--color-text)",fontSize:"0.75rem",padding:"8px"},formatter:(e,o,s)=>{var p;const i=Object.values(r).find(c=>c.name===o);if(!i)return[e.toFixed(2),o];let l="";return o==="Acceleration"&&((p=s==null?void 0:s.payload)!=null&&p.slip)&&(l=" (s)"),[`${e.toFixed(i.unit==="RPM"?0:2)} ${i.unit}${l}`,o]},labelFormatter:e=>n==="time"?`Time: ${e.toFixed(3)}s`:`Distance: ${e.toFixed(0)} ft`}),a.has("rpm")&&t.jsx(d,{type:"monotone",dataKey:"rpm",stroke:r.rpm.color,strokeWidth:2,dot:!1,name:r.rpm.name,yAxisId:"rpm"}),a.has("dsrpm")&&t.jsx(d,{type:"monotone",dataKey:"dsrpm",stroke:r.dsrpm.color,strokeWidth:2,dot:!1,name:r.dsrpm.name,yAxisId:"rpm"}),a.has("lockRpm")&&t.jsx(d,{type:"monotone",dataKey:"lockRpm",stroke:r.lockRpm.color,strokeWidth:2,dot:!1,name:r.lockRpm.name,yAxisId:"rpm"}),a.has("v_mph")&&t.jsx(d,{type:"monotone",dataKey:"v_mph",stroke:r.v_mph.color,strokeWidth:2,dot:!1,name:r.v_mph.name,yAxisId:"speed"}),a.has("a_g")&&t.jsx(d,{type:"monotone",dataKey:"a_g",stroke:r.a_g.color,strokeWidth:2,dot:!1,name:r.a_g.name,yAxisId:"accel"}),a.has("hp")&&t.jsx(d,{type:"monotone",dataKey:"hp",stroke:r.hp.color,strokeWidth:2,dot:!1,name:r.hp.name,yAxisId:"hp"}),a.has("dragHp")&&t.jsx(d,{type:"monotone",dataKey:"dragHp",stroke:r.dragHp.color,strokeWidth:2,dot:!1,name:r.dragHp.name,yAxisId:"hp"}),a.has("gear")&&t.jsx(d,{type:"stepAfter",dataKey:"gear",stroke:r.gear.color,strokeWidth:2,dot:!1,name:r.gear.name,yAxisId:"gear"}),k&&x&&x.length>0&&t.jsxs(t.Fragment,{children:[a.has("rpm")&&t.jsx(d,{type:"monotone",dataKey:"comp_rpm",stroke:r.rpm.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp RPM",yAxisId:"rpm"}),a.has("v_mph")&&t.jsx(d,{type:"monotone",dataKey:"comp_v_mph",stroke:r.v_mph.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp Speed",yAxisId:"speed"}),a.has("a_g")&&t.jsx(d,{type:"monotone",dataKey:"comp_a_g",stroke:r.a_g.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp Accel",yAxisId:"accel"}),a.has("hp")&&t.jsx(d,{type:"monotone",dataKey:"comp_hp",stroke:r.hp.color,strokeWidth:1.5,strokeDasharray:"4 2",strokeOpacity:.5,dot:!1,name:"Comp HP",yAxisId:"hp"})]})]})})}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"12px",marginTop:"8px",fontSize:"0.75rem"},children:Object.entries(r).map(([e,o])=>a.has(e)?t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{style:{width:"14px",height:"3px",backgroundColor:o.color,borderRadius:"1px"}}),t.jsx("span",{style:{color:o.color,fontWeight:500},children:o.name})]},e):null)})]})}export{G as default};
//# sourceMappingURL=DataLoggerChart-Bi3ZRZ5S.js.map
